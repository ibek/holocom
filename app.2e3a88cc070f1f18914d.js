webpackJsonp([1],[,,,,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.assertionError=t.assert=void 0;var r=n(129),i=(t.assert=function(e,t){if(!e)throw i(t)},t.assertionError=function(e){return new Error("Firebase Database ("+r.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)})},,function(e,t,n){"use strict";function r(e){o=e}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.setTimeoutNonBlocking=t.exportPropGetter=t.beingCrawled=t.callUserCallback=t.exceptionGuard=t.tryParseInt=t.INTEGER_REGEXP_=t.errorForServerCode=t.isWindowsStoreApp=t.isChromeExtensionContentScript=t.doubleToIEEE754String=t.bindCallback=t.each=t.splitStringBySize=t.ObjectToUniqueKey=t.requireKey=t.stringCompare=t.nameCompare=t.MAX_NAME=t.MIN_NAME=t.executeWhenDOMReady=t.isInvalidJSONNumber=t.warnAboutUnsupportedMethod=t.warnIfPageIsSecure=t.warn=t.fatal=t.error=t.logWrapper=t.log=t.enableLogging=t.logger=t.sha1=t.base64Decode=t.base64Encode=t.LUIDGenerator=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.setBufferImpl=r;var o,a=n(5),s=n(11),c=n(744),l=n(745),u=n(175),h=n(42),d=n(130),p=n(78),f=(t.LUIDGenerator=function(){var e=1;return function(){return e++}}(),t.base64Encode=function(e){var t=(0,u.stringToByteArray)(e);return c.base64.encodeByteArray(t,!0)},t.base64Decode=function(e){try{return o?new o(e,"base64").toString("utf8"):c.base64.decodeString(e,!0)}catch(e){g("base64Decode failed: ",e)}return null},t.sha1=function(e){var t=(0,u.stringToByteArray)(e),n=new l.Sha1;n.update(t);var r=n.digest();return c.base64.encodeByteArray(r)},function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",o=0;o<t.length;o++)Array.isArray(t[o])||t[o]&&"object"===i(t[o])&&"number"==typeof t[o].length?r+=e.apply(null,t[o]):"object"===i(t[o])?r+=(0,h.stringify)(t[o]):r+=t[o],r+=" ";return r}),v=t.logger=null,m=!0,y=t.enableLogging=function(e,n){(0,a.assert)(!n||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?("undefined"!=typeof console&&("function"==typeof console.log?t.logger=v=console.log.bind(console):"object"===i(console.log)&&(t.logger=v=function(e){console.log(e)})),n&&d.SessionStorage.set("logging_enabled",!0)):"function"==typeof e?t.logger=v=e:(t.logger=v=null,d.SessionStorage.remove("logging_enabled"))},g=t.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===m&&(m=!1,null===v&&!0===d.SessionStorage.get("logging_enabled")&&y(!0)),v){var n=f.apply(null,e);v(n)}},_=(t.logWrapper=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];g.apply(void 0,[e].concat(t))}},t.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("undefined"!=typeof console){var n="FIREBASE INTERNAL ERROR: "+f.apply(void 0,e);void 0!==console.error?console.error(n):console.log(n)}},t.fatal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=f.apply(void 0,e);throw new Error("FIREBASE FATAL ERROR: "+n)},t.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("undefined"!=typeof console){var n="FIREBASE WARNING: "+f.apply(void 0,e);void 0!==console.warn?console.warn(n):console.log(n)}}),b=(t.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&_("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},t.warnAboutUnsupportedMethod=function(e){_(e+" is unsupported and will likely change soon.  Please do not use.")},t.isInvalidJSONNumber=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)}),S=(t.executeWhenDOMReady=function(e){if((0,p.isNodeSdk)()||"complete"===document.readyState)e();else{var t=!1,n=function n(){if(!document.body)return void setTimeout(n,Math.floor(10));t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},t.MIN_NAME="[MIN_NAME]"),w=t.MAX_NAME="[MAX_NAME]",E=(t.nameCompare=function(e,t){if(e===t)return 0;if(e===S||t===w)return-1;if(t===S||e===w)return 1;var n=C(e),r=C(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},t.stringCompare=function(e,t){return e===t?0:e<t?-1:1},t.requireKey=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,h.stringify)(t))},t.ObjectToUniqueKey=function e(t){if("object"!==(void 0===t?"undefined":i(t))||null===t)return(0,h.stringify)(t);var n=[];for(var r in t)n.push(r);n.sort();for(var o="{",a=0;a<n.length;a++)0!==a&&(o+=","),o+=(0,h.stringify)(n[a]),o+=":",o+=e(t[n[a]]);return o+="}"},t.splitStringBySize=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r},t.each=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;++n)t(n,e[n]);else(0,s.forEach)(e,function(e,n){return t(n,e)})},t.bindCallback=function(e,t){return t?e.bind(t):e},t.doubleToIEEE754String=function(e){(0,a.assert)(!b(e),"Invalid JSON number");var t,n,r,i,o,s,c;for(0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,e=Math.abs(e),e>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074)))),s=[],o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse(),c=s.join("");var l="";for(o=0;o<64;o+=8){var u=parseInt(c.substr(o,8),2).toString(16);1===u.length&&(u="0"+u),l+=u}return l.toLowerCase()},t.isChromeExtensionContentScript=function(){return!("object"!==("undefined"==typeof window?"undefined":i(window))||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},t.isWindowsStoreApp=function(){return"object"===("undefined"==typeof Windows?"undefined":i(Windows))&&"object"===i(Windows.UI)},t.errorForServerCode=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?n="Client doesn't have permission to access the desired data.":"unavailable"==e&&(n="The service is unavailable");var r=new Error(e+" at "+t.path.toString()+": "+n);return r.code=e.toUpperCase(),r},t.INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$")),C=t.tryParseInt=function(e){if(E.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},x=t.exceptionGuard=function(e){try{e()}catch(e){setTimeout(function(){var t=e.stack||"";throw _("Exception was thrown by user callback.",t),e},Math.floor(0))}};t.callUserCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"function"==typeof e&&x(function(){e.apply(void 0,t)})},t.beingCrawled=function(){return("object"===("undefined"==typeof window?"undefined":i(window))&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},t.exportPropGetter=function(e,t,n){Object.defineProperty(e,t,{get:n})},t.setTimeoutNonBlocking=function(e,t){var n=setTimeout(e,t);return"object"===(void 0===n?"undefined":i(n))&&n.unref&&n.unref(),n}},,,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.safeGet=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},t.forEach=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}),o=t.extend=function(e,t){return i(t,function(t,n){e[t]=n}),e},a=(t.clone=function(e){return o({},e)},t.isNonNullObject=function(e){return"object"===(void 0===e?"undefined":r(e))&&null!==e},t.isEmpty=function(e){for(var t in e)return!1;return!0},t.getCount=function(e){var t=0;for(var n in e)t++;return t},t.map=function(e,t,n){var r={};for(var i in e)r[i]=t.call(n,e[i],i,e);return r},t.findKey=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r});t.findValue=function(e,t,n){var r=a(e,t,n);return r&&e[r]},t.getAnyKey=function(e){for(var t in e)return t},t.getValues=function(e){var t=[],n=0;for(var r in e)t[n++]=e[r];return t},t.every=function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!t(n,e[n]))return!1;return!0}},,,,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ValidationPath=t.Path=void 0;var r=n(7),i=n(175),o=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)t.push(this.pieces_[n]);return new e(t,0)},e.prototype.child=function(t){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(t instanceof e)for(var r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else for(var i=t.split("/"),r=0;r<i.length;r++)i[r].length>0&&n.push(i[r]);return new e(n,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,n){var r=t.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return e.relativePath(t.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var n=e.slice(),i=t.slice(),o=0;o<n.length&&o<i.length;o++){var a=(0,r.nameCompare)(n[o],i[o]);if(0!==a)return a}return n.length===i.length?0:n.length<i.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},e}();t.Path=o;var a=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,i.stringLength)(this.parts_[n]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=(0,i.stringLength)(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=(0,i.stringLength)(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}();t.ValidationPath=a},,,,,,,,,function(e,t,n){"use strict";function r(e){o=e}function i(e){a=e}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.PRIORITY_INDEX=t.PriorityIndex=void 0,t.setNodeFromJSON=r,t.setMaxNode=i;var o,a,s=n(132),c=n(7),l=n(33),u=n(133),h=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?(0,c.nameCompare)(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return l.NamedNode.MIN},t.prototype.maxPost=function(){return new l.NamedNode(c.MAX_NAME,new u.LeafNode("[PRIORITY-POST]",a))},t.prototype.makePost=function(e,t){var n=o(e);return new l.NamedNode(t,new u.LeafNode("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(s.Index);t.PriorityIndex=d;t.PRIORITY_INDEX=new d},,,,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_NODE=t.MaxNode=t.ChildrenNode=void 0;var r,i=n(5),o=n(7),a=n(177),s=n(33),c=n(269),l=n(25),u=n(100),h=n(271),d=n(133),p=n(273),f=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&(0,c.validatePriorityNode)(this.priorityNode_),this.children_.isEmpty()&&(0,i.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return r||(r=new e(new a.SortedMap(p.NAME_COMPARATOR),null,h.IndexMap.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||r},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?r:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if((0,i.assert)(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var o=new s.NamedNode(t,n),a=void 0,c=void 0,l=void 0;return n.isEmpty()?(a=this.children_.remove(t),c=this.indexMap_.removeFromIndexes(o,this.children_)):(a=this.children_.insert(t,n),c=this.indexMap_.addToIndexes(o,this.children_)),l=a.isEmpty()?r:this.priorityNode_,new e(a,l,c)},e.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;(0,i.assert)(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(l.PRIORITY_INDEX,function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+(0,c.priorityHashText)(this.getPriority().val())+":"),this.forEachChild(l.PRIORITY_INDEX,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":(0,o.sha1)(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new s.NamedNode(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new s.NamedNode(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new s.NamedNode(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,s.NamedNode.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,s.NamedNode.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===y?-1:0},e.prototype.withIndex=function(t){if(t===u.KEY_INDEX||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===u.KEY_INDEX||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(l.PRIORITY_INDEX),r=t.getIterator(l.PRIORITY_INDEX),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===u.KEY_INDEX?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}();t.ChildrenNode=v;var m=function(e){function t(){return e.call(this,new a.SortedMap(p.NAME_COMPARATOR),v.EMPTY_NODE,h.IndexMap.Default)||this}return f(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return v.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(v);t.MaxNode=m;var y=t.MAX_NODE=new m;Object.defineProperties(s.NamedNode,{MIN:{value:new s.NamedNode(o.MIN_NAME,v.EMPTY_NODE)},MAX:{value:new s.NamedNode(o.MAX_NAME,y)}}),u.KeyIndex.__EMPTY_NODE=v.EMPTY_NODE,d.LeafNode.__childrenNodeConstructor=v,(0,c.setMaxNode)(y),(0,l.setMaxNode)(y)},,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}();t.NamedNode=r},,,,,,,,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});t.jsonEval=function(e){return JSON.parse(e)},t.stringify=function(e){return JSON.stringify(e)}},,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(36),s=n(99),c=n(174),l=n(261),u=n(296),h=n(297),d=n(299),p=n(789),f=function(){function e(e,t,n,r){var i=this;this.sceneService=e,this.route=t,this.db=n,this.router=r,this.tacticalPlan=new s.TacticalPlan,this.ready=!1,this.models=new Map,this.modelsArray=p.ships;for(var o=0,a=this.modelsArray;o<a.length;o++){var c=a[o];this.models[c.name]=c}t.queryParams.subscribe(function(e){i.id||(i.id=e.id,i.id&&i.initPlans())})}return e.prototype.initPlans=function(){this.plan=this.db.database.ref("tactical-plans/"+this.id);var e=this;this.plan.once("value").then(function(t){var n=t.val();if(e.tacticalPlan.update(n,e,function(t){e.sceneService.removeShipModelFor(t)}),e.tacticalPlan.viewed!==e._getToday())return e.tacticalPlan.viewed=e._getToday(),void e.updateTacticalPlan();e.tacticalPlan.ships.forEach(function(t){var n=e.getModel(t.name);e.sceneService.addShipModelFor(e.getModel3d(n),t,n)}),e.ready=!0})},e.prototype.isReady=function(){return void 0!==this.id&&this.ready},e.prototype.getImage=function(e){return"assets/ships/thumbnails/"+e.name+".png"},e.prototype.getModel3d=function(e){return"assets/ships/"+e.name+".gltf"},e.prototype.getTacticalPlan=function(){return Promise.resolve(this.tacticalPlan)},e.prototype.addShip=function(e){for(var t=this,n=!1,r=0,i=this.tacticalPlan.ships;r<i.length;r++){if(i[r].name==e.name){n=!0;break}}if(n)return!1;var o=new s.ShipData(e.name);if(this.tacticalPlan.ships.push(o),this.plan)this.updateTacticalPlan();else{var a=this.db.list("/tactical-plans");this.tacticalPlan.updated=this._getToday(),this.tacticalPlan.viewed=this._getToday(),a.push(this.tacticalPlan).then(function(e){t.id=e.key,t.ready=!0,t.plan=e,t.router.navigate([t.router.url],t.getNavigationExtras())})}return this.sceneService.addShipModelFor(this.getModel3d(e),o,e),!0},e.prototype.updateTacticalPlan=function(){this.id&&(this.tacticalPlan.updated=this._getToday(),this.plan.set(this.tacticalPlan),this.tacticalPlan.verify(this))},e.prototype.deleteShip=function(e){for(var t=0;t<this.tacticalPlan.ships.length;t++){if(this.tacticalPlan.ships[t].name==e.name){this.tacticalPlan.ships.splice(t,1),this.updateTacticalPlan(),this.sceneService.removeShipModelFor(e.name);break}}},e.prototype.getNavigationExtras=function(){return{queryParams:{id:this.id},queryParamsHandling:"merge"}},e.prototype.getModels=function(){return Promise.resolve(this.modelsArray)},e.prototype.getModel=function(e){return this.models[e]},e.prototype.getShip=function(e){return this.tacticalPlan.ships.find(function(t){return t.name===e})},e.prototype.isConnected=function(){return void 0!==this.id},e.prototype.isUnlocked=function(){return!this.tacticalPlan.passwordHash||this.tacticalPlan.passwordHash==this.passwordHash},e.prototype.setPassword=function(e){null==this.tacticalPlan.passwordHash&&(this.tacticalPlan.passwordHash=d.stringify(h(u(e),e)),this.passwordHash=this.tacticalPlan.passwordHash,this.updateTacticalPlan())},e.prototype._getToday=function(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,r=e.getFullYear();return t<10&&(t="0"+t),n<10&&(n="0"+n),r+"/"+n+"/"+t},e=r([o.Injectable(),i("design:paramtypes",[c.SceneService,a.ActivatedRoute,l.AngularFireDatabase,a.Router])],e)}();t.ShipService=f},,,,,,,,,,,function(e,t,n){"use strict";function r(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=r+" argument "}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.errorPrefix=r;t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){var o=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}},t.validateNamespace=function(e,t,n,i){if((!i||n)&&"string"!=typeof n)throw new Error(r(e,t,i)+"must be a valid firebase namespace.")},t.validateCallback=function(e,t,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(r(e,t,i)+"must be a valid function.")},t.validateContextObject=function(e,t,n,o){if((!o||n)&&("object"!==(void 0===n?"undefined":i(n))||null===n))throw new Error(r(e,t,o)+"must be a valid context object.")}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.validateObjectContainsKey=t.validateObject=t.validateString=t.validateBoolean=t.validateCredential=t.validateUrl=t.validateWritablePath=t.validateRootPathString=t.validatePathString=t.validateKey=t.validateEventType=t.validatePriority=t.validateFirebaseMergeDataArg=t.validateFirebaseMergePaths=t.validateFirebaseData=t.validateFirebaseDataArg=t.isValidPriority=t.isValidRootPathString=t.isValidPathString=t.isValidKey=t.MAX_LEAF_SIZE_=t.INVALID_PATH_REGEX_=t.INVALID_KEY_REGEX_=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(16),o=n(11),a=n(7),s=n(68),c=n(175),l=t.INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,u=t.INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,h=t.MAX_LEAF_SIZE_=10485760,d=t.isValidKey=function(e){return"string"==typeof e&&0!==e.length&&!l.test(e)},p=t.isValidPathString=function(e){return"string"==typeof e&&0!==e.length&&!u.test(e)},f=t.isValidRootPathString=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),p(e)},v=t.isValidPriority=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!(0,a.isInvalidJSONNumber)(e)||e&&"object"===(void 0===e?"undefined":r(e))&&(0,o.contains)(e,".sv")},m=(t.validateFirebaseDataArg=function(e,t,n,r,i){i&&void 0===n||m((0,s.errorPrefix)(e,t,i),n,r)},t.validateFirebaseData=function e(t,n,s){var l=s instanceof i.Path?new i.ValidationPath(s,t):s;if(void 0===n)throw new Error(t+"contains undefined "+l.toErrorString());if("function"==typeof n)throw new Error(t+"contains a function "+l.toErrorString()+" with contents = "+n.toString());if((0,a.isInvalidJSONNumber)(n))throw new Error(t+"contains "+n.toString()+" "+l.toErrorString());if("string"==typeof n&&n.length>h/3&&(0,c.stringLength)(n)>h)throw new Error(t+"contains a string greater than "+h+" utf8 bytes "+l.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"===(void 0===n?"undefined":r(n))){var u=!1,p=!1;if((0,o.forEach)(n,function(n,r){if(".value"===n)u=!0;else if(".priority"!==n&&".sv"!==n&&(p=!0,!d(n)))throw new Error(t+" contains an invalid key ("+n+") "+l.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');l.push(n),e(t,r,l),l.pop()}),u&&p)throw new Error(t+' contains ".value" child '+l.toErrorString()+" in addition to actual children.")}}),y=t.validateFirebaseMergePaths=function(e,t){var n,r;for(n=0;n<t.length;n++){r=t[n];for(var o=r.slice(),a=0;a<o.length;a++)if(".priority"===o[a]&&a===o.length-1);else if(!d(o[a]))throw new Error(e+"contains an invalid key ("+o[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(i.Path.comparePaths);var s=null;for(n=0;n<t.length;n++){if(r=t[n],null!==s&&s.contains(r))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},g=(t.validateFirebaseMergeDataArg=function(e,t,n,a,c){if(!c||void 0!==n){var l=(0,s.errorPrefix)(e,t,c);if(!n||"object"!==(void 0===n?"undefined":r(n))||Array.isArray(n))throw new Error(l+" must be an object containing the children to replace.");var u=[];(0,o.forEach)(n,function(e,t){var n=new i.Path(e);if(m(l,t,a.child(n)),".priority"===n.getBack()&&!v(t))throw new Error(l+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");u.push(n)}),y(l,u)}},t.validatePriority=function(e,t,n,r){if(!r||void 0!==n){if((0,a.isInvalidJSONNumber)(n))throw new Error((0,s.errorPrefix)(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!v(n))throw new Error((0,s.errorPrefix)(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},t.validateEventType=function(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,s.errorPrefix)(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.validateKey=function(e,t,n,r){if(!(r&&void 0===n||d(n)))throw new Error((0,s.errorPrefix)(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},t.validatePathString=function(e,t,n,r){if(!(r&&void 0===n||p(n)))throw new Error((0,s.errorPrefix)(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')});t.validateRootPathString=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),g(e,t,n,r)},t.validateWritablePath=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},t.validateUrl=function(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!d(n.repoInfo.namespace)||0!==r.length&&!f(r))throw new Error((0,s.errorPrefix)(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},t.validateCredential=function(e,t,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw new Error((0,s.errorPrefix)(e,t,r)+"must be a valid credential (a string).")},t.validateBoolean=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,s.errorPrefix)(e,t,r)+"must be a boolean.")},t.validateString=function(e,t,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw new Error((0,s.errorPrefix)(e,t,r)+"must be a valid string.")},t.validateObject=function(e,t,n,i){if(!(i&&void 0===n||n&&"object"===(void 0===n?"undefined":r(n))&&null!==n))throw new Error((0,s.errorPrefix)(e,t,i)+"must be a valid object.")},t.validateObjectContainsKey=function(e,t,n,i,a,c){if(!n||"object"!==(void 0===n?"undefined":r(n))||!(0,o.contains)(n,i)){if(a)return;throw new Error((0,s.errorPrefix)(e,t,a)+'must contain the key "'+i+'"')}if(c){var l=(0,o.safeGet)(n,i);if("number"===c&&"number"!=typeof l||"string"===c&&"string"!=typeof l||"boolean"===c&&"boolean"!=typeof l||"function"===c&&"function"!=typeof l||"object"===c&&"object"!==(void 0===l?"undefined":r(l))&&l)throw a?new Error((0,s.errorPrefix)(e,t,a)+'contains invalid value for key "'+i+'" (must be of type "'+c+'")'):new Error((0,s.errorPrefix)(e,t,a)+'must contain the key "'+i+'" with type "'+c+'"')}}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.OperationSource=t.OperationType=void 0;var r=n(5),i=t.OperationType=void 0;!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(i||(t.OperationType=i={}));var o=function(){function e(e,t,n,i){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=i,(0,r.assert)(!i||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}();t.OperationSource=o},function(e,t){function n(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var o=r(i);return[n].concat(i.sources.map(function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"})).concat([o]).join("\n")}return[n].join("\n")}function r(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=n(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),i=n(37),o=n(736),a=n(737);t.MAX_HEIGHT=80;var s=function(){function e(e,t){this.data=e,this.shipModel=t,this.objects=[],this.vertexShader="\n        varying vec2 vUv;\n        uniform float p;\n        varying float intensity;\n\n        void main()\n        {\n            vUv = uv;\n            vec3 vNormal = normalize( normalMatrix * normal );\n            intensity = pow( 1.0 - abs(dot( vNormal, vec3( 0, 0, 1.0 ) ) ), p );\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n    ",this.fragmentShader="\n        uniform float baseSpeed;\n        uniform sampler2D baseTexture;\n        uniform sampler2D noiseTexture;\n        uniform float noiseScale;\n        uniform float alpha;\n        uniform float time;\n\n        varying vec2 vUv;\n        varying float intensity;\n        \n        void main()\n        {\n            vec2 uvTimeShift = vUv + vec2( -0.7, 1.5 ) * time * baseSpeed;\t\n            vec4 noiseGeneratorTimeShift = texture2D( noiseTexture, uvTimeShift );\n            vec2 uvNoiseTimeShift = vUv + noiseScale * vec2( noiseGeneratorTimeShift.r, noiseGeneratorTimeShift.b );\n            vec4 baseColor = texture2D( baseTexture, uvNoiseTimeShift );\n            baseColor.x = baseColor.x * intensity;\n            baseColor.y = baseColor.y * intensity;\n            baseColor.z = baseColor.z * intensity;\n            baseColor.a = 1.0;\n            gl_FragColor = baseColor;\n        }\n    "}return e.init=function(){var t=new i.TextureLoader;e.defaultShipColor=t.load("assets/ships/textures/defaultShipColor.png"),e.defaultShipColor.wrapS=this.defaultShipColor.wrapT=i.RepeatWrapping,e.enemyShipColor=t.load("assets/ships/textures/enemyShipColor.png"),e.enemyShipColor.wrapS=e.enemyShipColor.wrapT=i.RepeatWrapping,e.noiseTexture=t.load("assets/ships/textures/noise.png"),e.noiseTexture.wrapS=e.noiseTexture.wrapT=i.RepeatWrapping},e.prototype.clear=function(){if(this.objects=[],this.model&&this.model.children.length>3&&this.model.children.splice(3,this.model.children.length-3),this.model){var e=this.model.children[0].children.length;e>1&&this.model.children[0].children.splice(1,e-1)}this.removeShipFromScene()},e.prototype.isLoaded=function(){return void 0!==this.model},e.prototype.load=function(e){var t=new o.GLTF2Loader,n=this;t.load(e,function(e){n.model=e.scene,n.model.children[0].name=n.data.name})},e.prototype.addShipsToScene=function(e){if(this.model)for(var t=0;t<this.data.instances.length;t++)this._addShipTo(e,t,this.data.instances[t],this.shipModel.scale)},e.prototype.removeShipFromScene=function(){this.model&&this.model.parent&&this.model.parent.remove(this.model)},e.select=function(t,n){var r=t.parent.name+""+t.parent.userData.id;if(!t.parent.userData.selected){var o=(new i.Box3).setFromObject(t).getSize(),a=t.parent.userData.shipInstance,s=a.enemy?14483456:56797,c=new i.LineSegments(new i.EdgesGeometry(new i.BoxBufferGeometry(o.x,o.y,o.z),1),new i.LineBasicMaterial({color:s,transparent:!0,opacity:.3,linewidth:1,depthWrite:!1,depthTest:!0}));c.position.set(t.parent.position.x,t.parent.position.y,t.parent.position.z),n.add(c);var l=[];l.push(c),l=this.updateAnimationCurve(n,a,l,!1),e.selectedAids.set(r,l),t.parent.userData.selected=!0}},e.updateAnimationCurve=function(t,n,o,a){var s=[];if(s.push(new r.Vector3(n.position.x,n.position.y,n.position.z)),n.animation.forEach(function(e){s.push(new r.Vector3(e.position.x,e.position.y,e.position.z))}),s.length>1){var c=new i.CatmullRomCurve3(s),l=new i.Geometry;l.vertices=c.getPoints(50);var u=n.enemy?14483456:56797,h=new i.LineBasicMaterial({color:u,transparent:!0,opacity:.6}),d=new i.Line(l,h);1==o.length?(o.push(d),t.add(d)):o.length>1&&(t.remove(o[1]),o[1]=d,t.add(d))}else o.length>1&&t.remove(o[1]);if(a){this._removePoints(t);for(var p=0;p<s.length;p++){l=new i.SphereGeometry(2.5,16,16),u=0==p&&!n.visible||p>0&&!n.animation[p-1].visible?0:n.enemy?14483456:56797;var f=new i.MeshStandardMaterial({color:u,roughness:.7,metalness:.3}),v=new i.Mesh(l,f),m=s[p];v.position.set(m.x,m.y,m.z),e.points.push(v),t.add(v)}}return o},e.deselect=function(e,t){if(e.parent.userData.selected){var n=e.parent.name+""+e.parent.userData.id,r=this.selectedAids.get(n);r&&(r.forEach(function(e){t.remove(e)}),this.selectedAids.delete(n)),this._removePoints(t),e.parent.userData.selected=!1}},e.deselectAll=function(e,t){var n=this;this.selectedAids.forEach(function(e,r){var i=n.selectedAids.get(r);i&&(i.forEach(function(e){t.remove(e)}),n.selectedAids.delete(r))}),this._removePoints(t),e.forEach(function(e){e.parent.userData.selected=!1})},e.updateObjectPosition=function(t,n,r,i){t.parent.position.set(n,r,i),e.updateAidsPosition(t)},e.updateAidsPosition=function(n){if(n.parent.userData.selected){var r=n.parent.name+""+n.parent.userData.id;e.selectedAids.get(r)[0].position.set(n.parent.position.x,n.parent.position.y,n.parent.position.z)}n.parent.children.length>1&&(n.parent.children[1].children[0].scale.z=n.parent.position.y/t.MAX_HEIGHT)},e.moveUp=function(n,r){n.parent.position.y-=r,n.parent.position.y<-t.MAX_HEIGHT?n.parent.position.y=-t.MAX_HEIGHT:n.parent.position.y>t.MAX_HEIGHT&&(n.parent.position.y=t.MAX_HEIGHT),e.updateAidsPosition(n)},e.switchSide=function(t,n){var r=n?e.enemyShipColor:e.defaultShipColor;t.material.uniforms.baseTexture.value=r},e.updateAnimatedPosition=function(e,t,n){var o,a,s=null,c=[],l=e.parent.userData.shipInstance;if(0==n&&!l.visible||n>0&&n-1<l.animation.length&&!l.animation[n-1].visible)return void(e.parent.visible=!1);if(e.parent.visible=!0,0!=l.animation.length){if(c.push(new r.Vector3(l.position.x,l.position.y,l.position.z)),l.animation.forEach(function(e){c.push(new r.Vector3(e.position.x,e.position.y,e.position.z))}),c.length>1){var u=new i.CatmullRomCurve3(c);u.arcLengthDivisions=100;var h=15*t%3,d=0,p=u.getLength();if(0==p)o=c[0];else{p=0;for(var f=0;f+1<c.length;f++){var v=c[f].distanceTo(c[f+1]);p+=v,f==n?d+=v*h/3:f<n&&(d+=v)}if(d/=p,d>1&&(d=1),o=u.getPointAt(d),d+.01<=1)a=u.getPointAt(d+.01);else{var m=u.getPointAt(d-.01),y=new i.Vector3;y=y.subVectors(o,m),a=o.clone().add(y)}s=u.getTangentAt(d)}}else o=c[0];this.updateObjectPosition(e,o.x,o.y,o.z),s&&(e.parent.rotation.set(s.x,s.y,s.z),e.parent.lookAt(a))}},e.updateSquadron=function(t,n){if(t.squadron&&t.squadron>=1){for(var r=n.children.length-1;r>=0;r--){"squadron"==n.children[r].name&&n.children.splice(r,1)}for(var o=1;o<t.squadron;o++){var a=new i.Mesh(n.children[0].geometry,n.children[0].material);a.name="squadron";var s=e.squadronPositions[t.squadron-2];a.rotation.set(-Math.PI/2,Math.PI,0),a.position.set(s[o-1].x,s[o-1].y,s[o-1].z),n.add(a)}}},e.prototype._addShipTo=function(t,n,r,o){e.defaultShipColor&&e.enemyShipColor&&e.noiseTexture||e.init();var a=r.enemy?e.enemyShipColor:e.defaultShipColor,s=r.enemy?14483456:56797;o/=2;var c={baseTexture:{type:"t",value:a},baseSpeed:{type:"f",value:.3},noiseTexture:{type:"t",value:e.noiseTexture},noiseScale:{type:"f",value:.5},alpha:{type:"f",value:1},time:e.time,p:{type:"f",value:1.3}},l=new i.ShaderMaterial({uniforms:c,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,blending:i.AdditiveBlending,transparent:!0,depthWrite:!1,depthTest:!0});if(void 0==t.getObjectByName(this.data.name)){var u=this.model.children[0];u.children[0].geometry.computeVertexNormals(),u.children[0].geometry.computeBoundingBox(),this._setObject3d(n,u,s,o,r,l),e.updateSquadron(r,u),t.add(this.model)}else{var u=this.model.children[0].clone(!1),h=new i.Mesh(this.model.children[0].children[0].geometry,l);h.rotation.set(-Math.PI/2,Math.PI,0),u.add(h),this._setObject3d(n,u,s,o,r,l),e.updateSquadron(r,u),this.model.add(u)}},e.prototype._setObject3d=function(e,n,o,s,c,l){n.position.set(c.position.x,c.position.y,c.position.z),n.scale.set(s,s,s),n.rotation.set(c.rotation.x,c.rotation.y,c.rotation.z),n.children[0].rotation.set(-Math.PI/2,Math.PI,0),n.children[0].material=l,n.userData.id=e,n.userData.shipData=this.data,n.userData.shipModel=this.shipModel,n.userData.shipInstance=c,n.userData.selected=!1,this.objects.push(n.children[0]);var u=new i.Geometry;u.vertices.push(new r.Vector3(0,0,t.MAX_HEIGHT/s)),u.vertices.push(new r.Vector3(0,0,0));var h=new i.Line(u,new i.LineBasicMaterial({color:o,transparent:!0,opacity:.3,linewidth:1,depthWrite:!1,depthTest:!0}));h.scale.z=c.position.y/t.MAX_HEIGHT,h.rotateX(Math.PI/2);var d=new a.Gyroscope;d.add(h),n.add(d)},e.getNextPosition=function(){var t=e.currentX,n=e.currentZ;return e.currentX=e.currentX+e.stepSize,e.currentX+e.currentZ>30&&(e.currentX=-e.currentX,e.currentZ-=e.stepSize),new r.Vector3(-t,1,n)},e._removePoints=function(e){this.points.forEach(function(t){e.remove(t)}),this.points.splice(0,this.points.length)},e.stepSize=10,e.currentZ=30,e.currentX=0,e.time={type:"f",value:1},e.needsUpdate=!1,e.selectedAids=new Map,e.points=[],e.squadronPositions=[[{x:-3e3,y:0,z:0}],[{x:1500,y:0,z:-3e3},{x:-1500,y:0,z:-3e3}],[{x:-3e3,y:0,z:0},{x:1500,y:0,z:-3e3},{x:-4500,y:0,z:-3e3}],[{x:1500,y:0,z:-3e3},{x:-1500,y:0,z:-3e3},{x:3e3,y:0,z:-6e3},{x:-3e3,y:0,z:-6e3}],[{x:1500,y:0,z:-3e3},{x:-1500,y:0,z:-3e3},{x:3e3,y:0,z:-6e3},{x:-3e3,y:0,z:-6e3},{x:0,y:0,z:-6e3}],[{x:-3e3,y:0,z:0},{x:1500,y:0,z:-3e3},{x:-4500,y:0,z:-3e3},{x:-1500,y:0,z:-3e3},{x:3e3,y:0,z:-6e3},{x:-6e3,y:0,z:-6e3}],[{x:1500,y:0,z:-3e3},{x:-1500,y:0,z:-3e3},{x:3e3,y:0,z:-6e3},{x:-3e3,y:0,z:-6e3},{x:0,y:0,z:-6e3},{x:4500,y:0,z:-9e3},{x:-4500,y:0,z:-9e3}]],e}();t.ShipModel3D=s},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(t){var n=t.INTERNAL.registerService("database",function(e){return h.RepoManager.getInstance().databaseFromApp(e)},{Reference:l.Reference,Query:c.Query,Database:s.Database,enableLogging:u.enableLogging,INTERNAL:p,ServerValue:s.Database.ServerValue,TEST_ACCESS:v});(0,m.isNodeSdk)()&&(e.exports=n)}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/

---

typedarray.js
Copyright (c) 2010, Linden Research, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE. */
Object.defineProperty(t,"__esModule",{value:!0}),t.registerDatabase=i;var o=n(128),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(265),c=n(268),l=n(176),u=n(7),h=n(181),d=n(781),p=r(d),f=n(782),v=r(f),m=n(78);i(a.default)},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.attachDummyErrorHandler=t.Deferred=t.PromiseImpl=void 0;var r=n(263),i=t.PromiseImpl=r.globalScope.Promise||n(742),o=function(){function e(){var e=this;this.resolve=null,this.reject=null,this.promise=new i(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){function t(t,r){t?n.reject(t):n.resolve(r),"function"==typeof e&&(a(n.promise),1===e.length?e(t):e(t,r))}var n=this;return t},e}();t.Deferred=o;var a=t.attachDummyErrorHandler=function(e){e.catch(function(){})}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeSdk=t.isReactNative=t.isMobileCordova=t.getUA=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(129),o=t.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""};t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(o())},t.isReactNative=function(){return"object"===("undefined"==typeof navigator?"undefined":r(navigator))&&"ReactNative"===navigator.product},t.isNodeSdk=function(){return!0===i.CONSTANTS.NODE_CLIENT||!0===i.CONSTANTS.NODE_ADMIN}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,n){return new e(e.CHILD_ADDED,n,t)},e.childRemovedChange=function(t,n){return new e(e.CHILD_REMOVED,n,t)},e.childChangedChange=function(t,n,r){return new e(e.CHILD_CHANGED,n,t,r)},e.childMovedChange=function(t,n){return new e(e.CHILD_MOVED,n,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}();t.Change=r},function(e,t,n){!function(n,r){e.exports=t=r()}(0,function(){var e=e||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},i=r.lib={},o=i.Base=function(){return{extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=0;i<t;i+=4){var o=function(t){var t=t,n=987654321,r=4294967295;return function(){n=36969*(65535&n)+(n>>16)&r,t=18e3*(65535&t)+(t>>16)&r;var i=(n<<16)+t&r;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}}(4294967296*(n||e.random()));n=987654071*o(),r.push(4294967296*o()|0)}return new a.init(r,t)}}),s=r.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},h=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=4*o,c=i/s;c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0);var l=c*o,u=e.min(4*l,i);if(l){for(var h=0;h<l;h+=o)this._doProcessBlock(r,h);var d=r.splice(0,l);n.sigBytes-=u}return new a.init(d,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(i.Hasher=h.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math);return e})},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),i=n(75),o=function(){function e(){this.ships=[],this.passwordHash=null,this.players=["?"],this.updated=null,this.viewed=null,this.settings=null,this.verify(null)}return e.prototype.verify=function(e){void 0==this.passwordHash&&(this.passwordHash=null),void 0==this.players&&(this.players=["?"]),void 0==this.updated&&(this.updated=null),void 0==this.viewed&&(this.viewed=null),void 0==this.settings&&(this.settings=new u,this.settings.background="Starfarer (default)",this.settings.animationLength=30,this.settings.showVisualAids=!0),this.ships.forEach(function(t){for(;t.instances.length<t.amount;)t.instances.push(new s);t.instances.length>t.amount&&t.instances.splice(t.amount,t.instances.length-t.amount),t.instances.forEach(function(n){if(n.position||(n.position=i.ShipModel3D.getNextPosition()),n.rotation||(n.rotation=new r.Vector3(0,0,0)),n.pilot||(n.pilot="?"),n.enemy||(n.enemy=!1),!n.crewmen){var o=e.getModel(t.name).maxcrew-1;n.crewmen=new Array(o);for(var a=0;a<o;++a)n.crewmen[a]="?"}n.animation||(n.animation=[]),n.squadron||(n.squadron=null)})})},e.prototype.update=function(e,t,n){this.passwordHash=e.passwordHash,this.players=e.players,this.updated=e.updated,this.viewed=e.viewed,this.settings=e.settings;var i=e&&e.ships?e.ships.length:0,o=this.ships.length-i;if(o>0)for(var a=0;a<this.ships.length;a++){if(a>=i){o=this.ships.length-a;for(var s=a;s<this.ships.length;s++)n(this.ships[s].name);this.ships.splice(a,o);break}this.ships[a].name!==e.ships[a].name&&(n(this.ships[a].name),this.ships.splice(a,1),a--)}for(var c=0;c<i;c++){var l=e.ships[c];if(c<this.ships.length){var u=this.ships[c];u.name=l.name,u.amount=l.amount;var h=l.amount;if((o=u.instances.length-h)>0)u.instances.splice(h,o);else for(var d=0;d<h;d++)if(d<u.instances.length){var p=u.instances[d];p.position||(p.position=new r.Vector3),l.instances&&l.instances[d]&&l.instances[d].position&&(p.position.x=l.instances[d].position.x,p.position.y=l.instances[d].position.y,p.position.z=l.instances[d].position.z),p.rotation||(p.rotation=new r.Vector3),l.instances&&l.instances[d]&&l.instances[d].rotation&&(p.rotation.x=l.instances[d].rotation.x,p.rotation.y=l.instances[d].rotation.y,p.rotation.z=l.instances[d].rotation.z),l.instances&&l.instances[d]&&(p.pilot=l.instances[d].pilot,p.enemy=l.instances[d].enemy),l.instances&&l.instances[d]&&l.instances[d].crewmen&&(p.crewmen=l.instances[d].crewmen),l.instances&&l.instances[d]&&l.instances[d].animation&&(p.animation=l.instances[d].animation),l.instances&&l.instances[d]&&l.instances[d].squadron&&(p.squadron=l.instances[d].squadron)}else l.instances&&d<l.instances.length&&u.instances.push(l.instances[d])}else l.instances||(l.instances=[]),this.ships.push(l)}this.verify(t)},e}();t.TacticalPlan=o;var a=function(){function e(e){this.name=e,this.amount=1,this.instances=[]}return e}();t.ShipData=a;var s=function(){function e(){this.crewmen=[],this.enemy=!1,this.visible=!0}return e}();t.ShipInstance=s;var c=function(){function e(){}return e}();t.Ship=c;var l=function(){function e(){this.visible=!0}return e}();t.AnimationFrame=l;var u=function(){function e(){}return e}();t.Settings=u,t.BACKGROUNDS=new Map([["Starfarer (default)","assets/images/background/starfarer-cockpit.png"],["Freelancer","assets/images/background/freelancer-cockpit.png"],["Galaxy","assets/images/background/galaxy.png"],["Dark","dark"]])},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_INDEX=t.KeyIndex=void 0;var r,i=n(132),o=n(33),a=n(7),s=n(5),c=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return r},set:function(e){r=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return(0,a.nameCompare)(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw(0,s.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return o.NamedNode.MIN},t.prototype.maxPost=function(){return new o.NamedNode(a.MAX_NAME,r)},t.prototype.makePost=function(e,t){return(0,s.assert)("string"==typeof e,"KeyIndex indexValue must always be a string."),new o.NamedNode(e,r)},t.prototype.toString=function(){return".key"},t}(i.Index);t.KeyIndex=l;t.KEY_INDEX=new l},function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=null),null===e)return o.ChildrenNode.EMPTY_NODE;if("object"===(void 0===e?"undefined":i(e))&&".priority"in e&&(t=e[".priority"]),(0,l.assert)(null===t||"string"==typeof t||"number"==typeof t||"object"===(void 0===t?"undefined":i(t))&&".sv"in t,"Invalid priority type found: "+(void 0===t?"undefined":i(t))),"object"===(void 0===e?"undefined":i(e))&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==(void 0===e?"undefined":i(e))||".sv"in e){var n=e;return new a.LeafNode(n,r(t))}if(e instanceof Array||!f){var v=o.ChildrenNode.EMPTY_NODE,m=e;return(0,c.forEach)(m,function(e,t){if((0,c.contains)(m,e)&&"."!==e.substring(0,1)){var n=r(t);!n.isLeafNode()&&n.isEmpty()||(v=v.updateImmediateChild(e,n))}}),v.updatePriority(r(t))}var y=[],g=!1,_=e;if((0,c.forEach)(_,function(e,t){if("string"!=typeof e||"."!==e.substring(0,1)){var n=r(_[e]);n.isEmpty()||(g=g||!n.getPriority().isEmpty(),y.push(new s.NamedNode(e,n)))}}),0==y.length)return o.ChildrenNode.EMPTY_NODE;var b=(0,u.buildChildSet)(y,h.NAME_ONLY_COMPARATOR,function(e){return e.name},h.NAME_COMPARATOR);if(g){var S=(0,u.buildChildSet)(y,p.PRIORITY_INDEX.getCompare());return new o.ChildrenNode(b,r(t),new d.IndexMap({".priority":S},{".priority":p.PRIORITY_INDEX}))}return new o.ChildrenNode(b,r(t),d.IndexMap.Default)}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.nodeFromJSON=r;var o=n(30),a=n(133),s=n(33),c=n(11),l=n(5),u=n(272),h=n(273),d=n(271),p=n(25),f=!0;(0,p.setNodeFromJSON)(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(783);n.d(t,"FirebaseAppProvider",function(){return r.e}),n.d(t,"AngularFireModule",function(){return r.a}),n.d(t,"ZoneScheduler",function(){return r.f}),n.d(t,"FirebaseApp",function(){return r.b}),n.d(t,"FirebaseAppName",function(){return r.d}),n.d(t,"FirebaseAppConfigToken",function(){return r.c});var i=n(290);n.d(t,"ɵa",function(){return i.c})},function(e,t,n){"use strict";function r(e){return void 0===e||null===e}function i(e,t){return e&&void 0!==e[t]}function o(e){return"string"==typeof e}function a(e){return"function"==typeof e.set}function s(e){return"function"==typeof e.exportVal}function c(e){return"string"==typeof e.$key}function l(e){return!r(e)&&(0===Object.keys(e).length&&JSON.stringify(e)===JSON.stringify({}))}function u(e){var t=r(e.val())?{$value:null}:e.val();return/string|number|boolean/.test(typeof t)&&(t={$value:t}),Object.defineProperty(t,"$key",{value:e.ref.key,enumerable:!1}),Object.defineProperty(t,"$exists",{value:function(){return e.exists()},enumerable:!1}),t}function h(e){return p.test(e)}function d(e,t){if(a(t))return t;var n=t;return h(t)?e.database().refFromURL(n):e.database().ref(n)}t.g=r,t.b=i,t.h=o,t.f=a,t.e=s,t.c=c,t.d=l,t.i=u,t.a=d;var p=/^[a-z]+:\/\/.*/},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),s=n(74),c=n(37),l=n(37),u=n(36),h=n(75),d=n(75),p=n(174),f=n(57),v=n(99),m=n(182),y=n(790),g=n(791),_=function(){function e(e,t,n,r,i){this.sceneService=e,this.shipService=t,this.router=n,this.mdDialog=r,this.joystick=i,this.loadingProgress=0,this.loaded=!1,this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight-5,this.scene=new c.Scene,this.camera=new y.OrbitCamera(60,this.screenWidth/this.screenHeight,10,700),this.renderer=new c.WebGLRenderer({antialias:!0}),this.text="ahoj",this.bgScene=new l.Scene,this.bgCam=new l.Camera,this.tanFOV=Math.tan(Math.PI/180*this.camera.fov/2),this.windowHeight=window.innerHeight,this.Arr=Array,this.aidsVisible=!0,this.clock=new l.Clock,this.currentTime=0,this.timeSec=0,this.maxTime=15,this.play=!1,this.cameraLockedTo=null}return e.prototype.ngAfterViewInit=function(){window.onerror=function(){},this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.screenWidth,this.screenHeight),this.renderer.domElement.style.position="relative",this.renderer.setClearColor(15658734),this.configureLight(),this.scene.add(this.directionalLight),this.scene.add(new c.AmbientLight(new c.Color(.8,.8,.8).getHex())),this.addGrid(),this.start()},e.prototype.addBackground=function(e){var t,n=e.settings.background;n||(n="assets/images/background/starfarer-cockpit.png");var r=v.BACKGROUNDS.get(n);if(r&&(n=r),"dark"===n)t=new l.MeshBasicMaterial({color:592137});else{var i=new l.TextureLoader,o=i.load(n);t=new l.MeshBasicMaterial({map:o})}var a=new l.Mesh(new l.PlaneGeometry(2,2,0),t);a.material.depthTest=!1,a.material.depthWrite=!1,this.bgScene.add(this.bgCam),this.bgScene.add(a)},e.prototype.addGrid=function(){var e,t,n=this.renderer.capabilities.getMaxAnisotropy();t=(new l.TextureLoader).load("assets/images/grid256.png"),t.anisotropy=n,t.wrapS=l.RepeatWrapping,t.wrapT=l.RepeatWrapping,t.repeat.set(60,60);var r=(new l.TextureLoader).load("assets/images/grid256.png");t.mipmaps[0]=r.image;var i=(new l.TextureLoader).load("assets/images/grid128.png");t.mipmaps[1]=i.image;var o=(new l.TextureLoader).load("assets/images/grid64.png");t.mipmaps[2]=o.image;var a=(new l.TextureLoader).load("assets/images/grid32.png");t.mipmaps[3]=a.image;var s=(new l.TextureLoader).load("assets/images/grid16.png");t.mipmaps[4]=s.image;var c=(new l.TextureLoader).load("assets/images/grid8.png");t.mipmaps[5]=c.image;var u=(new l.TextureLoader).load("assets/images/grid4.png");t.mipmaps[6]=u.image;var h=(new l.TextureLoader).load("assets/images/grid2.png");t.mipmaps[7]=h.image;var p=(new l.TextureLoader).load("assets/images/grid1.png");t.mipmaps[8]=p.image,e=new l.MeshBasicMaterial({map:t,transparent:!0,opacity:1,side:l.DoubleSide,depthWrite:!1,depthTest:!0}),this.grid=new l.Mesh(new l.PlaneGeometry(250,250),e),this.grid.rotation.x=Math.PI/2,this.grid.position.y=-1,this.grid.position.z=0;var f=new l.MeshLambertMaterial({transparent:!0,opacity:0,side:l.DoubleSide,depthWrite:!1,depthTest:!1});this.virtualGrid=new l.Mesh(new l.PlaneGeometry(250,250),f),this.virtualGrid.rotation.x=Math.PI/2,this.virtualGrid.position.y=-1,this.virtualGrid.position.z=0,e=new l.MeshStandardMaterial({color:16777215,transparent:!0,opacity:.15,side:l.DoubleSide,depthTest:!1}),this.marqueeBox=new l.Mesh(new l.PlaneGeometry(1,1),e),this.marqueeBox.position.set(0,0,0),this.marqueeBox.rotation.x=Math.PI/2,this.marqueeBox.visible=!1;var v=new l.BoxGeometry(1,1,1);e=new l.MeshBasicMaterial({color:2642263,transparent:!1,depthWrite:!0,depthTest:!0});var m=new l.Mesh(v,e);m.position.set(0,-1,0),m.scale.set(.5,2*d.MAX_HEIGHT,.5),e=new l.MeshBasicMaterial({color:2642263,transparent:!1,depthWrite:!0,depthTest:!0});var y=new l.Mesh(v,e);y.position.set(0,-1,0),y.scale.set(250,.5,.5),e=new l.MeshBasicMaterial({color:2642263,transparent:!1,depthWrite:!0,depthTest:!0});var g=new l.Mesh(v,e);g.position.set(0,-1,0),g.scale.set(.5,.5,250),this.scene.add(this.marqueeBox),this.scene.add(y),this.scene.add(m),this.scene.add(g),this.scene.add(this.grid),this.scene.add(this.virtualGrid)},e.prototype.configureLight=function(){this.directionalLight=new c.DirectionalLight(16777215),this.directionalLight.position.set(0,200,0),this.directionalLight.lookAt(new c.Vector3(0,0,0))},e.prototype.configureControls=function(){var e=this;this.joystick.updateLocation(window.innerWidth,window.innerHeight),this.joystick.added=!1,this.joystick.show();var t=function(t){e.currentTime+=t,e.changeCurrentTime(e.currentTime)};this.controller=new g.Controller(this.scene,this.shipService,this.virtualGrid,this.camera,this.joystick,this.marqueeBox,t),this.controller.enable(this.renderer.domElement)},e.prototype.render=function(){var e=this;requestAnimationFrame(function(){return e.render()});var t=this.clock.getDelta();h.ShipModel3D.time.value+=t,this.play&&(this.currentTime+=t,this.changeCurrentTime(this.currentTime)),this.cameraLockedTo&&this.camera.center.set(this.cameraLockedTo.parent.position.x,this.cameraLockedTo.parent.position.y,this.cameraLockedTo.parent.position.z),this.camera.update(t),this.joystick.update(),this.controller.update(t),this.renderer.autoClear=!1,this.renderer.clear(),this.renderer.render(this.bgScene,this.bgCam),this.renderer.render(this.scene,this.camera)},e.prototype.start=function(){var e=this;this.shipService.getTacticalPlan().then(function(t){if(t.verify(e.shipService),e.addBackground(t),e.maxTime=t.settings.animationLength,e.loadingProgress=e.sceneService.loadingProgress(),e.shipService.isReady()&&100==e.loadingProgress){e.loaded=!0,e.configureControls(),e.container.nativeElement.appendChild(e.renderer.domElement);var n=e;h.ShipModel3D.init(),n.controller.reset(),n.sceneService.shipModels3d.forEach(function(e,t){e.clear(),e.addShipsToScene(n.scene),e.objects.forEach(function(e){return n.controller.actionableObjects.push(e)})}),e.showAids(t.settings.showVisualAids),e.shipService.updateTacticalPlan(),e.resetAnimation(),e.render()}else setTimeout(function(){e.start()},500)})},e.prototype.showInfo=function(){var e=this.controller.getAllSelected();if(1==e.length){var t=e[0].parent.userData;this.selectedShip=t.shipModel,this.selectedShipInstance=t.shipData.instances[t.id],this.joystick.hide(),this.controller.disable(this.renderer.domElement),this.shipInfoBar.toggle()}},e.prototype.onCloseShipInfo=function(){this.controller.enable(this.renderer.domElement),this.joystick.show()},e.prototype.onShipInfoChange=function(){this.shipService.updateTacticalPlan()},e.prototype.saveImage=function(){this.controller.deselectAll(),this.render();var e=this.renderer.domElement.toDataURL(),t=document.createElement("a");t.href=e.replace("image/png","image/octet-stream"),t.download="tactical-plan.png";var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});t.dispatchEvent(n)},e.prototype.onResize=function(e){this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight-5,this.camera.aspect=this.screenWidth/this.screenHeight,this.camera.fov=360/Math.PI*Math.atan(this.tanFOV*(this.screenHeight/this.windowHeight)),this.camera.updateProjectionMatrix(),this.camera.lookAt(this.scene.position),this.joystick.updateLocation(window.innerWidth,window.innerHeight),this.renderer.setSize(this.screenWidth,this.screenHeight)},e.prototype.manageCrew=function(){var e=this;this.mdDialog.open(b,{data:{players:this.shipService.tacticalPlan.players.join("\n")}}).afterClosed().subscribe(function(t){t&&"Cancel"!==t&&(e.shipService.tacticalPlan.players=t.split("\n").filter(Boolean),e.shipService.updateTacticalPlan())})},e.prototype.switchCameraView=function(){this.camera.switch()},e.prototype.lookAtShip=function(){var e=this.controller.getAllSelected();if(1==e.length){if(this.cameraLockedTo==e[0])return void(this.cameraLockedTo=null);this.cameraLockedTo=e[0],this.controller.lookAtSelectedShip(this.cameraLockedTo)}else this.cameraLockedTo=null},e.prototype.switchSide=function(){this.controller.switchSideOfSelectedShips()},e.prototype.showAids=function(e){this.aidsVisible=e,this.controller.actionableObjects.forEach(function(t){t.parent.children[1].children[0].visible=e})},e.prototype.showControls=function(){this.mdDialog.open(S)},e.prototype.playAnimation=function(){this.play?this.play=!1:(this.play=!0,this.currentTime==this.maxTime&&this.resetAnimation())},e.prototype.resetAnimation=function(){this.changeCurrentTime(0)},e.prototype.onChangeAnimation=function(e){var t=e.layerX/e.target.offsetWidth*this.maxTime;this.changeCurrentTime(t)},e.prototype.changeCurrentTime=function(e){var t=this;this.currentTime=e,this.timeSec=Math.floor(this.currentTime),this.timeSec>this.maxTime&&(this.timeSec=this.maxTime),this.currentTime>=this.maxTime&&(this.currentTime=this.maxTime,this.play=!1),this.controller.currentAnimationFrame=Math.floor(this.currentTime/(this.maxTime/5)),this.controller.actionableObjects.forEach(function(e){h.ShipModel3D.updateAnimatedPosition(e,t.currentTime/t.maxTime,t.controller.currentAnimationFrame)})},e.prototype.recording=function(){var e=this;this.controller.recording=!this.controller.recording,this.controller.recording?this.controller.getAllSelected().forEach(function(t){e.controller.updateAnimationCurveFor(t)}):h.ShipModel3D._removePoints(this.scene)},e.prototype.isSquadron=function(){var e=this.controller.getAllSelected();return 1===e.length&&"S"===e[0].parent.userData.shipModel.size},e.prototype.squadron=function(e){var t=this.controller.getAllSelected();if(1===t.length){var n=t[0],r=n.parent.userData.shipInstance;(!r.squadron||r.squadron<1)&&(r.squadron=1),r.squadron+e<=8&&r.squadron+e>=1&&(r.squadron=r.squadron+e,h.ShipModel3D.updateSquadron(r,n.parent),this.shipService.updateTacticalPlan())}},r([a.ViewChild("container"),i("design:type",Object)],e.prototype,"container",void 0),r([a.ViewChild("shipInfo"),i("design:type",s.MdSidenav)],e.prototype,"shipInfoBar",void 0),r([a.Input(),i("design:type",Object)],e.prototype,"timeSec",void 0),r([a.HostListener("window:resize",["$event"]),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],e.prototype,"onResize",null),e=r([a.Component({selector:"simulator",template:n(792),styles:[n(793)]}),i("design:paramtypes",[p.SceneService,f.ShipService,u.Router,s.MdDialog,m.Joystick])],e)}();t.SimulatorComponent=_;var b=function(){function e(e,t){this.dialogRef=e,this.data=t}return e=r([a.Component({selector:"crew-dialog",template:n(795)}),o(1,a.Inject(s.MD_DIALOG_DATA)),i("design:paramtypes",[s.MdDialogRef,Object])],e)}();t.CrewDialogComponent=b;var S=function(){function e(e){this.dialogRef=e}return e=r([a.Component({selector:"controls-dialog",template:n(796)}),i("design:paramtypes",[s.MdDialogRef])],e)}();t.ControlsDialogComponent=S},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),n(739);var r=n(740),i=(0,r.createFirebaseNamespace)();t.default=i,e.exports=t.default},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});t.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"4.3.0"}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStorage=t.PersistentStorage=void 0;var r=n(747),i=n(748),o=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new r.DOMStorageWrapper(t)}}catch(e){}return new i.MemoryStorage};t.PersistentStorage=o("localStorage"),t.SessionStorage=o("sessionStorage")},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});t.PROTOCOL_VERSION="5",t.VERSION_PARAM="v",t.TRANSPORT_SESSION_PARAM="s",t.REFERER_PARAM="r",t.FORGE_REF="f",t.FORGE_DOMAIN="firebaseio.com",t.LAST_SESSION_PARAM="ls",t.WEBSOCKET="websocket",t.LONG_POLLING="long_polling"},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Index=void 0;var r=n(33),i=n(7),o=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new r.NamedNode(i.MIN_NAME,e),o=new r.NamedNode(i.MIN_NAME,t);return 0!==this.compare(n,o)},e.prototype.minPost=function(){return r.NamedNode.MIN},e}();t.Index=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.LeafNode=void 0;var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(5),a=n(7),s=n(269),c=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,(0,o.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),(0,s.validatePriorityNode)(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return r},set:function(e){r=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=t.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.assert)(".priority"!==r||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+(0,s.priorityHashText)(this.priorityNode_.val())+":");var t=i(this.value_);e+=t+":",e+="number"===t?(0,a.doubleToIEEE754String)(this.value_):this.value_,this.lazyHash_=(0,a.sha1)(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:((0,o.assert)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=i(t.value_),r=i(this.value_),a=e.VALUE_TYPE_ORDER.indexOf(n),s=e.VALUE_TYPE_ORDER.indexOf(r);return(0,o.assert)(a>=0,"Unknown leaf type: "+n),(0,o.assert)(s>=0,"Unknown leaf type: "+r),a===s?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-a},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();t.LeafNode=c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Repo=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(276),o=n(101),a=n(16),s=n(277),c=n(754),l=n(765),u=n(42),h=n(7),d=n(11),p=n(766),f=n(180),v=n(768),m=n(282),y=n(769),g=n(283),_=n(775),b=n(265),S=function(){function e(e,t,n){var i=this;this.repoInfo_=e,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new y.EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new s.SparseSnapshotTree,this.persistentConnection_=null;var o=new p.AuthTokenProvider(n);if(this.stats_=f.StatsManager.getCollection(e),t||(0,h.beingCrawled)())this.server_=new _.ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),o),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var a=n.options.databaseAuthVariableOverride;if(void 0!==a&&null!==a){if("object"!==(void 0===a?"undefined":r(a)))throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,u.stringify)(a)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new g.PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),o,a),this.server_=this.persistentConnection_}o.addTokenChangeListener(function(e){i.server_.refreshAuthToken(e)}),this.statsReporter_=f.StatsManager.getOrCreateReporter(e,function(){return new v.StatsReporter(i.stats_,i.server_)}),this.transactions_init_(),this.infoData_=new l.SnapshotHolder,this.infoSyncTree_=new c.SyncTree({startListening:function(e,t,n,r){var o=[],a=i.infoData_.getNode(e.path);return a.isEmpty()||(o=i.infoSyncTree_.applyServerOverwrite(e.path,a),setTimeout(function(){r("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new c.SyncTree({startListening:function(e,t,n,r){return i.server_.listen(e,n,t,function(t,n){var o=r(t,n);i.eventQueue_.raiseEventsForChangedPath(e.path,o)}),[]},stopListening:function(e,t){i.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new a.Path(".info/serverTimeOffset")),t=e.val()||0;return(new Date).getTime()+t},e.prototype.generateServerValues=function(){return(0,i.generateWithValues)({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new a.Path(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var s=[];if(r)if(n){var c=(0,d.map)(t,function(e){return(0,o.nodeFromJSON)(e)});s=this.serverSyncTree_.applyTaggedQueryMerge(i,c,r)}else{var l=(0,o.nodeFromJSON)(t);s=this.serverSyncTree_.applyTaggedQueryOverwrite(i,l,r)}else if(n){var u=(0,d.map)(t,function(e){return(0,o.nodeFromJSON)(e)});s=this.serverSyncTree_.applyServerMerge(i,u)}else{var h=(0,o.nodeFromJSON)(t);s=this.serverSyncTree_.applyServerOverwrite(i,h)}var p=i;s.length>0&&(p=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(p,s)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;(0,h.each)(e,function(e,n){t.updateInfo_(n,e)})},e.prototype.updateInfo_=function(e,t){var n=new a.Path("/.info/"+e),r=(0,o.nodeFromJSON)(t);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,n,r){var a=this;this.log_("set",{path:e.toString(),value:t,priority:n});var s=this.generateServerValues(),c=(0,o.nodeFromJSON)(t,n),l=(0,i.resolveDeferredValueSnapshot)(c,s),u=this.getNextWriteId_(),d=this.serverSyncTree_.applyUserOverwrite(e,l,u,!0);this.eventQueue_.queueEvents(d),this.server_.put(e.toString(),c.val(!0),function(t,n){var i="ok"===t;i||(0,h.warn)("set at "+e+" failed: "+t);var o=a.serverSyncTree_.ackUserWrite(u,!i);a.eventQueue_.raiseEventsForChangedPath(e,o),a.callOnCompleteCallback(r,t,n)});var p=this.abortTransactions_(e);this.rerunTransactions_(p),this.eventQueue_.raiseEventsForChangedPath(p,[])},e.prototype.update=function(e,t,n){var r=this;this.log_("update",{path:e.toString(),value:t});var a=!0,s=this.generateServerValues(),c={};if((0,d.forEach)(t,function(e,t){a=!1;var n=(0,o.nodeFromJSON)(t);c[e]=(0,i.resolveDeferredValueSnapshot)(n,s)}),a)(0,h.log)("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var l=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(e,c,l);this.eventQueue_.queueEvents(u),this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||(0,h.warn)("update at "+e+" failed: "+t);var a=r.serverSyncTree_.ackUserWrite(l,!o),s=a.length>0?r.rerunTransactions_(e):e;r.eventQueue_.raiseEventsForChangedPath(s,a),r.callOnCompleteCallback(n,t,i)}),(0,d.forEach)(t,function(t){var n=r.abortTransactions_(e.child(t));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),n=(0,i.resolveDeferredValueTree)(this.onDisconnect_,t),r=[];n.forEachTree(a.Path.Empty,function(t,n){r=r.concat(e.serverSyncTree_.applyServerOverwrite(t,n));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new s.SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(a.Path.Empty,r)},e.prototype.onDisconnectCancel=function(e,t){var n=this;this.server_.onDisconnectCancel(e.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(e),n.callOnCompleteCallback(t,r,i)})},e.prototype.onDisconnectSet=function(e,t,n){var r=this,i=(0,o.nodeFromJSON)(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,o){"ok"===t&&r.onDisconnect_.remember(e,i),r.callOnCompleteCallback(n,t,o)})},e.prototype.onDisconnectSetWithPriority=function(e,t,n,r){var i=this,a=(0,o.nodeFromJSON)(t,n);this.server_.onDisconnectPut(e.toString(),a.val(!0),function(t,n){"ok"===t&&i.onDisconnect_.remember(e,a),i.callOnCompleteCallback(r,t,n)})},e.prototype.onDisconnectUpdate=function(e,t,n){var r=this;if((0,d.isEmpty)(t))return(0,h.log)("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,a){"ok"===i&&(0,d.forEach)(t,function(t,n){var i=(0,o.nodeFromJSON)(n);r.onDisconnect_.remember(e.child(t),i)}),r.callOnCompleteCallback(n,i,a)})},e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new m.StatsListener(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var n=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);(0,d.forEach)(t,function(e,t){for(var r=e.length;r<n+2;r++)e+=" ";console.log(e+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),h.log.apply(void 0,[n].concat(e))},e.prototype.callOnCompleteCallback=function(e,t,n){e&&(0,h.exceptionGuard)(function(){if("ok"==t)e(null);else{var r=(t||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new b.Database(this))},enumerable:!0,configurable:!0}),e}();t.Repo=S},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}();t.CacheNode=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(36),s=n(75),c=function(){function e(e){this.route=e,this.shipModels3d=new Map}return e.prototype.addShipModelFor=function(e,t,n){if(!this.shipModels3d.has(t.name)){var r=new s.ShipModel3D(t,n);this.shipModels3d.set(t.name,r);r.load(e)}},e.prototype.removeShipModelFor=function(e){this.shipModels3d.get(e).removeShipFromScene(),this.shipModels3d.delete(e)},e.prototype.loadingProgress=function(){var e=100;if(0==this.shipModels3d.size)return e;var t=e/this.shipModels3d.size,n=0;return this.shipModels3d.forEach(function(r,i){r.isLoaded()?n++:e-=t}),n==this.shipModels3d.size?100:e},e=r([o.Injectable(),i("design:paramtypes",[a.ActivatedRoute])],e)}();t.SceneService=c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.stringLength=t.stringToByteArray=void 0;var r=n(5);t.stringToByteArray=function(e){for(var t=[],n=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);if(o>=55296&&o<=56319){var a=o-55296;i++,(0,r.assert)(i<e.length,"Surrogate pair missing trail surrogate.");o=65536+(a<<10)+(e.charCodeAt(i)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Reference=void 0;var r=n(749),i=n(750),o=n(7),a=n(751),s=n(268),c=n(134),l=n(16),u=n(777),h=n(69),d=n(68),p=n(77),f=n(280),v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(e){function t(t,n){if(!(t instanceof c.Repo))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,n,u.QueryParams.DEFAULT,!1)||this}return v(t,e),t.prototype.getKey=function(){return(0,d.validateArgCount)("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return(0,d.validateArgCount)("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof l.Path||(null===this.path.getFront()?(0,h.validateRootPathString)("Reference.child",1,e,!1):(0,h.validatePathString)("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){(0,d.validateArgCount)("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){(0,d.validateArgCount)("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){(0,d.validateArgCount)("Reference.set",1,2,arguments.length),(0,h.validateWritablePath)("Reference.set",this.path),(0,h.validateFirebaseDataArg)("Reference.set",1,e,this.path,!1),(0,d.validateCallback)("Reference.set",2,t,!0);var n=new p.Deferred;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},t.prototype.update=function(e,t){if((0,d.validateArgCount)("Reference.update",1,2,arguments.length),(0,h.validateWritablePath)("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,(0,o.warn)("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,h.validateFirebaseMergeDataArg)("Reference.update",1,e,this.path,!1),(0,d.validateCallback)("Reference.update",2,t,!0);var i=new p.Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,n){if((0,d.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),(0,h.validateWritablePath)("Reference.setWithPriority",this.path),(0,h.validateFirebaseDataArg)("Reference.setWithPriority",1,e,this.path,!1),(0,h.validatePriority)("Reference.setWithPriority",2,t,!1),(0,d.validateCallback)("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new p.Deferred;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},t.prototype.remove=function(e){return(0,d.validateArgCount)("Reference.remove",0,1,arguments.length),(0,h.validateWritablePath)("Reference.remove",this.path),(0,d.validateCallback)("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,n){if((0,d.validateArgCount)("Reference.transaction",1,3,arguments.length),(0,h.validateWritablePath)("Reference.transaction",this.path),(0,d.validateCallback)("Reference.transaction",1,e,!1),(0,d.validateCallback)("Reference.transaction",2,t,!0),(0,h.validateBoolean)("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new p.Deferred;"function"==typeof t&&(0,p.attachDummyErrorHandler)(r.promise);var o=function(e,n,o){e?r.reject(e):r.resolve(new i.TransactionResult(n,o)),"function"==typeof t&&t(e,n,o)};return this.repo.startTransaction(this.path,e,o,n),r.promise},t.prototype.setPriority=function(e,t){(0,d.validateArgCount)("Reference.setPriority",1,2,arguments.length),(0,h.validateWritablePath)("Reference.setPriority",this.path),(0,h.validatePriority)("Reference.setPriority",1,e,!1),(0,d.validateCallback)("Reference.setPriority",2,t,!0);var n=new p.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},t.prototype.push=function(e,t){(0,d.validateArgCount)("Reference.push",0,2,arguments.length),(0,h.validateWritablePath)("Reference.push",this.path),(0,h.validateFirebaseDataArg)("Reference.push",1,e,this.path,!0),(0,d.validateCallback)("Reference.push",2,t,!0);var n,r=this.repo.serverTime(),i=(0,a.nextPushId)(r),o=this.child(i),s=this.child(i);return n=null!=e?o.set(e,t).then(function(){return s}):p.PromiseImpl.resolve(s),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof t&&(0,p.attachDummyErrorHandler)(n),o},t.prototype.onDisconnect=function(){return(0,h.validateWritablePath)("Reference.onDisconnect",this.path),new r.OnDisconnect(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(s.Query);t.Reference=m,s.Query.__referenceConstructor=m,f.SyncPoint.__referenceConstructor=m},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}();t.SortedMapIterator=r;var i=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:a.EMPTY_NODE,this.right=null!=o?o:a.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r,i;return i=this,r=n(e,i.key),i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return a.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()},e.prototype.remove=function(e,t){var n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return a.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}();t.LLRBNode=i;var o=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new i(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}();t.LLRBEmptyNode=o;var a=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,i.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,i.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new r(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new r(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new r(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new r(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new o,e}();t.SortedMap=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ImmutableTree=void 0;var r,i=n(177),o=n(16),a=n(7),s=n(11),c=function(){return r||(r=new i.SortedMap(a.stringCompare)),r},l=function(){function e(e,t){void 0===t&&(t=c()),this.value=e,this.children=t}return e.fromObject=function(t){var n=e.Empty;return(0,s.forEach)(t,function(e,t){n=n.set(new o.Path(e),t)}),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:o.Path.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);if(null!=i){return{path:new o.Path(n).child(i.path),value:i.value}}return null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var n=t.getFront(),r=this.children.get(n);return null!==r?r.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,n){if(t.isEmpty())return new e(n,this.children);var r=t.getFront(),i=this.children.get(r)||e.Empty,o=i.set(t.popFront(),n),a=this.children.insert(r,o);return new e(this.value,a)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var n=t.getFront(),r=this.children.get(n);if(r){var i=r.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),n=this.children.get(t);return n?n.get(e.popFront()):null},e.prototype.setTree=function(t,n){if(t.isEmpty())return n;var r=t.getFront(),i=this.children.get(r)||e.Empty,o=i.setTree(t.popFront(),n),a=void 0;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new e(this.value,a)},e.prototype.fold=function(e){return this.fold_(o.Path.Empty,e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(e.child(r),t)}),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,o.Path.Empty,t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,o.Path.Empty,t)},e.prototype.foreachOnPath_=function(t,n,r){if(t.isEmpty())return this;this.value&&r(n,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),n.child(i),r):e.Empty},e.prototype.foreach=function(e){this.foreach_(o.Path.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(e.child(n),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})},e.Empty=new e(null),e}();t.ImmutableTree=l},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedFilter=void 0;var r=n(5),i=n(79),o=n(30),a=n(25),s=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,o,a,s){(0,r.assert)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var c=e.getImmediateChild(t);return c.getChild(o).equals(n.getChild(o))&&c.isEmpty()==n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(i.Change.childRemovedChange(t,c)):(0,r.assert)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?s.trackChildChange(i.Change.childAddedChange(t,n)):s.trackChildChange(i.Change.childChangedChange(t,n,c))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(a.PRIORITY_INDEX,function(e,r){t.hasChild(e)||n.trackChildChange(i.Change.childRemovedChange(e,r))}),t.isLeafNode()||t.forEachChild(a.PRIORITY_INDEX,function(t,r){if(e.hasChild(t)){var o=e.getImmediateChild(t);o.equals(r)||n.trackChildChange(i.Change.childChangedChange(t,r,o))}else n.trackChildChange(i.Change.childAddedChange(t,r))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?o.ChildrenNode.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}();t.IndexedFilter=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.StatsManager=void 0;var r=n(767),i=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new r.StatsCollection),this.collections_[t]},e.getOrCreateReporter=function(e,t){var n=e.toString();return this.reporters_[n]||(this.reporters_[n]=t()),this.reporters_[n]},e.collections_={},e.reporters_={},e}();t.StatsManager=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.RepoManager=void 0;var r=n(11),i=n(134),o=n(7),a=n(266),s=n(69);n(779);var c,l=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return c||(c=new e),c},e.prototype.interrupt=function(){for(var e in this.repos_)this.repos_[e].interrupt()},e.prototype.resume=function(){for(var e in this.repos_)this.repos_[e].resume()},e.prototype.databaseFromApp=function(e){var t=e.options.databaseURL;void 0===t&&(0,o.fatal)("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().");var n=(0,a.parseRepoInfo)(t),r=n.repoInfo;return(0,s.validateUrl)("Invalid Firebase Database URL",1,n),n.path.isEmpty()||(0,o.fatal)("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(r,e).database},e.prototype.deleteRepo=function(e){(0,r.safeGet)(this.repos_,e.app.name)!==e&&(0,o.fatal)("Database "+e.app.name+" has already been deleted."),e.interrupt(),delete this.repos_[e.app.name]},e.prototype.createRepo=function(e,t){var n=(0,r.safeGet)(this.repos_,t.name);return n&&(0,o.fatal)("FIREBASE INTERNAL ERROR: Database initialized multiple times."),n=new i.Repo(e,this.useRestClient_,t),this.repos_[t.name]=n,n},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}();t.RepoManager=l},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=function(){function e(){var e=this;this.baseX=200,this.baseY=200,this.stickX=200,this.stickY=200,this.stickRadius=25,this.container=document.body,this.strokeStyle="#80CADC",this.pressed=!1,this.touchIdx=null,this.visible=!1,this.added=!1,this.moveCallback=function(e,t){},this.onMouseUp=function(t){return e.onUp()},this.onMouseDown=function(t){t.preventDefault();var n=t.clientX,r=t.clientY;return e.onDown(n,r)},this.onMouseMove=function(t){var n=t.clientX,r=t.clientY;return e.onMove(n,r)},this.onTouchStart=function(t){var n=t.changedTouches[0];e.touchIdx=n.identifier;var r=n.pageX,i=n.pageY;e.onDown(r,i)&&t.preventDefault()},this.onTouchEnd=function(t){if(null!==e.touchIdx&&e.pressed){for(var n=t.changedTouches,r=0;r<n.length&&n[r].identifier!==e.touchIdx;r++);if(e.touchIdx=null,r!==n.length)return t.preventDefault(),e.onUp()}},this.onTouchMove=function(t){if(null!==e.touchIdx&&e.pressed){for(var n=t.changedTouches,r=0;r<n.length&&n[r].identifier!==e.touchIdx;r++);if(r!==n.length){var i=n[r];t.preventDefault();var o=i.pageX,a=i.pageY;return e.onMove(o,a)}}},this.baseEl=this.buildJoystickBase(),this.stickEl=this.buildJoystickStick(),this.baseEl.style.position="absolute",this.baseEl.style.zIndex="5",this.baseEl.style.display="none",this.stickEl.style.position="absolute",this.stickEl.style.zIndex="5",this.stickEl.style.display="none",this.hide()}return e.prototype.updateLocation=function(e,t){this.baseX=e-100,this.baseY=t-100,this.stickX=this.baseX,this.stickY=this.baseY,this.baseEl.style.left=this.baseX-this.baseEl.width/2+"px",this.baseEl.style.top=this.baseY-this.baseEl.height/2+"px"},e.prototype.update=function(){this.pressed&&this.moveCallback(this.deltaX(),this.deltaY())},e.prototype.show=function(){if(this.baseEl.style.display="",this.visible=!0,!this.added){this.added=!0;var e=document.getElementById("container");e.appendChild(this.baseEl),e.appendChild(this.stickEl)}this.container.addEventListener("touchstart",this.onTouchStart,!1),this.container.addEventListener("touchend",this.onTouchEnd,!1),this.container.addEventListener("touchmove",this.onTouchMove,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1),this.container.addEventListener("mouseup",this.onMouseUp,!1),this.container.addEventListener("mousemove",this.onMouseMove,!1)},e.prototype.hide=function(){this.baseEl.style.display="none",this.visible=!1,this.container.removeEventListener("touchstart",this.onTouchStart,!1),this.container.removeEventListener("touchend",this.onTouchEnd,!1),this.container.removeEventListener("touchmove",this.onTouchMove,!1),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("mouseup",this.onMouseUp,!1),this.container.removeEventListener("mousemove",this.onMouseMove,!1)},e.prototype.deltaX=function(){return this.stickX-this.baseX},e.prototype.deltaY=function(){return this.stickY-this.baseY},e.prototype.up=function(){if(!1===this.pressed)return!1;var e=this.deltaX(),t=this.deltaY();return!(t>=0)&&!(Math.abs(e)>2*Math.abs(t))},e.prototype.down=function(){if(!1===this.pressed)return!1;var e=this.deltaX(),t=this.deltaY();return!(t<=0)&&!(Math.abs(e)>2*Math.abs(t))},e.prototype.right=function(){if(!1===this.pressed)return!1;var e=this.deltaX(),t=this.deltaY();return!(e<=0)&&!(Math.abs(t)>2*Math.abs(e))},e.prototype.left=function(){if(!1===this.pressed)return!1;var e=this.deltaX(),t=this.deltaY();return!(e>=0)&&!(Math.abs(t)>2*Math.abs(e))},e.prototype.onUp=function(){this.pressed=!1,this.stickEl.style.display="none"},e.prototype.onDown=function(e,t){var n=this.baseX-this.baseEl.width/2,r=this.baseY-this.baseEl.height/2;if(this.visible&&e>n&&e<n+this.baseEl.width&&t>r&&t<r+this.baseEl.height){this.pressed=!0,this.stickX=e,this.stickY=t;var i=this.deltaX(),o=this.deltaY(),a=Math.sqrt(i*i+o*o);if(a>this.stickRadius){var s=i/a,c=o/a;this.stickX=s*this.stickRadius+this.baseX,this.stickY=c*this.stickRadius+this.baseY}return this.stickEl.style.display="",this.move(this.stickEl.style,this.stickX-this.stickEl.width/2,this.stickY-this.stickEl.height/2),!0}return!1},e.prototype.onMove=function(e,t){if(!0===this.pressed){this.stickX=e,this.stickY=t;var n=this.deltaX(),r=this.deltaY(),i=Math.sqrt(n*n+r*r);if(i>this.stickRadius){var o=n/i,a=r/i;this.stickX=o*this.stickRadius+this.baseX,this.stickY=a*this.stickRadius+this.baseY}this.move(this.stickEl.style,this.stickX-this.stickEl.width/2,this.stickY-this.stickEl.height/2)}},e.prototype.buildJoystickBase=function(){var e=document.createElement("canvas");e.width=126,e.height=126;var t=e.getContext("2d");return t.beginPath(),t.strokeStyle=this.strokeStyle,t.lineWidth=6,t.arc(e.width/2,e.width/2,40,0,2*Math.PI,!0),t.stroke(),t.beginPath(),t.strokeStyle=this.strokeStyle,t.lineWidth=2,t.arc(e.width/2,e.width/2,60,0,2*Math.PI,!0),t.stroke(),e},e.prototype.buildJoystickStick=function(){var e=document.createElement("canvas");e.width=86,e.height=86;var t=e.getContext("2d");return t.beginPath(),t.strokeStyle=this.strokeStyle,t.lineWidth=6,t.arc(e.width/2,e.width/2,40,0,2*Math.PI,!0),t.stroke(),e},e.prototype.move=function(e,t,n){e.left=t+"px",e.top=n+"px"},e.prototype.destroy=function(){this.container.removeChild(this.baseEl),this.container.removeChild(this.stickEl),this.container.removeEventListener("touchstart",this.onTouchStart,!1),this.container.removeEventListener("touchend",this.onTouchEnd,!1),this.container.removeEventListener("touchmove",this.onTouchMove,!1),this.container.removeEventListener("mouseup",this.onMouseUp,!1),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("mousemove",this.onMouseMove,!1)},e.prototype.touchScreenAvailable=function(){return"createTouch"in document},e=r([o.Injectable(),i("design:paramtypes",[])],e)}();t.Joystick=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(738);n.d(t,"AngularFireDatabase",function(){return r.a}),n.d(t,"FirebaseListFactory",function(){return r.e}),n.d(t,"onChildAdded",function(){return r.p}),n.d(t,"onChildChanged",function(){return r.q}),n.d(t,"onChildRemoved",function(){return r.r}),n.d(t,"onChildUpdated",function(){return r.s}),n.d(t,"FirebaseListObservable",function(){return r.f}),n.d(t,"FirebaseObjectFactory",function(){return r.g}),n.d(t,"FirebaseObjectObservable",function(){return r.h}),n.d(t,"observeQuery",function(){return r.o}),n.d(t,"getOrderObservables",function(){return r.m}),n.d(t,"getLimitToObservables",function(){return r.l}),n.d(t,"getStartAtObservable",function(){return r.n}),n.d(t,"getEndAtObservable",function(){return r.j}),n.d(t,"getEqualToObservable",function(){return r.k}),n.d(t,"_getAngularFireDatabase",function(){return r.i}),n.d(t,"AngularFireDatabaseProvider",function(){return r.c}),n.d(t,"DATABASE_PROVIDERS",function(){return r.d}),n.d(t,"AngularFireDatabaseModule",function(){return r.b})},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(76),i=(n.n(r),n(9)),o=n(102),a=n(291),s=n(294),c=n(103),l=function(){function e(e){this.app=e,this.database=e.database()}return e.prototype.list=function(e,t){var n=c.a(this.app,e);return Object(a.a)(n,t)},e.prototype.object=function(e,t){var n=c.a(this.app,e);return Object(s.a)(n,t)},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:o.FirebaseApp}]},e}()},function(e,t,n){"use strict";(function(e){/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var n;if(void 0!==e)n=e;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}t.globalScope=n}).call(t,n(88))},function(e,t,n){"use strict";function r(e){return i(void 0,e)}function i(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&(e[r]=i(e[r],t[r]));return e}function o(e,t,n){e[t]=n}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.deepCopy=r,t.deepExtend=i,t.patchProperty=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.DatabaseInternals=t.Database=void 0;var r=n(7),i=n(266),o=n(16),a=n(77),s=n(176),c=n(134),l=n(181),u=n(68),h=n(69),d=function(){function e(e){this.repo_=e,e instanceof c.Repo||(0,r.fatal)("Don't call new Database() directly - please use firebase.database()."),this.root_=new s.Reference(e,o.Path.Empty),this.INTERNAL=new p(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),(0,u.validateArgCount)("database.ref",0,1,arguments.length),void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),(0,u.validateArgCount)(t,1,1,arguments.length);var n=(0,i.parseRepoInfo)(e);(0,h.validateUrl)(t,1,n);var o=n.repoInfo;return o.host!==this.repo_.repoInfo_.host&&(0,r.fatal)(t+": Host name does not match the current database: (found "+o.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&(0,r.fatal)("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){(0,u.validateArgCount)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){(0,u.validateArgCount)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}();t.Database=d;var p=function(){function e(e){this.database=e}return e.prototype.delete=function(){return this.database.checkDeleted_("delete"),l.RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,a.PromiseImpl.resolve()},e}();t.DatabaseInternals=p},function(e,t,n){"use strict";function r(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.parseURL=t.parseRepoInfo=void 0;var i=n(16),o=n(267),a=n(7),s=(t.parseRepoInfo=function(e){var t=s(e),n=t.subdomain;"firebase"===t.domain&&(0,a.fatal)(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||(0,a.fatal)("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||(0,a.warnIfPageIsSecure)();var r="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new o.RepoInfo(t.host,t.secure,n,r),path:new i.Path(t.pathString)}},t.parseURL=function(e){var t="",n="",i="",o="",a=!0,s="https",c=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(s=e.substring(0,l-1),e=e.substring(l+2));var u=e.indexOf("/");-1===u&&(u=e.length),t=e.substring(0,u),o=r(e.substring(u));var h=t.split(".");3===h.length?(n=h[1],i=h[0].toLowerCase()):2===h.length&&(n=h[0]),l=t.indexOf(":"),l>=0&&(a="https"===s||"wss"===s,c=parseInt(t.substring(l+1),10))}return{host:t,port:c,domain:n,subdomain:i,secure:a,scheme:s,pathString:o}})},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.RepoInfo=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(5),o=n(11),a=n(130),s=n(131),c=function(){function e(e,t,n,r,i){void 0===i&&(i=""),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=a.PersistentStorage.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&a.PersistentStorage.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){(0,i.assert)("string"==typeof e,"typeof type must == string"),(0,i.assert)("object"===(void 0===t?"undefined":r(t)),"typeof params must == object");var n;if(e===s.WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==s.LONG_POLLING)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var a=[];return(0,o.forEach)(t,function(e,t){a.push(e+"="+t)}),n+a.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();t.RepoInfo=c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Query=void 0;var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(5),a=n(100),s=n(25),c=n(270),l=n(274),u=n(7),h=n(16),d=n(69),p=n(68),f=n(752),v=n(77),m=function(){function e(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return(0,o.assert)(r,"Reference.ts has not been loaded"),r},set:function(e){r=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===a.KEY_INDEX){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",h="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=u.MIN_NAME)throw new Error(r);if("string"!=typeof t)throw new Error(h)}if(e.hasEnd()){if(e.getIndexEndName()!=u.MAX_NAME)throw new Error(r);if("string"!=typeof n)throw new Error(h)}}else if(e.getIndex()===s.PRIORITY_INDEX){if(null!=t&&!(0,d.isValidPriority)(t)||null!=n&&!(0,d.isValidPriority)(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.assert)(e.getIndex()instanceof l.PathIndex||e.getIndex()===c.VALUE_INDEX,"unknown index type."),null!=t&&"object"===(void 0===t?"undefined":i(t))||null!=n&&"object"===(void 0===n?"undefined":i(n)))throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return(0,p.validateArgCount)("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,n,r,i){(0,p.validateArgCount)("Query.on",2,4,arguments.length),(0,d.validateEventType)("Query.on",1,t,!1),(0,p.validateCallback)("Query.on",2,n,!1);var o=e.getCancelAndContextArgs_("Query.on",r,i);if("value"===t)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[t]=n,this.onChildEvent(a,o.cancel,o.context)}return n},e.prototype.onValueEvent=function(e,t,n){var r=new f.ValueEventRegistration(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)},e.prototype.onChildEvent=function(e,t,n){var r=new f.ChildEventRegistration(e,t,n);this.repo.addEventCallbackForQuery(this,r)},e.prototype.off=function(e,t,n){(0,p.validateArgCount)("Query.off",0,3,arguments.length),(0,d.validateEventType)("Query.off",1,e,!0),(0,p.validateCallback)("Query.off",2,t,!0),(0,p.validateContextObject)("Query.off",3,n,!0);var r=null,i=null;if("value"===e){var o=t||null;r=new f.ValueEventRegistration(o,null,n||null)}else e&&(t&&(i={},i[e]=t),r=new f.ChildEventRegistration(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},e.prototype.once=function(t,n,r,i){var o=this;(0,p.validateArgCount)("Query.once",1,4,arguments.length),(0,d.validateEventType)("Query.once",1,t,!1),(0,p.validateCallback)("Query.once",2,n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,i),s=!0,c=new v.Deferred;(0,v.attachDummyErrorHandler)(c.promise);var l=function e(r){s&&(s=!1,o.off(t,e),n&&n.bind(a.context)(r),c.resolve(r))};return this.on(t,l,function(e){o.off(t,l),a.cancel&&a.cancel.bind(a.context)(e),c.reject(e)}),c.promise},e.prototype.limitToFirst=function(t){if((0,p.validateArgCount)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if((0,p.validateArgCount)("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if((0,p.validateArgCount)("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');(0,d.validatePathString)("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new h.Path(t);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new l.PathIndex(n),i=this.queryParams_.orderBy(r);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){(0,p.validateArgCount)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(a.KEY_INDEX);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){(0,p.validateArgCount)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(s.PRIORITY_INDEX);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){(0,p.validateArgCount)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(c.VALUE_INDEX);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,n){void 0===t&&(t=null),(0,p.validateArgCount)("Query.startAt",0,2,arguments.length),(0,d.validateFirebaseDataArg)("Query.startAt",1,t,this.path,!0),(0,d.validateKey)("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,n=null),new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.endAt=function(t,n){void 0===t&&(t=null),(0,p.validateArgCount)("Query.endAt",0,2,arguments.length),(0,d.validateFirebaseDataArg)("Query.endAt",1,t,this.path,!0),(0,d.validateKey)("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if((0,p.validateArgCount)("Query.equalTo",1,2,arguments.length),(0,d.validateFirebaseDataArg)("Query.equalTo",1,e,this.path,!1),(0,d.validateKey)("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return(0,p.validateArgCount)("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return(0,p.validateArgCount)("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=(0,u.ObjectToUniqueKey)(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if((0,p.validateArgCount)("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var n=this.repo===t.repo,r=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return n&&r&&i},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,(0,p.validateCallback)(e,3,r.cancel,!0),r.context=n,(0,p.validateContextObject)(e,4,r.context,!0);else if(t)if("object"===(void 0===t?"undefined":i(t))&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error((0,p.errorPrefix)(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}();t.Query=m},function(e,t,n){"use strict";function r(e){o=e}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.validatePriorityNode=t.priorityHashText=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.setMaxNode=r;var o,a=n(5),s=n(7),c=n(11);t.priorityHashText=function(e){return"number"==typeof e?"number:"+(0,s.doubleToIEEE754String)(e):"string:"+e},t.validatePriorityNode=function(e){if(e.isLeafNode()){var t=e.val();(0,a.assert)("string"==typeof t||"number"==typeof t||"object"===(void 0===t?"undefined":i(t))&&(0,c.contains)(t,".sv"),"Priority must be a string or number.")}else(0,a.assert)(e===o||e.isEmpty(),"priority of unexpected type.");(0,a.assert)(e===o||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.VALUE_INDEX=t.ValueIndex=void 0;var r=n(132),i=n(33),o=n(7),a=n(101),s=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?(0,o.nameCompare)(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return i.NamedNode.MIN},t.prototype.maxPost=function(){return i.NamedNode.MAX},t.prototype.makePost=function(e,t){var n=(0,a.nodeFromJSON)(e);return new i.NamedNode(t,n)},t.prototype.toString=function(){return".value"},t}(r.Index);t.ValueIndex=c;t.VALUE_INDEX=new c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.IndexMap=void 0;var r,i=n(5),o=n(272),a=n(11),s=n(33),c=n(25),l=n(100),u={},h=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return(0,i.assert)(u&&c.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),r=r||new e({".priority":u},{".priority":c.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=(0,a.safeGet)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t===u?null:t},e.prototype.hasIndex=function(e){return(0,a.contains)(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){(0,i.assert)(t!==l.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],c=!1,h=n.getIterator(s.NamedNode.Wrap),d=h.getNext();d;)c=c||t.isDefinedOn(d.node),r.push(d),d=h.getNext();var p;p=c?(0,o.buildChildSet)(r,t.getCompare()):u;var f=t.toString(),v=(0,a.clone)(this.indexSet_);v[f]=t;var m=(0,a.clone)(this.indexes_);return m[f]=p,new e(m,v)},e.prototype.addToIndexes=function(t,n){var r=this;return new e((0,a.map)(this.indexes_,function(e,c){var l=(0,a.safeGet)(r.indexSet_,c);if((0,i.assert)(l,"Missing index implementation for "+c),e===u){if(l.isDefinedOn(t.node)){for(var h=[],d=n.getIterator(s.NamedNode.Wrap),p=d.getNext();p;)p.name!=t.name&&h.push(p),p=d.getNext();return h.push(t),(0,o.buildChildSet)(h,l.getCompare())}return u}var f=n.get(t.name),v=e;return f&&(v=v.remove(new s.NamedNode(t.name,f))),v.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e((0,a.map)(this.indexes_,function(e){if(e===u)return e;var r=n.get(t.name);return r?e.remove(new s.NamedNode(t.name,r)):e}),this.indexSet_)},e}();t.IndexMap=h},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.buildChildSet=void 0;var r=n(177),i=Math.log(2),o=function(){function e(e){this.count=function(e){return parseInt(Math.log(e)/i,10)}(e+1),this.current_=this.count-1;var t=function(e){return parseInt(Array(e+1).join("1"),2)}(this.count);this.bits_=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}();t.buildChildSet=function(e,t,n,i){e.sort(t);var a=function t(i,o){var a,s,c=o-i;if(0==c)return null;if(1==c)return a=e[i],s=n?n(a):a,new r.LLRBNode(s,a.node,r.LLRBNode.BLACK,null,null);var l=parseInt(c/2,10)+i,u=t(i,l),h=t(l+1,o);return a=e[l],s=n?n(a):a,new r.LLRBNode(s,a.node,r.LLRBNode.BLACK,u,h)},s=new o(e.length),c=function(t){for(var i=null,o=null,s=e.length,c=function(t,i){var o=s-t,c=s;s-=t;var u=a(o+1,c),h=e[o],d=n?n(h):h;l(new r.LLRBNode(d,h.node,i,null,u))},l=function(e){i?(i.left=e,i=e):(o=e,i=e)},u=0;u<t.count;++u){var h=t.nextBitIsOne(),d=Math.pow(2,t.count-(u+1));h?c(d,r.LLRBNode.BLACK):(c(d,r.LLRBNode.BLACK),c(d,r.LLRBNode.RED))}return o}(s);return new r.SortedMap(i||t,c)}},function(e,t,n){"use strict";function r(e,t){return(0,o.nameCompare)(e.name,t.name)}function i(e,t){return(0,o.nameCompare)(e,t)}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.NAME_ONLY_COMPARATOR=r,t.NAME_COMPARATOR=i;var o=n(7)},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.PathIndex=void 0;var r=n(5),i=n(7),o=n(132),a=n(30),s=n(33),c=n(101),l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,(0,r.assert)(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return l(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),o=n.compareTo(r);return 0===o?(0,i.nameCompare)(e.name,t.name):o},t.prototype.makePost=function(e,t){var n=(0,c.nodeFromJSON)(e),r=a.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,n);return new s.NamedNode(t,r)},t.prototype.maxPost=function(){var e=a.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,a.MAX_NODE);return new s.NamedNode(i.MAX_NAME,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(o.Index);t.PathIndex=u},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.DataSnapshot=void 0;var r=n(68),i=n(69),o=n(16),a=n(25),s=function(){function e(e,t,n){this.node_=e,this.ref_=t,this.index_=n}return e.prototype.val=function(){return(0,r.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return(0,r.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return(0,r.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return(0,r.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){(0,r.validateArgCount)("DataSnapshot.child",0,1,arguments.length),t=String(t),(0,i.validatePathString)("DataSnapshot.child",1,t,!1);var n=new o.Path(t),s=this.ref_.child(n);return new e(this.node_.getChild(n),s,a.PRIORITY_INDEX)},e.prototype.hasChild=function(e){(0,r.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),(0,i.validatePathString)("DataSnapshot.hasChild",1,e,!1);var t=new o.Path(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return(0,r.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var n=this;return(0,r.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),(0,r.validateCallback)("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return t(new e(i,n.ref_.child(r),a.PRIORITY_INDEX))})},e.prototype.hasChildren=function(){return(0,r.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return(0,r.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return(0,r.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}();t.DataSnapshot=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.resolveDeferredValueSnapshot=t.resolveDeferredValueTree=t.resolveDeferredValue=t.generateWithValues=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(5),o=n(16),a=n(277),s=n(133),c=n(101),l=n(25),u=(t.generateWithValues=function(e){return e=e||{},e.timestamp=e.timestamp||(new Date).getTime(),e},t.resolveDeferredValue=function(e,t){return e&&"object"===(void 0===e?"undefined":r(e))?((0,i.assert)(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e}),h=(t.resolveDeferredValueTree=function(e,t){var n=new a.SparseSnapshotTree;return e.forEachTree(new o.Path(""),function(e,r){n.remember(e,h(r,t))}),n},t.resolveDeferredValueSnapshot=function e(t,n){var r,i=t.getPriority().val(),o=u(i,n);if(t.isLeafNode()){var a=t,h=u(a.getValue(),n);return h!==a.getValue()||o!==a.getPriority().val()?new s.LeafNode(h,(0,c.nodeFromJSON)(o)):t}var d=t;return r=d,o!==d.getPriority().val()&&(r=r.updatePriority(new s.LeafNode(o))),d.forEachChild(l.PRIORITY_INDEX,function(t,i){var o=e(i,n);o!==i&&(r=r.updateImmediateChild(t,o))}),r})},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.SparseSnapshotTree=void 0;var r=n(16),i=n(25),o=n(278),a=function(){function e(){this.value_=null,this.children_=null}return e.prototype.find=function(e){if(null!=this.value_)return this.value_.getChild(e);if(e.isEmpty()||null==this.children_)return null;var t=e.getFront();if(e=e.popFront(),this.children_.contains(t)){return this.children_.get(t).find(e)}return null},e.prototype.remember=function(t,n){if(t.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(t,n);else{null==this.children_&&(this.children_=new o.CountedSet);var r=t.getFront();this.children_.contains(r)||this.children_.add(r,new e);var i=this.children_.get(r);t=t.popFront(),i.remember(t,n)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var t=this.value_;this.value_=null;var n=this;return t.forEachChild(i.PRIORITY_INDEX,function(e,t){n.remember(new r.Path(e),t)}),this.forget(e)}if(null!==this.children_){var o=e.getFront();if(e=e.popFront(),this.children_.contains(o)){this.children_.get(o).forget(e)&&this.children_.remove(o)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},e.prototype.forEachTree=function(e,t){null!==this.value_?t(e,this.value_):this.forEachChild(function(n,i){var o=new r.Path(e.toString()+"/"+n);i.forEachTree(o,t)})},e.prototype.forEachChild=function(e){null!==this.children_&&this.children_.each(function(t,n){e(t,n)})},e}();t.SparseSnapshotTree=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.CountedSet=void 0;var r=n(11),i=function(){function e(){this.set={}}return e.prototype.add=function(e,t){this.set[e]=null===t||t},e.prototype.contains=function(e){return(0,r.contains)(this.set,e)},e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0},e.prototype.remove=function(e){delete this.set[e]},e.prototype.clear=function(){this.set={}},e.prototype.isEmpty=function(){return(0,r.isEmpty)(this.set)},e.prototype.count=function(){return(0,r.getCount)(this.set)},e.prototype.each=function(e){(0,r.forEach)(this.set,function(t,n){return e(t,n)})},e.prototype.keys=function(){var e=[];return(0,r.forEach)(this.set,function(t){e.push(t)}),e},e}();t.CountedSet=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Overwrite=void 0;var r=n(70),i=n(16),o=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=r.OperationType.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,i.Path.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}();t.Overwrite=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.SyncPoint=void 0;var r,i=n(135),o=n(30),a=n(5),s=n(11),c=n(281),l=n(758),u=function(){function e(){this.views_={}}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return(0,a.assert)(r,"Reference.ts has not been loaded"),r},set:function(e){(0,a.assert)(!r,"__referenceConstructor has already been defined"),r=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return(0,s.isEmpty)(this.views_)},e.prototype.applyOperation=function(e,t,n){var r=e.source.queryId;if(null!==r){var i=(0,s.safeGet)(this.views_,r);return(0,a.assert)(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(e,t,n)}var o=[];return(0,s.forEach)(this.views_,function(r,i){o=o.concat(i.applyOperation(e,t,n))}),o},e.prototype.addEventRegistration=function(e,t,n,r,a){var u=e.queryIdentifier(),h=(0,s.safeGet)(this.views_,u);if(!h){var d=n.calcCompleteEventCache(a?r:null),p=!1;d?p=!0:r instanceof o.ChildrenNode?(d=n.calcCompleteEventChildren(r),p=!1):(d=o.ChildrenNode.EMPTY_NODE,p=!1);var f=new c.ViewCache(new i.CacheNode(d,p,!1),new i.CacheNode(r,a,!1));h=new l.View(e,f),this.views_[u]=h}return h.addEventRegistration(t),h.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,n,r){var i=t.queryIdentifier(),o=[],a=[],c=this.hasCompleteView();if("default"===i){var l=this;(0,s.forEach)(this.views_,function(e,t){a=a.concat(t.removeEventRegistration(n,r)),t.isEmpty()&&(delete l.views_[e],t.getQuery().getQueryParams().loadsAllData()||o.push(t.getQuery()))})}else{var u=(0,s.safeGet)(this.views_,i);u&&(a=a.concat(u.removeEventRegistration(n,r)),u.isEmpty()&&(delete this.views_[i],u.getQuery().getQueryParams().loadsAllData()||o.push(u.getQuery())))}return c&&!this.hasCompleteView()&&o.push(new e.__referenceConstructor(t.repo,t.path)),{removed:o,events:a}},e.prototype.getQueryViews=function(){var e=this;return Object.keys(this.views_).map(function(t){return e.views_[t]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},e.prototype.getCompleteServerCache=function(e){var t=null;return(0,s.forEach)(this.views_,function(n,r){t=t||r.getCompleteServerCache(e)}),t},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return(0,s.safeGet)(this.views_,t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){return(0,s.findValue)(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},e}();t.SyncPoint=u},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ViewCache=void 0;var r=n(30),i=n(135),o=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,n,r){return new e(new i.CacheNode(t,n,r),this.serverCache_)},e.prototype.updateServerSnap=function(t,n,r){return new e(this.eventCache_,new i.CacheNode(t,n,r))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1),new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1)),e}();t.ViewCache=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.StatsListener=void 0;var r=n(11),i=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=(0,r.clone)(e);return this.last_&&(0,r.forEach)(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t},e}();t.StatsListener=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.PersistentConnection=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(128),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(11),s=n(42),c=n(5),l=n(7),u=n(16),h=n(770),d=n(771),p=n(772),f=n(285),v=n(129),m=n(78),y=n(288),g=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=1e3,b=3e5,S=function(e){function t(n,r,i,o,a,s){var c=e.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=o,c.authTokenProvider_=a,c.authOverride_=s,c.id=t.nextPersistentConnectionId_++,c.log_=(0,l.logWrapper)("p:"+c.id+":"),c.interruptReasons_={},c.listens_={},c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=_,c.maxReconnectDelay_=b,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,s&&!(0,m.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),h.VisibilityMonitor.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&d.OnlineMonitor.getInstance().on("online",c.onOnline_,c),c}return g(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_((0,s.stringify)(i)),(0,c.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},(0,c.assert)(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),(0,c.assert)(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r.queryObject(),a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,c=a.s;t.warnOnListenWarnings_(s,r),(n.listens_[i]&&n.listens_[i][o])===e&&(n.log_("listen response",a),"ok"!==c&&n.removeListen_(i,o),e.onComplete&&e.onComplete(c,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"===(void 0===e?"undefined":r(e))&&(0,a.contains)(e,"w")){var n=(0,a.safeGet)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var i='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',o=t.path.toString();(0,l.warn)("Using an unspecified index. Consider adding "+i+" at "+o+" to your security rules for better performance")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||(0,p.isAdmin)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=(0,p.isValidFormat)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"===r(this.authOverride_)&&(i.authvar=this.authOverride_),this.sendRequest(n,i,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},t.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),(0,c.assert)(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+(0,s.stringify)(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):(0,l.error)("Unrecognized action received from server: "+(0,s.stringify)(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;(0,c.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=_,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=_,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var e=(new Date).getTime()-this.lastConnectionEstablishedTime_;e>3e4&&(this.reconnectDelay_=_),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,u=null,h=function(){u?u.close():(s=!0,r())},d=function(e){(0,c.assert)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)};this.realtime_={close:h,sendRequest:d};var p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(p).then(function(t){s?(0,l.log)("getToken() completed but was canceled"):((0,l.log)("getToken() completed. Creating connection."),o.authToken_=t&&t.accessToken,u=new f.Connection(i,o.repoInfo_,e,n,r,function(e){(0,l.warn)(e+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(e){o.log_("Failed to get token: "+e),s||(v.CONSTANTS.NODE_ADMIN&&(0,l.warn)(e),h())})}},t.prototype.interrupt=function(e){(0,l.log)("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){(0,l.log)("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,a.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=_,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return(0,l.ObjectToUniqueKey)(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new u.Path(e).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][t],delete this.listens_[r][t],0===(0,a.getCount)(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},t.prototype.onAuthRevoked_=function(e,t){(0,l.log)("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||++this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken())},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&"undefined"!=typeof console&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e=this;this.tryAuth(),(0,a.forEach)(this.listens_,function(t,n){(0,a.forEach)(n,function(t,n){e.sendListen_(n)})});for(var t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";v.CONSTANTS.NODE_ADMIN?t="admin_node":v.CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+o.default.SDK_VERSION.replace(/\./g,"-")]=1,(0,m.isMobileCordova)()?e["framework.cordova"]=1:(0,m.isReactNative)()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=d.OnlineMonitor.getInstance().currentlyOnline();return(0,a.isEmpty)(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(y.ServerActions);t.PersistentConnection=S},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var r=n(5),i=function(){function e(e){this.allowedEvents_=e,this.listeners_={},(0,r.assert)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=this.listeners_[e].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){(0,r.assert)(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}();t.EventEmitter=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var r=n(7),i=n(130),o=n(131),a=n(773),s=function(){function e(e,t,n,i,o,s,c){this.id=e,this.repoInfo_=t,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=(0,r.logWrapper)("c:"+this.id+":"),this.transportManager_=new a.TransportManager(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,i)},Math.floor(0));var o=t.healthyTimeout||0;o>0&&(this.healthyTimeout_=(0,r.setTimeoutNonBlocking)(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(o)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!=t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=(0,r.requireKey)("t",e),n=(0,r.requireKey)("d",e);if("c"==t)this.onSecondaryControl_(n);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=(0,r.requireKey)("t",e),n=(0,r.requireKey)("d",e);"c"==t?this.onControl_(n):"d"==t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||--this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy())},e.prototype.onControl_=function(e){var t=(0,r.requireKey)("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?(0,r.error)("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):(0,r.error)("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(i),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),o.PROTOCOL_VERSION!==n&&(0,r.warn)("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),(0,r.setTimeoutNonBlocking)(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):(0,r.setTimeoutNonBlocking)(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(i.PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}();t.Connection=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseIFrameScriptHolder=t.BrowserPollConnection=t.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM=t.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM=t.FIREBASE_LONGPOLL_DATA_PARAM=t.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET=t.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM=t.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM=t.FIREBASE_LONGPOLL_SERIAL_PARAM=t.FIREBASE_LONGPOLL_PW_PARAM=t.FIREBASE_LONGPOLL_ID_PARAM=t.FIREBASE_LONGPOLL_DATA_CB_NAME=t.FIREBASE_LONGPOLL_COMMAND_CB_NAME=t.FIREBASE_LONGPOLL_CLOSE_COMMAND=t.FIREBASE_LONGPOLL_START_PARAM=void 0;var r=n(7),i=n(278),o=n(180),a=n(774),s=n(131),c=n(42),l=n(78),u=t.FIREBASE_LONGPOLL_START_PARAM="start",h=t.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",d=t.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",p=t.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",f=t.FIREBASE_LONGPOLL_ID_PARAM="id",v=t.FIREBASE_LONGPOLL_PW_PARAM="pw",m=t.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",y=t.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",g=t.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",_=t.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",b=t.FIREBASE_LONGPOLL_DATA_PARAM="d",S=t.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",w=t.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",E=function(){function e(e,t,n,i){this.connId=e,this.repoInfo=t,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=(0,r.logWrapper)(e),this.stats_=o.StatsManager.getCollection(t),this.urlFn=function(e){return t.connectionURL(s.LONG_POLLING,e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new a.PacketReceiver(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),(0,r.executeWhenDOMReady)(function(){if(!n.isClosed_){n.scriptTagHolder=new C(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=e[1],o=e[2];e[3],e[4];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r==u)n.id=i,n.password=o;else{if(r!==h)throw new Error("Unrecognized command received: "+r);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=e[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(r,i)},function(){n.onClosed_()},n.urlFn);var e={};e[u]="t",e[m]=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e[y]=n.scriptTagHolder.uniqueCallbackIdentifier),e[s.VERSION_PARAM]=s.PROTOCOL_VERSION,n.transportSessionId&&(e[s.TRANSPORT_SESSION_PARAM]=n.transportSessionId),n.lastSessionId&&(e[s.LAST_SESSION_PARAM]=n.lastSessionId),!(0,l.isNodeSdk)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(e[s.REFERER_PARAM]=s.FORGE_REF);var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!(0,r.isChromeExtensionContentScript)()&&!(0,r.isWindowsStoreApp)()&&!(0,l.isNodeSdk)()},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=(0,c.stringify)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=(0,r.base64Encode)(t),i=(0,r.splitStringBySize)(n,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!(0,l.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={};n[w]="t",n[f]=e,n[v]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=(0,c.stringify)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}();t.BrowserPollConnection=E;var C=function(){function e(t,n,o,a){if(this.onDisconnect=o,this.urlFn=a,this.outstandingRequests=new i.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,l.isNodeSdk)())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=(0,r.LUIDGenerator)(),window[d+this.uniqueCallbackIdentifier]=t,window[p+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var s="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){s='<script>document.domain="'+document.domain+'";<\/script>'}var c="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(e){(0,r.log)("frame writing exception"),e.stack&&(0,r.log)(e.stack),(0,r.log)(e)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||(0,r.log)("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var t=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0))),(0,l.isNodeSdk)()&&this.myID){var n={};n[S]="t",n[f]=this.myID,n[v]=this.myPW;var r=this.urlFn(n);e.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e[f]=this.myID,e[v]=this.myPW,e[m]=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&"+g+r+"="+i.seg+"&"+_+r+"="+i.ts+"&"+b+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t,1);var r=function(){n.outstandingRequests.remove(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3)),o=function(){clearTimeout(i),r()};this.addTag(e,o)},e.prototype.addTag=function(e,t){var n=this;(0,l.isNodeSdk)()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){var e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=function(){(0,r.log)("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(e){}},Math.floor(1))},e}();t.FirebaseIFrameScriptHolder=C},function(e,t,n){"use strict";(function(e){function r(e){f=e}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketConnection=void 0,t.setWebSocketImpl=r;var i=n(128),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(5),s=n(7),c=n(180),l=n(131),u=n(129),h=n(130),d=n(42),p=n(78),f=null;"undefined"!=typeof MozWebSocket?f=MozWebSocket:"undefined"!=typeof WebSocket&&(f=WebSocket);var v=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=(0,s.logWrapper)(this.connId),this.stats_=c.StatsManager.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(e,t,n){var r={};return r[l.VERSION_PARAM]=l.PROTOCOL_VERSION,!(0,p.isNodeSdk)()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(l.FORGE_DOMAIN)&&(r[l.REFERER_PARAM]=l.FORGE_REF),t&&(r[l.TRANSPORT_SESSION_PARAM]=t),n&&(r[l.LAST_SESSION_PARAM]=n),e.connectionURL(l.WEBSOCKET,r)},t.prototype.open=function(t,n){var r=this;this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,h.PersistentStorage.set("previous_websocket_failure",!0);try{if((0,p.isNodeSdk)()){var i=u.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/"+l.PROTOCOL_VERSION+"/"+o.default.SDK_VERSION+"/"+e.platform+"/"+i}},s=Object({ENV:"production"}),c=0==this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;c&&(a.proxy={origin:c}),this.mySock=new f(this.connURL,[],a)}else this.mySock=new f(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var d=e.message||e.data;return d&&this.log_(d),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==f&&!t.forceDisallow_},t.previouslyFailed=function(){return h.PersistentStorage.isInMemoryStorage||!0===h.PersistentStorage.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){h.PersistentStorage.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var n=(0,d.jsonEval)(t);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},t.prototype.extractFrameCount_=function(e){if((0,a.assert)(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},t.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(e){this.resetKeepAlive();var t=(0,d.stringify)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=(0,s.splitStringBySize)(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}();t.WebSocketConnection=v}).call(t,n(252))},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}();t.ServerActions=r},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.RangedFilter=void 0;var r=n(179),i=n(25),o=n(33),a=n(30),s=function(){function e(t){this.indexedFilter_=new r.IndexedFilter(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,s){return this.matches(new o.NamedNode(t,n))||(n=a.ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=a.ChildrenNode.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(a.ChildrenNode.EMPTY_NODE);var s=this;return t.forEachChild(i.PRIORITY_INDEX,function(e,t){s.matches(new o.NamedNode(e,t))||(r=r.updateImmediateChild(e,a.ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}();t.RangedFilter=s},function(e,t,n){"use strict";function r(e,t){try{return t?o.initializeApp(e,t):o.initializeApp(e)}catch(e){return"app/duplicate-app"===e.code?o.app(e.name):o.app(null)}}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),t.c=r;var i=n(9),o=n(128),a=(n.n(o),new i.InjectionToken("FirebaseAppConfigToken")),s=function(){function e(){}return e}()},function(e,t,n){"use strict";function r(e,t){var n=void 0===t?{}:t,r=n.preserveSnapshot,o=n.query,a=void 0===o?{}:o;if(u.d(a))return i(e,{preserveSnapshot:r});var s=Object(f.f)(a);return new d.a(e,function(t){var n=v.switchMap.call(m.map.call(s,function(t){var n=e;if(t.orderByChild?n=n.orderByChild(t.orderByChild):t.orderByKey?n=n.orderByKey():t.orderByPriority?n=n.orderByPriority():t.orderByValue&&(n=n.orderByValue()),u.b(t,"equalTo")){if(n=u.b(t.equalTo,"value")?n.equalTo(t.equalTo.value,t.equalTo.key):n.equalTo(t.equalTo),u.b(t,"startAt")||u.b(t,"endAt"))throw new Error("Query Error: Cannot use startAt or endAt with equalTo.");return u.g(t.limitToFirst)||(n=n.limitToFirst(t.limitToFirst)),u.g(t.limitToLast)||(n=n.limitToLast(t.limitToLast)),n}if(u.b(t,"startAt")&&(n=u.b(t.startAt,"value")?n.startAt(t.startAt.value,t.startAt.key):n.startAt(t.startAt)),u.b(t,"endAt")&&(n=u.b(t.endAt,"value")?n.endAt(t.endAt.value,t.endAt.key):n.endAt(t.endAt)),!u.g(t.limitToFirst)&&t.limitToLast)throw new Error("Query Error: Cannot use limitToFirst with limitToLast.");return u.g(t.limitToFirst)||(n=n.limitToFirst(t.limitToFirst)),u.g(t.limitToLast)||(n=n.limitToLast(t.limitToLast)),n}),function(e,t){return i(e,{preserveSnapshot:r})}).subscribe(t);return function(){return n.unsubscribe()}})}function i(e,t){var n=(void 0===t?{}:t).preserveSnapshot,r=n?function(e){return e}:u.i,i=n?function(e){return e.key}:function(e){return e.$key},c=new d.a(e,function(t){var n=[],c=!1,l=null,u=[];e.once("value",function(e){e.exists()?(e.forEach(function(e){l=e.key}),u.find(function(e){return i(e)===l})&&(c=!0,t.next(u))):(c=!0,t.next(u))},function(e){e&&(t.error(e),t.complete())});var h=e.on("child_added",function(e,n){u=o(u,r(e),i,n),c?t.next(u):e.key===l&&(c=!0,t.next(u))},function(e){e&&(t.error(e),t.complete())});n.push({event:"child_added",handle:h});var d=e.on("child_removed",function(e){u=s(u,r(e),i),c&&t.next(u)},function(e){e&&(t.error(e),t.complete())});n.push({event:"child_removed",handle:d});var p=e.on("child_changed",function(e,n){u=a(u,r(e),i,n),c&&t.next(u)},function(e){e&&(t.error(e),t.complete())});return n.push({event:"child_changed",handle:p}),function(){n.forEach(function(t){e.off(t.event,t.handle)})}});return p.observeOn.call(c,new l.ZoneScheduler(Zone.current))}function o(e,t,n,r){return e.length?e.reduce(function(e,i,o){return r||0!==o||e.push(t),e.push(i),r&&r===n(i)&&e.push(t),e},[]):[t]}function a(e,t,n,r){var i=n(t);return e.reduce(function(e,o,a){var s=n(o);return r||0!=a?s===r?(e.push(o),e.push(t)):s!==i&&e.push(o):(e.push(t),s!==i&&e.push(o)),e},[])}function s(e,t,n){var r=n(t);return e.filter(function(e){return n(e)!==r})}function c(e,t,n,r){return e.map(function(e,i,o){return r||i?i>0&&n(o[i-1])===r?t:e:t})}t.a=r,t.b=o,t.c=a,t.d=s,t.e=c;var l=n(102),u=n(103),h=n(76),d=(n.n(h),n(292)),p=n(92),f=(n.n(p),n(293)),v=n(165),m=(n.n(v),n(50));n.n(m)},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),i=(n.n(r),n(76)),o=(n.n(i),n(103)),a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(e){function t(t,n){var r=e.call(this,n)||this;return r.$ref=t,r}return a(t,e),t.prototype.lift=function(e){var n=new t(this.$ref);return n.source=this,n.operator=e,n.$ref=this.$ref,n},t.prototype.push=function(e){if(!this.$ref)throw new Error("No ref specified for this Observable!");return this.$ref.ref.push(e)},t.prototype.set=function(e,t){var n=this;return this._checkOperationCases(e,{stringCase:function(){return n.$ref.ref.child(e).set(t)},firebaseCase:function(){return e.set(t)},snapshotCase:function(){return e.ref.set(t)},unwrappedSnapshotCase:function(){return n.$ref.ref.child(e.$key).set(t)}})},t.prototype.update=function(e,t){var n=this;return this._checkOperationCases(e,{stringCase:function(){return n.$ref.ref.child(e).update(t)},firebaseCase:function(){return e.update(t)},snapshotCase:function(){return e.ref.update(t)},unwrappedSnapshotCase:function(){return n.$ref.ref.child(e.$key).update(t)}})},t.prototype.remove=function(e){var t=this;return e?this._checkOperationCases(e,{stringCase:function(){return t.$ref.ref.child(e).remove()},firebaseCase:function(){return e.remove()},snapshotCase:function(){return e.ref.remove()},unwrappedSnapshotCase:function(){return t.$ref.ref.child(e.$key).remove()}}):this.$ref.ref.remove()},t.prototype._checkOperationCases=function(e,t){if(o.h(e))return t.stringCase();if(o.f(e))return t.firebaseCase();if(o.e(e))return t.snapshotCase();if(o.c(e))return t.unwrappedSnapshotCase();throw new Error("Method requires a key, snapshot, reference, or unwrapped snapshot. Got: "+typeof e)},t}(r.Observable)},function(e,t,n){"use strict";function r(e,t){return void 0===t&&(t=!0),Object(g.g)(e)?Object(d.of)(null):h.Observable.create(function(n){var r=p.combineLatest.call(i(e),a(e),s(e),c(e),o(e));t&&(r=m.auditTime.call(r,0)),r.subscribe(function(e){var t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s={};if(!Object(g.g)(t)&&!Object(g.g)(t.value))switch(t.key){case y.b.Key:s={orderByKey:t.value};break;case y.b.Priority:s={orderByPriority:t.value};break;case y.b.Value:s={orderByValue:t.value};break;case y.b.Child:s={orderByChild:t.value}}if(!Object(g.g)(a)&&!Object(g.g)(a.value))switch(a.key){case y.a.First:s.limitToFirst=a.value;break;case y.a.Last:s.limitToLast=a.value}void 0!==r&&(s.startAt=r),void 0!==i&&(s.endAt=i),void 0!==o&&(s.equalTo=o),n.next(s)})})}function i(e){var t=["orderByChild","orderByKey","orderByValue","orderByPriority"].map(function(e,t){return{key:e,option:t}}).filter(function(t){var n=t.key;t.option;return!Object(g.g)(e[n])}).map(function(t){var n=t.key,r=t.option;return l(e[n],r)});return 1===t.length?t[0]:t.length>1?f.merge.apply(t[0],t.slice(1)):new h.Observable(function(e){e.next(null)})}function o(e){var t=["limitToFirst","limitToLast"].map(function(e,t){return{key:e,option:t}}).filter(function(t){var n=t.key;t.option;return!Object(g.g)(e[n])}).map(function(t){var n=t.key,r=t.option;return u(e[n],r)});if(1===t.length)return t[0];if(t.length>1){return f.merge.apply(t[0],t.slice(1))}return new h.Observable(function(e){e.next(null)})}function a(e){return e.startAt instanceof h.Observable?e.startAt:Object(g.b)(e,"startAt")?new h.Observable(function(t){t.next(e.startAt)}):new h.Observable(function(e){e.next(void 0)})}function s(e){return e.endAt instanceof h.Observable?e.endAt:Object(g.b)(e,"endAt")?new h.Observable(function(t){t.next(e.endAt)}):new h.Observable(function(e){e.next(void 0)})}function c(e){return e.equalTo instanceof h.Observable?e.equalTo:Object(g.b)(e,"equalTo")?new h.Observable(function(t){t.next(e.equalTo)}):new h.Observable(function(e){e.next(void 0)})}function l(e,t){return e instanceof h.Observable?v.map.call(e,function(e){return{value:e,key:t}}):new h.Observable(function(n){n.next({key:t,value:e})})}function u(e,t){return e instanceof h.Observable?v.map.call(e,function(e){return{value:e,key:t}}):new h.Observable(function(n){n.next({key:t,value:e})})}t.f=r,t.d=i,t.c=o,t.e=a,t.a=s,t.b=c;var h=n(0),d=(n.n(h),n(120)),p=(n.n(d),n(124)),f=(n.n(p),n(157)),v=(n.n(f),n(50)),m=(n.n(v),n(167)),y=(n.n(m),n(785)),g=n(103)},function(e,t,n){"use strict";function r(e,t){var n=(void 0===t?{}:t).preserveSnapshot,r=new i.a(function(t){var r=e.on("value",function(e){t.next(n?e:c.i(e))},function(e){e&&(t.error(e),t.complete())});return function(){return e.off("value",r)}},e);return a.observeOn.call(r,new o.ZoneScheduler(Zone.current))}t.a=r;var i=n(295),o=n(102),a=n(92),s=(n.n(a),n(76)),c=(n.n(s),n(103))},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=(n.n(r),n(76)),o=(n.n(i),this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.$ref=n,r}return o(t,e),t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n.$ref=this.$ref,n},t.prototype.set=function(e){if(!this.$ref)throw new Error("No ref specified for this Observable!");return this.$ref.set(e)},t.prototype.update=function(e){if(!this.$ref)throw new Error("No ref specified for this Observable!");return this.$ref.update(e)},t.prototype.remove=function(){if(!this.$ref)throw new Error("No ref specified for this Observable!");return this.$ref.remove()},t}(r.Observable)},function(e,t,n){!function(r,i){e.exports=t=i(n(80))}(0,function(e){return function(t){var n=e,r=n.lib,i=r.WordArray,o=r.Hasher,a=n.algo,s=[],c=[];!function(){function e(e){return 4294967296*(e-(0|e))|0}for(var n=2,r=0;r<64;)(function(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0})(n)&&(r<8&&(s[r]=e(t.pow(n,.5))),c[r]=e(t.pow(n,1/3)),r++),n++}();var l=[],u=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],h=n[6],d=n[7],p=0;p<64;p++){if(p<16)l[p]=0|e[t+p];else{var f=l[p-15],v=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=l[p-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;l[p]=v+l[p-7]+y+l[p-16]}var g=s&u^~s&h,_=r&i^r&o^i&o,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),S=(s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25),w=d+S+g+c[p]+l[p],E=b+_;d=h,h=u,u=s,s=a+w|0,a=o,o=i,i=r,r=w+E|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+h|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(u),n.HmacSHA256=o._createHmacHelper(u)}(Math),e.SHA256})},function(e,t,n){!function(r,i,o){e.exports=t=i(n(80),n(298),n(787),n(788))}(0,function(e){return e.HmacSHA512})},function(e,t,n){!function(r,i){e.exports=t=i(n(80))}(0,function(e){return function(t){var n=e,r=n.lib,i=r.Base,o=r.WordArray,a=n.x64={};a.Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),a.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return o.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}})}(),e})},function(e,t,n){!function(r,i){e.exports=t=i(n(80))}(0,function(e){return function(){function t(e,t,n){for(var r=[],o=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2,c=n[e.charCodeAt(a)]>>>6-a%4*2;r[o>>>2]|=(s|c)<<24-o%4*8,o++}return i.create(r,o)}var n=e,r=n.lib,i=r.WordArray,o=n.enc;o.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var a=t[o>>>2]>>>24-o%4*8&255,s=t[o+1>>>2]>>>24-(o+1)%4*8&255,c=t[o+2>>>2]>>>24-(o+2)%4*8&255,l=a<<16|s<<8|c,u=0;u<4&&o+.75*u<n;u++)i.push(r.charAt(l>>>6*(3-u)&63));var h=r.charAt(64);if(h)for(;i.length%4;)i.push(h);return i.join("")},parse:function(e){var n=e.length,r=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<r.length;o++)i[r.charCodeAt(o)]=o}var a=r.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(n=s)}return t(e,n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64})},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(169),s=n(0),c=n(36),l=n(57),u=function(){function e(e,t,n,r){this.shipService=e,this.observableMedia=t,this.route=n,this.router=r}return e.prototype.ngOnInit=function(){var e=this;this.shipService.getTacticalPlan().then(function(t){e.tacticalPlan=t}),this.observableMedia.isActive("xs")?this.cols=s.Observable.of(2):this.observableMedia.isActive("sm")?this.cols=s.Observable.of(3):this.observableMedia.isActive("md")?this.cols=s.Observable.of(5):this.observableMedia.isActive("lg")?this.cols=s.Observable.of(6):this.observableMedia.isActive("x1")&&(this.cols=s.Observable.of(7)),this.observableMedia.asObservable().subscribe(function(t){switch(t.mqAlias){case"xs":return e.cols=s.Observable.of(2);case"sm":return e.cols=s.Observable.of(3);case"md":return e.cols=s.Observable.of(5);case"lg":return e.cols=s.Observable.of(6);case"xl":return e.cols=s.Observable.of(7)}})},e.prototype.filterSize=function(e){var t=this,n=this.tacticalPlan.ships.filter(function(n){return t.shipService.getModel(n.name).size==e});return"S"===e?this.shipsSmall=n:"M"===e?this.shipsMedium=n:"L"===e&&(this.shipsLarge=n),n},e.prototype.addS=function(){this.router.navigate(["inventory/add-ship/S"],this.shipService.getNavigationExtras())},e.prototype.addM=function(){this.router.navigate(["inventory/add-ship/M"],this.shipService.getNavigationExtras())},e.prototype.addL=function(){this.router.navigate(["inventory/add-ship/L"],this.shipService.getNavigationExtras())},e=r([o.Component({selector:"inventory",template:n(802),styles:[n(803)]}),i("design:paramtypes",[l.ShipService,a.ObservableMedia,c.ActivatedRoute,c.Router])],e)}();t.InventoryComponent=u},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(36),s=n(57),c=function(){function e(e,t,n){this.shipService=e,this.router=t,this.route=n,this.models=[],this.size="S",this.typeExistsError=!1}return e.prototype.ngOnInit=function(){var e=this;this.shipService.getModels().then(function(t){return e.models=t.sort(function(e,t){return e.name>t.name?1:-1})}),this.route.params.subscribe(function(t){return e.size=t.size})},e.prototype.onShipTypeChange=function(){this.typeExistsError=!1},e.prototype.goBack=function(){this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.addShip=function(){this.shipService.addShip(this.selectedModel)?this.router.navigate(["inventory"],this.shipService.getNavigationExtras()):this.typeExistsError=!0},e.prototype.filterSize=function(e){var t=this;return e.filter(function(e){return e.size==t.size})},e=r([o.Component({selector:"add-ship",template:n(809),styles:[n(810)]}),i("design:paramtypes",[s.ShipService,a.Router,a.ActivatedRoute])],e)}();t.AddShipComponent=c},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(36),s=n(57),c=n(104),l=n(74),u=function(){function e(e,t,n){this.shipService=e,this.router=t,this.mdDialog=n}return e.prototype.getStarted=function(){this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.openControls=function(){this.mdDialog.open(c.ControlsDialogComponent)},e=r([o.Component({selector:"welcome",template:n(812),styles:[n(813)]}),i("design:paramtypes",[s.ShipService,a.Router,l.MdDialog])],e)}();t.WelcomeComponent=u},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(74),s=n(36),c=n(57),l=n(104),u=n(99),h=function(){function e(e,t,n){var r=this;this.shipService=e,this.mdDialog=t,this.router=n,this.backgrounds=[],this.backgrounds=[],u.BACKGROUNDS.forEach(function(e,t){r.backgrounds.push(t)})}return e.prototype.ngOnInit=function(){var e=this;setTimeout(function(){e.bg=e.shipService.tacticalPlan.settings.background,e.showVisualAids=e.shipService.tacticalPlan.settings.showVisualAids,e.animationLength=e.shipService.tacticalPlan.settings.animationLength},1e3)},e.prototype.saveSettings=function(){this.shipService.tacticalPlan.settings.background=this.bg,this.shipService.tacticalPlan.settings.showVisualAids=this.showVisualAids,this.shipService.tacticalPlan.settings.animationLength=this.animationLength,this.shipService.updateTacticalPlan(),this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.manageCrew=function(){var e=this;this.mdDialog.open(l.CrewDialogComponent,{data:{players:this.shipService.tacticalPlan.players.join("\n")}}).afterClosed().subscribe(function(t){t&&"Cancel"!==t&&(e.shipService.tacticalPlan.players=t.split("\n").filter(Boolean),e.shipService.updateTacticalPlan())})},e=r([o.Component({selector:"settings",template:n(815),styles:[n(816)]}),i("design:paramtypes",[c.ShipService,a.MdDialog,s.Router])],e)}();t.SettingsComponent=h},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(226),i=n(9),o=n(734);i.enableProdMode(),r.platformBrowserDynamic().bootstrapModule(o.AppModule)},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=n(243),a=n(41),s=n(74),c=n(160),l=n(240),u=n(169),h=n(55),d=n(735),p=n(300),f=n(805),v=n(301),m=n(104),y=n(302),g=n(303),_=n(174),b=n(57),S=n(182),w=n(818);n(173);var E=n(102),C=n(261);t.environment={firebase:{apiKey:"AIzaSyDoW8mFK8twB6xcEM8mu_ObOSau6gzboww",authDomain:"u-tec-dev.firebaseapp.com",databaseURL:"https://u-tec-dev.firebaseio.com",projectId:"u-tec-dev",storageBucket:"u-tec-dev.appspot.com",messagingSenderId:"795721029461"}};var x=function(){function e(){}return e=r([i.NgModule({imports:[a.BrowserModule,s.MaterialModule,l.FormsModule,c.HttpModule,o.BrowserAnimationsModule,u.FlexLayoutModule,w.AppRoutingModule,E.AngularFireModule.initializeApp(t.environment.firebase),C.AngularFireDatabaseModule],declarations:[d.AppComponent,p.InventoryComponent,f.ShipCardComponent,v.AddShipComponent,m.SimulatorComponent,d.LockDialogComponent,m.CrewDialogComponent,m.ControlsDialogComponent,y.WelcomeComponent,g.SettingsComponent],entryComponents:[d.LockDialogComponent,m.CrewDialogComponent,m.ControlsDialogComponent],providers:[{provide:h.LocationStrategy,useClass:h.HashLocationStrategy},_.SceneService,b.ShipService,S.Joystick],bootstrap:[d.AppComponent]})],e)}();t.AppModule=x},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),s=n(36),c=n(74),l=n(57),u=n(182),h=n(104),d=n(296),p=n(297),f=n(299);n(797);var v=function(){function e(e,t,n,r){this.shipService=e,this.router=t,this.lockDialog=n,this.joystick=r}return e.prototype.newTacticalPlan=function(){window.location.href="/"},e.prototype.isSimulator=function(){return this.activeComponent instanceof h.SimulatorComponent},e.prototype.isAidsVisible=function(){return this.isSimulator()&&this.activeComponent.aidsVisible},e.prototype.manageCrew=function(){this.isSimulator()&&this.activeComponent.manageCrew()},e.prototype.toggleLines=function(){this.isSimulator()&&this.activeComponent.toggleLines()},e.prototype.saveImage=function(){this.isSimulator()&&this.activeComponent.saveImage()},e.prototype.toggleFullscreen=function(){var e=window.document,t=e.documentElement;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},e.prototype.showControls=function(){this.isSimulator()&&this.activeComponent.showControls()},e.prototype.onActivate=function(e){this.activeComponent=e},e.prototype.welcome=function(){this.joystick.hide(),this.router.navigate(["welcome"],this.shipService.getNavigationExtras())},e.prototype.inventory=function(){this.joystick.hide(),this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.openSettings=function(){this.joystick.hide(),this.router.navigate(["settings"],this.shipService.getNavigationExtras())},e.prototype.simulator=function(){this.router.navigate(["simulator"],this.shipService.getNavigationExtras())},e.prototype.lock=function(){var e=this;this.lockDialog.open(m,{data:{type:"Lock"}}).afterClosed().subscribe(function(t){"Cancel"!==t&&e.shipService.setPassword(t)})},e.prototype.unlock=function(){var e=this;this.lockDialog.open(m,{data:{type:"Unlock"}}).afterClosed().subscribe(function(t){"Cancel"!==t&&(e.shipService.passwordHash=f.stringify(p(d(t),t)))})},e.prototype.donate=function(){window.open("https://donorbox.org/uee-tactical-communications-interface","_blank")},e=r([a.Component({selector:"u-tec",template:n(798),styles:[n(799)]}),i("design:paramtypes",[l.ShipService,s.Router,c.MdDialog,u.Joystick])],e)}();t.AppComponent=v;var m=function(){function e(e,t){this.dialogRef=e,this.data=t}return e=r([a.Component({selector:"lock-dialog",template:n(801)}),o(1,a.Inject(c.MD_DIALOG_DATA)),i("design:paramtypes",[c.MdDialogRef,Object])],e)}();t.LockDialogComponent=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_COMMON:"KHR_materials_common",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_TECHNIQUE_WEBGL:"KHR_technique_webgl"},o="glTF",a=12,s={JSON:1313821514,BIN:5130562},c=function(){function e(e){this.manager=void 0!==e?e:r.DefaultLoadingManager}return e.prototype.load=function(e,t,n,i){var o=this,a=this.path&&"string"==typeof this.path?this.path:r.Loader.prototype.extractUrlBase(e),s=new r.FileLoader(o.manager);s.setResponseType("arraybuffer"),s.load(e,function(e){o.parse(e,t,a)},n,i)},e.prototype.setCrossOrigin=function(e){this.crossOrigin=e},e.prototype.setPath=function(e){this.path=e},e.prototype.parse=function(e,t,n){var r,a={};I.convertUint8ArrayToString(new Uint8Array(e,0,4))===o?(a[i.KHR_BINARY_GLTF]=new p(e),r=a[i.KHR_BINARY_GLTF].content):r=I.convertUint8ArrayToString(new Uint8Array(e));var s=JSON.parse(r);s.extensionsUsed&&(s.extensionsUsed.indexOf(i.KHR_LIGHTS)>=0&&(a[i.KHR_LIGHTS]=new h(s)),s.extensionsUsed.indexOf(i.KHR_MATERIALS_COMMON)>=0&&(a[i.KHR_MATERIALS_COMMON]=new d(s)),s.extensionsUsed.indexOf(i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(a[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new v),s.extensionsUsed.indexOf(i.KHR_TECHNIQUE_WEBGL)>=0&&(a[i.KHR_TECHNIQUE_WEBGL]=new f(s))),console.time("GLTF2Loader"),new k(s,a,{path:n||this.path,crossOrigin:this.crossOrigin}).parse(function(e,n,r,i){console.timeEnd("GLTF2Loader"),t({scene:e,scenes:n,cameras:r,animations:i})})},e}();t.GLTF2Loader=c;var l=function(){function e(){}return e.prototype.get=function(e){return this.objects[e]},e.prototype.add=function(e,t){this.objects[e]=t},e.prototype.remove=function(e){delete this.objects[e]},e.prototype.removeAll=function(){this.objects={}},e.prototype.update=function(e,t){for(var n in this.objects){var r=this.objects[n];r.update&&r.update(e,t)}},e}();t.GLTFRegistry=l;var u=function(){function e(e,t){var n={},i=e.material.uniforms;for(var o in i){var a=i[o];if(a.semantic){var s=a.node,c=e;s&&(c=t[s]),n[o]={semantic:a.semantic,sourceNode:c,targetNode:e,uniform:a}}}this.boundUniforms=n,this._m4=new r.Matrix4}return e.prototype.update=function(e,t){var n=this.boundUniforms;for(var r in n){var i=n[r];switch(i.semantic){case"MODELVIEW":var o=i.uniform.value;o.multiplyMatrices(t.matrixWorldInverse,i.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var a=i.uniform.value;this._m4.multiplyMatrices(t.matrixWorldInverse,i.sourceNode.matrixWorld),a.getNormalMatrix(this._m4);break;case"PROJECTION":var o=i.uniform.value;o.copy(t.projectionMatrix);break;case"JOINTMATRIX":for(var s=i.uniform.value,c=0;c<s.length;c++)s[c].getInverse(i.sourceNode.matrixWorld).multiply(i.targetNode.skeleton.bones[c].matrixWorld).multiply(i.targetNode.skeleton.boneInverses[c]).multiply(i.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+i.semantic)}}},e}();t.GLTFShader=u;var h=function(){function e(e){this.name=i.KHR_LIGHTS,this.lights={};var t=e.extensions&&e.extensions[i.KHR_LIGHTS]||{},n=t.lights||{};for(var o in n){var a,s=n[o],c=(new r.Color).fromArray(s.color);switch(s.type){case"directional":a=new r.DirectionalLight(c),a.position.set(0,0,1);break;case"point":a=new r.PointLight(c);break;case"spot":a=new r.SpotLight(c),a.position.set(0,0,1);break;case"ambient":a=new r.AmbientLight(c)}a&&(void 0!==s.constantAttenuation&&(a.intensity=s.constantAttenuation),void 0!==s.linearAttenuation&&(a.distance=1/s.linearAttenuation),void 0!==s.quadraticAttenuation&&(a.decay=s.quadraticAttenuation),void 0!==s.fallOffAngle&&(a.angle=s.fallOffAngle),void 0!==s.fallOffExponent&&console.warn("GLTF2Loader: light.fallOffExponent not currently supported."),a.name=s.name||"light_"+o,this.lights[o]=a)}}return e}();t.GLTFLightsExtension=h;var d=function(){function e(e){this.name=i.KHR_MATERIALS_COMMON}return e.prototype.getMaterialType=function(e){switch(e.extensions[this.name].type){case"commonBlinn":case"commonPhong":return r.MeshPhongMaterial;case"commonLambert":return r.MeshLambertMaterial;case"commonConstant":default:return r.MeshBasicMaterial}},e.prototype.extendParams=function(e,t,n){var i=t.extensions[this.name],o=[];switch(i.type){case"commonBlinn":case"commonPhong":o.push("diffuseFactor","diffuseTexture","specularFactor","specularTexture","shininessFactor");break;case"commonLambert":o.push("diffuseFactor","diffuseTexture")}var a={};o.forEach(function(e){void 0!==i[e]&&(a[e]=i[e])}),void 0!==a.diffuseFactor&&(e.color=(new r.Color).fromArray(a.diffuseFactor),e.opacity=a.diffuseFactor[3]),void 0!==a.diffuseTexture&&(e.map=n.textures[a.diffuseTexture.index]),void 0!==a.specularFactor&&(e.specular=(new r.Color).fromArray(a.specularFactor)),void 0!==a.specularTexture&&(e.specularMap=n.textures[a.specularTexture.index]),void 0!==a.shininessFactor&&(e.shininess=a.shininessFactor)},e}();t.GLTFMaterialsCommonExtension=d;var p=function(){function e(e){this.name=i.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,a);if(this.header={magic:I.convertUint8ArrayToString(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==o)throw new Error("GLTF2Loader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTF2Loader: Legacy binary file detected. Use GLTFLoader instead.");for(var n=new DataView(e,a),r=0;r<n.byteLength;){var c=n.getUint32(r,!0);r+=4;var l=n.getUint32(r,!0);if(r+=4,l===s.JSON){var u=new Uint8Array(e,a+r,c);this.content=I.convertUint8ArrayToString(u)}else if(l===s.BIN){var h=a+r;this.body=e.slice(h,h+c)}r+=c}if(null===this.content)throw new Error("GLTF2Loader: JSON content not found.")}return e}();t.GLTFBinaryExtension=p;var f=function(){function e(e){this.name=i.KHR_TECHNIQUE_WEBGL;var t=e.extensions&&e.extensions[i.KHR_TECHNIQUE_WEBGL]||{};this.techniques=t.techniques||{},this.programs=t.programs||{},this.shaders=t.shaders||{}}return e.prototype.getMaterialType=function(){return N},e.prototype.extendParams=function(e,t,n){var o=t[i.KHR_TECHNIQUE_WEBGL],a=n.techniques[o.technique];e.uniforms={};var s=n.programs[a.program];if(void 0!==s){if(e.fragmentShader=n.shaders[s.fragmentShader],!e.fragmentShader)throw new Error("ERROR: Missing fragment shader definition:"+s.fragmentShader);var c=n.shaders[s.vertexShader];if(!c)throw new Error("ERROR: Missing vertex shader definition:"+s.vertexShader);e.vertexShader=I.replaceTHREEShaderAttributes(c,a);var l=a.uniforms;for(var u in l){var h=l[u],d=a.parameters[h],p=d.type;if(!y[p])throw new Error("Unknown shader uniform param type: "+p);var f,v=d.count;void 0!==t.values&&(f=t.values[h]);var g=new y[p],_=d.semantic,b=d.node;switch(p){case m.FLOAT:g=d.value,"transparency"===h&&(e.transparent=!0),void 0!==f&&(g=f);break;case m.FLOAT_VEC2:case m.FLOAT_VEC3:case m.FLOAT_VEC4:case m.FLOAT_MAT3:d&&d.value&&g.fromArray(d.value),f&&g.fromArray(f);break;case m.FLOAT_MAT4:if(v){g=new Array(v);for(var S=0;S<v;S++)g[S]=new y[p];if(d&&d.value){var w=d.value;g.fromArray(w)}f&&g.fromArray(f)}else{if(d&&d.value){var P=d.value;g.fromArray(P)}f&&g.fromArray(f)}break;case m.SAMPLER_2D:g=void 0!==f?n.textures[f]:void 0!==d.value?n.textures[d.value]:null}e.uniforms[u]={value:g,semantic:_,node:b}}for(var O=a.states||{},A=O.enable||[],R=O.functions||{},N=!1,k=!1,D=!1,L=0,F=A.length;L<F;L++){var j=A[L];switch(M[j]){case"CULL_FACE":N=!0;break;case"DEPTH_TEST":k=!0;break;case"BLEND":D=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+j)}}e.side=N?void 0!==R.cullFace?E[R.cullFace]:r.FrontSide:r.DoubleSide,e.depthTest=k,e.depthFunc=void 0!==R.depthFunc?C[R.depthFunc]:r.LessDepth,e.depthWrite=void 0===R.depthMask||R.depthMask[0],e.blending=D?r.CustomBlending:r.NoBlending,e.transparent=D;var W=R.blendEquationSeparate;void 0!==W?(e.blendEquation=x[W[0]],e.blendEquationAlpha=x[W[1]]):(e.blendEquation=r.AddEquation,e.blendEquationAlpha=r.AddEquation);var B=R.blendFuncSeparate;void 0!==B?(e.blendSrc=T[B[0]],e.blendDst=T[B[1]],e.blendSrcAlpha=T[B[2]],e.blendDstAlpha=T[B[3]]):(e.blendSrc=r.OneFactor,e.blendDst=r.ZeroFactor,e.blendSrcAlpha=r.OneFactor,e.blendDstAlpha=r.ZeroFactor)}},e}();t.GLTFTechniqueWebglExtension=f;var v=function(){function e(){this.name=i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS}return e.prototype.getMaterialType=function(){return r.ShaderMaterial},e.prototype.extendParams=function(e,t,n){var i=t.extensions[this.name],o=r.ShaderLib.standard,a=r.UniformsUtils.clone(o.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),c=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),d=o.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",c).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",h);if(delete a.roughness,delete a.metalness,delete a.roughnessMap,delete a.metalnessMap,a.specular={value:(new r.Color).setHex(1118481)},a.glossiness={value:.5},a.specularMap={value:null},a.glossinessMap={value:null},e.vertexShader=o.vertexShader,e.fragmentShader=d,e.uniforms=a,e.defines={STANDARD:""},e.color=new r.Color(1,1,1),e.opacity=1,Array.isArray(i.diffuseFactor)){var p=i.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}void 0!==i.diffuseTexture&&(e.map=n.textures[i.diffuseTexture.index]),e.emissive=new r.Color(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new r.Color(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture&&(e.glossinessMap=n.textures[i.specularGlossinessTexture.index],e.specularMap=n.textures[i.specularGlossinessTexture.index])},e.prototype.createMaterial=function(e){var t=new r.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalScale=new r.Vector2(1,1),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},e.prototype.refreshUniforms=function(e,t,n,r,i,o){var a=i.uniforms,s=i.defines;a.opacity.value=i.opacity,a.diffuse.value.copy(i.color),a.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),a.map.value=i.map,a.specularMap.value=i.specularMap,a.alphaMap.value=i.alphaMap,a.lightMap.value=i.lightMap,a.lightMapIntensity.value=i.lightMapIntensity,a.aoMap.value=i.aoMap,a.aoMapIntensity.value=i.aoMapIntensity;var c;if(i.map?c=i.map:i.specularMap?c=i.specularMap:i.displacementMap?c=i.displacementMap:i.normalMap?c=i.normalMap:i.bumpMap?c=i.bumpMap:i.glossinessMap?c=i.glossinessMap:i.alphaMap?c=i.alphaMap:i.emissiveMap&&(c=i.emissiveMap),void 0!==c){c.isWebGLRenderTarget&&(c=c.texture);var l=c.offset,u=c.repeat;a.offsetRepeat.value.set(l.x,l.y,u.x,u.y)}a.envMap.value=i.envMap,a.envMapIntensity.value=i.envMapIntensity,a.flipEnvMap.value=i.envMap&&i.envMap.isCubeTexture?-1:1,a.refractionRatio.value=i.refractionRatio,a.specular.value.copy(i.specular),a.glossiness.value=i.glossiness,a.glossinessMap.value=i.glossinessMap,a.emissiveMap.value=i.emissiveMap,a.bumpMap.value=i.bumpMap,a.normalMap.value=i.normalMap,a.displacementMap.value=i.displacementMap,a.displacementScale.value=i.displacementScale,a.displacementBias.value=i.displacementBias,null!==a.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===a.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)},e}();t.GLTFMaterialsPbrSpecularGlossinessExtension=v;var m={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},y={5126:Number,35675:r.Matrix3,35676:r.Matrix4,35664:r.Vector2,35665:r.Vector3,35666:r.Vector4,35678:r.Texture},g={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_={9728:r.NearestFilter,9729:r.LinearFilter,9984:r.NearestMipMapNearestFilter,9985:r.LinearMipMapNearestFilter,9986:r.NearestMipMapLinearFilter,9987:r.LinearMipMapLinearFilter},b={33071:r.ClampToEdgeWrapping,33648:r.MirroredRepeatWrapping,10497:r.RepeatWrapping},S={6406:r.AlphaFormat,6407:r.RGBFormat,6408:r.RGBAFormat,6409:r.LuminanceFormat,6410:r.LuminanceAlphaFormat},w={5121:r.UnsignedByteType,32819:r.UnsignedShort4444Type,32820:r.UnsignedShort5551Type,33635:r.UnsignedShort565Type},E={1028:r.BackSide,1029:r.FrontSide},C={512:r.NeverDepth,513:r.LessDepth,514:r.EqualDepth,515:r.LessEqualDepth,516:r.GreaterEqualDepth,517:r.NotEqualDepth,518:r.GreaterEqualDepth,519:r.AlwaysDepth},x={32774:r.AddEquation,32778:r.SubtractEquation,32779:r.ReverseSubtractEquation},T={0:r.ZeroFactor,1:r.OneFactor,768:r.SrcColorFactor,769:r.OneMinusSrcColorFactor,770:r.SrcAlphaFactor,771:r.OneMinusSrcAlphaFactor,772:r.DstAlphaFactor,773:r.OneMinusDstAlphaFactor,774:r.DstColorFactor,775:r.OneMinusDstColorFactor,776:r.SrcAlphaSaturateFactor},P={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O={scale:"scale",position:"position",rotation:"quaternion",weights:"morphTargetInfluences"},A={LINEAR:r.InterpolateLinear,STEP:r.InterpolateDiscrete},M={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"},R={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},I=function(){function e(){}return e.each=function(e,t,n){if(!e)return Promise.resolve();var r,i=[];if("[object Array]"===Object.prototype.toString.call(e)){r=[];for(var o=e.length,a=0;a<o;a++){var s=t.call(n||this,e[a],a);s&&(i.push(s),s instanceof Promise?s.then(function(e,t){r[e]=t}.bind(this,a)):r[a]=s)}}else{r={};for(var c in e)if(e.hasOwnProperty(c)){var s=t.call(n||this,e[c],c);s&&(i.push(s),s instanceof Promise?s.then(function(e,t){r[e]=t}.bind(this,c)):r[c]=s)}}return Promise.all(i).then(function(){return r})},e.resolveURL=function(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t||"")+e},e.convertUint8ArrayToString=function(e){for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);return t},e.replaceTHREEShaderAttributes=function(e,t){var n={};for(var r in t.attributes){var i=t.attributes[r],o=t.parameters[i],a=o.type,s=o.semantic;n[r]={type:a,semantic:s}}var c=t.parameters,l=t.attributes,u={};for(var r in n){var i=l[r],h=c[i],s=h.semantic;s&&(u[r]=h)}var i;for(i in u){var o=u[i],s=o.semantic,d=new RegExp("\\b"+i+"\\b","g");switch(s){case"POSITION":e=e.replace(d,"position");break;case"NORMAL":e=e.replace(d,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":e=e.replace(d,"uv");break;case"TEXCOORD_1":e=e.replace(d,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":e=e.replace(d,"color");break;case"WEIGHTS_0":case"WEIGHT":e=e.replace(d,"skinWeight");break;case"JOINTS_0":case"JOINT":e=e.replace(d,"skinIndex")}}return e},e.createDefaultMaterial=function(){return new r.MeshPhongMaterial({color:0,side:r.DoubleSide})},e}(),N=function(){function e(e){this.isDeferredShaderMaterial=!0,this.params=e}return e.prototype.create=function(){var e=r.UniformsUtils.clone(this.params.uniforms);for(var t in this.params.uniforms){var n=this.params.uniforms[t];n.value instanceof r.Texture&&(e[t].value=n.value,e[t].value.needsUpdate=!0),e[t].semantic=n.semantic,e[t].node=n.node}return this.params.uniforms=e,new r.RawShaderMaterial(this.params)},e}(),k=function(){function e(e,t,n){this.json=e||{},this.extensions=t||{},this.options=n||{},this.cache=new l}return e.prototype.withDependencies=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n],i="load"+r.charAt(0).toUpperCase()+r.slice(1),o=this.cache.get(r);if(void 0!==o)t[r]=o;else if(this[i]){var a=this[i]();this.cache.add(r,a),t[r]=a}}return I.each(t,function(e){return e})},e.prototype.parse=function(e){var t=this.json;this.cache.removeAll(),this.withDependencies(["scenes","cameras","animations"]).then(function(n){var r=[];for(var i in n.scenes)r.push(n.scenes[i]);var o=void 0!==t.scene?n.scenes[t.scene]:r[0],a=[];for(var i in n.cameras){var s=n.cameras[i];a.push(s)}var c=[];for(var i in n.animations)c.push(n.animations[i]);e(o,r,a,c)})},e.prototype.loadShaders=function(){var e=this.json,t=this.options,n=this.extensions;return this.withDependencies(["bufferViews"]).then(function(o){var a=void 0!==n[i.KHR_TECHNIQUE_WEBGL]?n[i.KHR_TECHNIQUE_WEBGL].shaders:e.shaders;return void 0===a&&(a={}),I.each(a,function(e){if(void 0!==e.bufferView){var n=o.bufferViews[e.bufferView],i=new Uint8Array(n);return I.convertUint8ArrayToString(i)}return new Promise(function(n){var i=new r.FileLoader;i.setResponseType("text"),i.load(I.resolveURL(e.uri,t.path),function(e){n(e)})})})})},e.prototype.loadBuffers=function(){var e=this.json,t=this.extensions,n=this.options;return I.each(e.buffers,function(e,o){if("arraybuffer"===e.type||void 0===e.type)return void 0===e.uri&&0===o?t[i.KHR_BINARY_GLTF].body:new Promise(function(t){var i=new r.FileLoader;i.setResponseType("arraybuffer"),i.load(I.resolveURL(e.uri,n.path),function(e){t(e)})});console.warn("THREE.GLTF2Loader: "+e.type+" buffer type is not supported")})},e.prototype.loadBufferViews=function(){var e=this.json;return this.withDependencies(["buffers"]).then(function(t){return I.each(e.bufferViews,function(e){var n=t.buffers[e.buffer],r=e.byteLength||0,i=e.byteOffset||0;return n.slice(i,i+r)})})},e.prototype.loadAccessors=function(){var e=this.json;return this.withDependencies(["bufferViews"]).then(function(t){return I.each(e.accessors,function(n){var i,o=t.bufferViews[n.bufferView],a=P[n.type],s=g[n.componentType],c=s.BYTES_PER_ELEMENT,l=c*a,u=e.bufferViews[n.bufferView].byteStride;if(u&&u!==l){i=new s(o);var h=new r.InterleavedBuffer(i,u/c);return new r.InterleavedBufferAttribute(h,a,n.byteOffset/c,!1)}return i=new s(o,n.byteOffset,n.count*a),new r.BufferAttribute(i,a)})})},e.prototype.loadTextures=function(){var e=this.json,t=this.options;return this.withDependencies(["bufferViews"]).then(function(n){return I.each(e.textures,function(i){if(void 0!==i.source)return new Promise(function(o){var a,s=e.images[i.source],c=s.uri;if(void 0!==s.bufferView){var l=n.bufferViews[s.bufferView],u=new Blob([l],{type:s.mimeType});a=window.URL,c=a.createObjectURL(u)}var h=r.Loader.Handlers.get(c);null===h&&(h=new r.TextureLoader),h.setCrossOrigin(t.crossOrigin),h.load(I.resolveURL(c,t.path),function(t){void 0!==a&&a.revokeObjectURL(c),t.flipY=!1,void 0!==i.name&&(t.name=i.name),t.format=void 0!==i.format?S[i.format]:r.RGBAFormat,void 0!==i.internalFormat&&t.format!==S[i.internalFormat]&&console.warn("THREE.GLTF2Loader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==i.type?w[i.type]:r.UnsignedByteType;var n=e.samplers||{},s=n[i.sampler]||{};t.magFilter=_[s.magFilter]||r.LinearFilter,t.minFilter=_[s.minFilter]||r.NearestMipMapLinearFilter,t.wrapS=b[s.wrapS]||r.RepeatWrapping,t.wrapT=b[s.wrapT]||r.RepeatWrapping,o(t)},void 0,function(){o()})})})})},e.prototype.loadMaterials=function(){var e=this.json,t=this.extensions;return this.withDependencies(["shaders","textures"]).then(function(n){return I.each(e.materials,function(e){var o,a={},s=e.extensions||{};if(s[i.KHR_MATERIALS_COMMON])o=t[i.KHR_MATERIALS_COMMON].getMaterialType(e),t[i.KHR_MATERIALS_COMMON].extendParams(a,e,n);else if(s[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS])o=t[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].getMaterialType(e),t[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].extendParams(a,e,n);else if(s[i.KHR_TECHNIQUE_WEBGL])o=t[i.KHR_TECHNIQUE_WEBGL].getMaterialType(e),t[i.KHR_TECHNIQUE_WEBGL].extendParams(a,e,n);else if(void 0!==e.pbrMetallicRoughness){o=r.MeshStandardMaterial;var c=e.pbrMetallicRoughness;if(a.color=new r.Color(1,1,1),a.opacity=1,Array.isArray(c.baseColorFactor)){var l=c.baseColorFactor;a.color.fromArray(l),a.opacity=l[3]}if(void 0!==c.baseColorTexture&&(a.map=n.textures[c.baseColorTexture.index]),a.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,a.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture){var u=c.metallicRoughnessTexture.index;a.metalnessMap=n.textures[u],a.roughnessMap=n.textures[u]}}else o=r.MeshPhongMaterial;!0===e.doubleSided&&(a.side=r.DoubleSide);var h=e.alphaMode||R.OPAQUE;a.transparent=h!==R.OPAQUE,void 0!==e.normalTexture&&(a.normalMap=n.textures[e.normalTexture.index]),void 0!==e.occlusionTexture&&(a.aoMap=n.textures[e.occlusionTexture.index]),void 0!==e.emissiveFactor&&(o===r.MeshBasicMaterial?a.color=(new r.Color).fromArray(e.emissiveFactor):a.emissive=(new r.Color).fromArray(e.emissiveFactor)),void 0!==e.emissiveTexture&&(o===r.MeshBasicMaterial?a.map=n.textures[e.emissiveTexture.index]:a.emissiveMap=n.textures[e.emissiveTexture.index]);var d;return d=o===r.ShaderMaterial?t[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),void 0!==e.name&&(d.name=e.name),d})})},e.prototype.loadMeshes=function(){var e=this.json;return this.withDependencies(["accessors","materials"]).then(function(t){return I.each(e.meshes,function(e){var n=new r.Group;void 0!==e.name&&(n.name=e.name),e.extras&&(n.userData=e.extras);var i=e.primitives||[];for(var o in i){var a,s,c=i[o],l=void 0!==c.material?t.materials[c.material]:I.createDefaultMaterial();if(c.mode===m.TRIANGLES||void 0===c.mode){a=new r.BufferGeometry;var u=c.attributes;for(var h in u){var d=u[h];if(void 0===d)return;var p=t.accessors[d];switch(h){case"POSITION":a.addAttribute("position",p);break;case"NORMAL":a.addAttribute("normal",p);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":a.addAttribute("uv",p);break;case"TEXCOORD_1":a.addAttribute("uv2",p);break;case"COLOR_0":case"COLOR0":case"COLOR":a.addAttribute("color",p);break;case"WEIGHTS_0":case"WEIGHT":a.addAttribute("skinWeight",p);break;case"JOINTS_0":case"JOINT":a.addAttribute("skinIndex",p)}}if(void 0!==c.indices&&a.setIndex(t.accessors[c.indices]),void 0!==l.aoMap&&void 0===a.attributes.uv2&&void 0!==a.attributes.uv&&a.addAttribute("uv2",new r.BufferAttribute(a.attributes.uv.array,2)),s=new r.Mesh(a,l),s.castShadow=!0,void 0!==c.targets){var f=c.targets,v=a.morphAttributes;v.position=[],v.normal=[],l.morphTargets=!0;for(var y=0,g=f.length;y<g;y++){var _,b,S=f[y],w="morphTarget"+y;if(void 0!==S.POSITION){_=t.accessors[S.POSITION].clone();for(var E=a.attributes.position,C=0,x=_.array.length;C<x;C++)_.array[C]+=E.array[C]}else _=a.attributes.position.clone();if(void 0!==S.NORMAL){l.morphNormals=!0,b=t.accessors[S.NORMAL].clone();for(var T=a.attributes.normal,C=0,x=b.array.length;C<x;C++)b.array[C]+=T.array[C]}else b=a.attributes.normal.clone();S.TANGENT,_.name=w,b.name=w,v.position.push(_),v.normal.push(b)}if(s.updateMorphTargets(),void 0!==e.weights)for(var y=0,g=e.weights.length;y<g;y++)s.morphTargetInfluences[y]=e.weights[y]}}else{if(c.mode!==m.LINES)throw new Error("Only triangular and line primitives are supported");a=new r.BufferGeometry;var u=c.attributes;for(var h in u){var d=u[h];if(!d)return;var p=t.accessors[d];switch(h){case"POSITION":a.addAttribute("position",p);break;case"COLOR_0":case"COLOR0":case"COLOR":a.addAttribute("color",p)}}void 0!==c.indices?(a.setIndex(t.accessors[c.indices]),s=new r.LineSegments(a,l)):s=new r.Line(a,l)}void 0!==a.attributes.color&&(l.vertexColors=r.VertexColors,l.needsUpdate=!0),s.name="0"===o?n.name:n.name+o,c.extras&&(s.userData=c.extras),n.add(s)}return n})})},e.prototype.loadCameras=function(){var e=this.json;return I.each(e.cameras,function(e){var t;if("perspective"==e.type&&e.perspective){var n=e.perspective.yfov,i=void 0!==e.perspective.aspectRatio?e.perspective.aspectRatio:1,o=n*i;return t=new r.PerspectiveCamera(r.Math.radToDeg(o),i,e.perspective.znear||1,e.perspective.zfar||2e6),void 0!==e.name&&(t.name=e.name),e.extras&&(t.userData=e.extras),t}if("orthographic"==e.type&&e.orthographic)return t=new r.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,e.orthographic.znear,e.orthographic.zfar),void 0!==e.name&&(t.name=e.name),e.extras&&(t.userData=e.extras),t})},e.prototype.loadSkins=function(){var e=this.json;return this.withDependencies(["accessors"]).then(function(t){return I.each(e.skins,function(e){var n=new r.Matrix4;return void 0!==e.bindShapeMatrix&&n.fromArray(e.bindShapeMatrix),{bindShapeMatrix:n,joints:e.joints,inverseBindMatrices:t.accessors[e.inverseBindMatrices]}})})},e.prototype.loadAnimations=function(){var e=this.json;return this.withDependencies(["accessors","nodes"]).then(function(t){return I.each(e.animations,function(e,n){var i=[];for(var o in e.channels){var a=e.channels[o],s=e.samplers[a.sampler];if(s){var c=a.target,l=void 0!==c.node?c.node:c.id,u=void 0!==e.parameters?e.parameters[s.input]:s.input,h=void 0!==e.parameters?e.parameters[s.output]:s.output,d=t.accessors[u],p=t.accessors[h],f=t.nodes[l];if(f){f.updateMatrix(),f.matrixAutoUpdate=!0;var v;switch(O[c.path]){case O.weights:v=r.NumberKeyframeTrack;break;case O.rotation:v=r.QuaternionKeyframeTrack;break;case O.position:case O.scale:default:v=r.VectorKeyframeTrack}var m=f.name?f.name:f.uuid,y=void 0!==s.interpolation?A[s.interpolation]:r.InterpolateLinear,g=[];O[c.path]===O.weights?f.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&g.push(e.name?e.name:e.uuid)}):g.push(m);for(var _=0,b=g.length;_<b;_++)i.push(new v(g[_]+"."+O[c.path],r.AnimationUtils.arraySlice(d.array,0,void 0),r.AnimationUtils.arraySlice(p.array,0,void 0),y))}}}var l=void 0!==e.name?e.name:"animation_"+n;return new r.AnimationClip(l,void 0,i)})})},e.prototype.loadNodes=function(){var e=this.json,t=this.extensions,n=this,o=e.nodes||[],a=e.skins||[];return Array.from(a).forEach(function(e){e.joints.forEach(function(e){o[e].isBone=!0})}),I.each(e.nodes,function(e){var t=new r.Matrix4,n=!0===e.isBone?new r.Bone(void 0):new r.Object3D;return void 0!==e.name&&(n.name=e.name.replace(/\s/g,"_").replace(/[^\w-]/g,"")),e.extras&&(n.userData=e.extras),void 0!==e.matrix?(t.fromArray(e.matrix),n.applyMatrix(t)):(void 0!==e.translation&&n.position.fromArray(e.translation),void 0!==e.rotation&&n.quaternion.fromArray(e.rotation),void 0!==e.scale&&n.scale.fromArray(e.scale)),n}).then(function(o){return n.withDependencies(["meshes","skins","cameras"]).then(function(n){return I.each(o,function(a,s){var c,l=e.nodes[s];if(void 0!==l.mesh?c=[l.mesh]:void 0!==l.meshes&&(console.warn("GLTF2Loader: Legacy glTF file detected. Nodes may have no more than 1 mesh."),c=l.meshes),void 0!==c)for(var u in c){var h=c[u],d=n.meshes[h];if(void 0!==d)for(var p in d.children){var f,v=d.children[p],m=v.material,y=v.geometry,g=v.userData,_=v.name;switch(m.isDeferredShaderMaterial?m=f=m.create():f=m,v.type){case"LineSegments":v=new r.LineSegments(y,f);break;case"LineLoop":case"Line":v=new r.Line(y,f);break;default:v=new r.Mesh(y,f)}v.castShadow=!0,v.userData=g,v.name=_;var b;if(void 0!==l.skin&&(b=n.skins[l.skin]),b){var S=y;f=m,f.skinning=!0,v=new r.SkinnedMesh(S,f,!1),v.castShadow=!0,v.userData=g,v.name=_;for(var w=[],E=[],C=0,x=b.joints.length;C<x;C++){var T=b.joints[C],P=o[T];if(P){w.push(P);var O=b.inverseBindMatrices.array,A=(new r.Matrix4).fromArray(O,16*C);E.push(A)}else console.warn("WARNING: joint: '"+T+"' could not be found")}v.bind(new r.Skeleton(w,E,!1),b.bindShapeMatrix);var M=function(t,n,r){var i=t[r];if(void 0!==i)for(var a=0,s=i.length;a<s;a++){var c=i[a],l=o[c],u=e.nodes[c];void 0!==l&&!0===l.isBone&&void 0!==u&&(n.add(l),M(u,l,"children"))}};M(l,v,"skeletons")}a.add(v)}else console.warn("GLTF2Loader: Couldn't find node \""+h+'".')}if(void 0!==l.camera){var R=n.cameras[l.camera];a.add(R)}if(l.extensions&&l.extensions[i.KHR_LIGHTS]&&void 0!==l.extensions[i.KHR_LIGHTS].light){var I=t[i.KHR_LIGHTS].lights;a.add(I[l.extensions[i.KHR_LIGHTS].light])}return a})})})},e.prototype.loadScenes=function(){function e(n,r,i){var o=i[n];r.add(o);var a=t.nodes[n];if(a.children)for(var s=a.children,c=0,l=s.length;c<l;c++){var u=s[c];e(u,o,i)}}var t=this.json,n=this.extensions;return this.withDependencies(["nodes"]).then(function(o){return I.each(t.scenes,function(t){var a=new r.Scene;void 0!==t.name&&(a.name=t.name),t.extras&&(a.userData=t.extras);for(var s=t.nodes||[],c=0,l=s.length;c<l;c++){e(s[c],a,o.nodes)}if(a.traverse(function(e){e.material&&e.material.isRawShaderMaterial&&(e.gltfShader=new u(e,o.nodes),e.onBeforeRender=function(e,t,n){this.gltfShader.update(t,n)}),e.material&&"ShaderMaterial"===e.material.type&&(e.onBeforeRender=n[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}),t.extensions&&t.extensions[i.KHR_LIGHTS]&&void 0!==t.extensions[i.KHR_LIGHTS].light){var h=n[i.KHR_LIGHTS].lights;a.add(h[t.extensions[i.KHR_LIGHTS].light])}return a})})},e}()},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),o=function(e){function t(){var t=e.call(this)||this;return t.translationObject=new i.Vector3,t.quaternionObject=new i.Quaternion,t.scaleObject=new i.Vector3,t.translationWorld=new i.Vector3,t.quaternionWorld=new i.Quaternion,t.scaleWorld=new i.Vector3,t}return r(t,e),t.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null!==this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},t}(i.Object3D);t.Gyroscope=o},function(e,t,n){"use strict";var r=n(262);n.d(t,"a",function(){return r.a});var i=n(291);n.d(t,"e",function(){return i.a}),n.d(t,"p",function(){return i.b}),n.d(t,"q",function(){return i.c}),n.d(t,"r",function(){return i.d}),n.d(t,"s",function(){return i.e});var o=n(292);n.d(t,"f",function(){return o.a});var a=n(294);n.d(t,"g",function(){return a.a});var s=n(295);n.d(t,"h",function(){return s.a});var c=n(293);n.d(t,"j",function(){return c.a}),n.d(t,"k",function(){return c.b}),n.d(t,"l",function(){return c.c}),n.d(t,"m",function(){return c.d}),n.d(t,"n",function(){return c.e}),n.d(t,"o",function(){return c.f});var l=n(786);n.d(t,"b",function(){return l.a}),n.d(t,"c",function(){return l.b}),n.d(t,"d",function(){return l.c}),n.d(t,"i",function(){return l.d})},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=t[i];if(e.call(r,o,i,t))return i;i++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=t[i];if(e.call(r,o,i,t))return o;i++}}})},function(e,t,n){"use strict";function r(){function e(e){v(y[e],"delete"),delete y[e]}function t(e){return e=e||u,l(y,e)||i("no-app",{name:e}),y[e]}function n(e,t){void 0===t?t=u:"string"==typeof t&&""!==t||i("bad-app-name",{name:t+""}),l(y,t)&&i("duplicate-app",{name:t});var n=new d(e,t,b);return y[t]=n,v(n,"create"),n}function h(){return Object.keys(y).map(function(e){return y[e]})}function p(e,n,r,o,a){g[e]&&i("duplicate-service",{name:e}),g[e]=n,o&&(_[e]=o,h().forEach(function(e){o("create",e)}));var s=function(n){return void 0===n&&(n=t()),"function"!=typeof n[e]&&i("invalid-app-argument",{name:e}),n[e]()};return void 0!==r&&(0,c.deepExtend)(s,r),b[e]=s,d.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._getService.bind(this,e).apply(this,a?t:[])},s}function f(e){(0,c.deepExtend)(b,e)}function v(e,t){Object.keys(g).forEach(function(n){var r=m(e,n);null!==r&&_[r]&&_[r](t,e)})}function m(e,t){if("serverAuth"===t)return null;var n=t;e.options;return n}var y={},g={},_={},b={__esModule:!0,initializeApp:n,app:t,apps:null,Promise:s.PromiseImpl,SDK_VERSION:"4.3.0",INTERNAL:{registerService:p,createFirebaseNamespace:r,extendNamespace:f,createSubscribe:o.createSubscribe,ErrorFactory:a.ErrorFactory,removeApp:e,factories:g,useAsService:m,Promise:s.PromiseImpl,deepExtend:c.deepExtend}};return(0,c.patchProperty)(b,"default",b),Object.defineProperty(b,"apps",{get:h}),(0,c.patchProperty)(t,"App",d),b}function i(e,t){throw f.create(e,t)}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.createFirebaseNamespace=r;var o=n(741),a=n(743),s=n(77),c=n(264),l=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u="[DEFAULT]",h=[],d=function(){function e(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t,this.options_=(0,c.deepCopy)(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return s.PromiseImpl.resolve(null)},addAuthTokenListener:function(e){h.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){h=h.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new s.PromiseImpl(function(t){e.checkDestroyed_(),t()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);var t=[];return Object.keys(e.services_).forEach(function(n){Object.keys(e.services_[n]).forEach(function(r){t.push(e.services_[n][r])})}),s.PromiseImpl.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=u),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==u?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;(0,c.deepExtend)(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(h.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),h=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&i("app-deleted",{name:this.name_})},e}();d.prototype.name&&d.prototype.options||d.prototype.delete||console.log("dc");var p={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},f=new a.ErrorFactory("app","Firebase",p)},function(e,t,n){"use strict";function r(e,t){var n=new l(e,t);return n.subscribe.bind(n)}function i(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];c.PromiseImpl.resolve(!0).then(function(){e.apply(void 0,n)}).catch(function(e){t&&t(e)})}}function o(e,t){if("object"!==(void 0===e?"undefined":s(e))||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}function a(){}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.createSubscribe=r,t.async=i;var c=n(77),l=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=c.PromiseImpl.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=o(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=a),void 0===r.error&&(r.error=a),void 0===r.complete&&(r.complete=a);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),s},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}()},function(e,t,n){(function(t){!function(n){function r(){}function i(e,t){return function(){e.apply(t,arguments)}}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function a(e,t){for(;3===e._state;)e=e._value;if(0===e._state)return void e._deferreds.push(t);e._handled=!0,o._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?s:c)(t.promise,e._value);var r;try{r=n(e._value)}catch(e){return void c(t.promise,e)}s(t.promise,r)})}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void h(i(n,t),e)}e._state=1,e._value=t,l(e)}catch(t){c(e,t)}}function c(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function h(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}var d=setTimeout;o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(r);return a(this,new u(e,t,n)),n},o.all=function(e){var t=Array.prototype.slice.call(e);return new o(function(e,n){function r(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(o,e)},n)}t[o]=a,0==--i&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)r(o,t[o])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){d(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},void 0!==e&&e.exports?e.exports=o:n.Promise||(n.Promise=o)}(this)}).call(t,n(172).setImmediate)},function(e,t,n){"use strict";function r(e){var t=o;return o=e,t}/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.patchCapture=r;var i="FirebaseError",o=Error.captureStackTrace,a=function(){function e(e,t){this.code=e,this.message=t;if(o)o(this,s.prototype.create);else{var n=Error.apply(this,arguments);this.name=i,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}return e}();t.FirebaseError=a,a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.prototype.name=i;var s=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var n,r=this.errors[e],i=this.service+"/"+e;n=void 0===r?"Error":r.replace(this.pattern,function(e,n){var r=t[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new a(i,n);for(var s in t)t.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(o[s]=t[s]);return o},e}();t.ErrorFactory=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.base64=void 0;var r=n(263),i=function(e){for(var t=[],n=0,r=0;r<e.length;r++){for(var i=e.charCodeAt(r);i>255;)t[n++]=255&i,i>>=8;t[n++]=i}return t},o=function(e){if(e.length<8192)return String.fromCharCode.apply(null,e);for(var t="",n=0;n<e.length;n+=8192){var r=e.slice(n,n+8192);t+=String.fromCharCode.apply(null,r)}return t};t.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof r.globalScope.atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,u=o>>2,h=(3&o)<<4|s>>4,d=(15&s)<<2|l>>6,p=63&l;c||(p=64,a||(d=64)),r.push(n[u],n[h],n[d],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):o(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length,s=a?n[e.charAt(i)]:0;++i;var c=i<e.length,l=c?n[e.charAt(i)]:64;++i;var u=i<e.length,h=u?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==l||null==h)throw Error();var d=o<<2|s>>4;if(r.push(d),64!=l){var p=s<<4&240|l>>2;if(r.push(p),64!=h){var f=l<<6&192|h;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Sha1=void 0;var r=n(746),i=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(e){function t(){var t=e.call(this)||this;t.chain_=[],t.buf_=[],t.W_=[],t.pad_=[],t.inbuf_=0,t.total_=0,t.blockSize=64,t.pad_[0]=128;for(var n=1;n<t.blockSize;++n)t.pad_[n]=0;return t.reset(),t}return i(t,e),t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],c=this.chain_[1],l=this.chain_[2],u=this.chain_[3],h=this.chain_[4],r=0;r<80;r++){r<40?r<20?(o=u^c&(l^u),a=1518500249):(o=c^l^u,a=1859775393):r<60?(o=c&l|u&(c|l),a=2400959708):(o=c^l^u,a=3395469782);var i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=u,u=l,l=4294967295&(c<<30|c>>>2),c=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0==o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},t.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},t}(r.Hash);t.Sha1=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.blockSize=-1}return e}();t.Hash=r},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.DOMStorageWrapper=void 0;var r=n(42),i=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,r.stringify)(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,r.jsonEval)(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}();t.DOMStorageWrapper=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=void 0;var r=n(11),i=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return(0,r.contains)(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}();t.MemoryStorage=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.OnDisconnect=void 0;var r=n(68),i=n(69),o=n(7),a=n(77),s=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){(0,r.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),(0,r.validateCallback)("OnDisconnect.cancel",1,e,!0);var t=new a.Deferred;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){(0,r.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),(0,i.validateWritablePath)("OnDisconnect.remove",this.path_),(0,r.validateCallback)("OnDisconnect.remove",1,e,!0);var t=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){(0,r.validateArgCount)("OnDisconnect.set",1,2,arguments.length),(0,i.validateWritablePath)("OnDisconnect.set",this.path_),(0,i.validateFirebaseDataArg)("OnDisconnect.set",1,e,this.path_,!1),(0,r.validateCallback)("OnDisconnect.set",2,t,!0);var n=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},e.prototype.setWithPriority=function(e,t,n){(0,r.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,i.validateWritablePath)("OnDisconnect.setWithPriority",this.path_),(0,i.validateFirebaseDataArg)("OnDisconnect.setWithPriority",1,e,this.path_,!1),(0,i.validatePriority)("OnDisconnect.setWithPriority",2,t,!1),(0,r.validateCallback)("OnDisconnect.setWithPriority",3,n,!0);var o=new a.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,o.wrapCallback(n)),o.promise},e.prototype.update=function(e,t){if((0,r.validateArgCount)("OnDisconnect.update",1,2,arguments.length),(0,i.validateWritablePath)("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},s=0;s<e.length;++s)n[""+s]=e[s];e=n,(0,o.warn)("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,i.validateFirebaseMergeDataArg)("OnDisconnect.update",1,e,this.path_,!1),(0,r.validateCallback)("OnDisconnect.update",2,t,!0);var c=new a.Deferred;return this.repo_.onDisconnectUpdate(this.path_,e,c.wrapCallback(t)),c.promise},e}();t.OnDisconnect=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionResult=void 0;var r=n(68),i=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return(0,r.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();t.TransactionResult=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.nextPushId=void 0;var r=n(5);t.nextPushId=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,n=[];return function(i){var o=i===t;t=i;var a,s=new Array(8);for(a=7;a>=0;a--)s[a]=e.charAt(i%64),i=Math.floor(i/64);(0,r.assert)(0===i,"Cannot push at time == 0");var c=s.join("");if(o){for(a=11;a>=0&&63===n[a];a--)n[a]=0;n[a]++}else for(a=0;a<12;a++)n[a]=Math.floor(64*Math.random());for(a=0;a<12;a++)c+=e.charAt(n[a]);return(0,r.assert)(20===c.length,"nextPushId: Length should be 20."),c}}()},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ChildEventRegistration=t.ValueEventRegistration=void 0;var r=n(275),i=n(753),o=n(11),a=n(5),s=function(){function e(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new i.DataEvent("value",this,new r.DataSnapshot(e.snapshotNode,t.getRef(),n))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){(0,a.assert)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new i.CancelEvent(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}();t.ValueEventRegistration=s;var c=function(){function e(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,(0,o.contains)(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new i.CancelEvent(this,e,t):null},e.prototype.createEvent=function(e,t){(0,a.assert)(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),o=t.getQueryParams().getIndex();return new i.DataEvent(e.type,this,new r.DataSnapshot(e.snapshotNode,n,o),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){(0,a.assert)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var n=(0,o.getCount)(t.callbacks_);if(n===(0,o.getCount)(this.callbacks_)){if(1===n){var r=(0,o.getAnyKey)(t.callbacks_),i=(0,o.getAnyKey)(this.callbacks_);return!(i!==r||t.callbacks_[r]&&this.callbacks_[i]&&t.callbacks_[r]!==this.callbacks_[i])}return(0,o.every)(this.callbacks_,function(e,n){return t.callbacks_[e]===n})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}();t.ChildEventRegistration=c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.CancelEvent=t.DataEvent=void 0;var r=n(42),i=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,r.stringify)(this.snapshot.exportVal())},e}();t.DataEvent=i;var o=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}();t.CancelEvent=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.SyncTree=void 0;var r=n(5),i=n(7),o=n(755),a=n(30),s=n(11),c=n(178),l=n(756),u=n(757),h=n(70),d=n(279),p=n(16),f=n(280),v=n(763),m=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=c.ImmutableTree.Empty,this.pendingWriteTree_=new v.WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return e.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new d.Overwrite(h.OperationSource.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);var r=c.ImmutableTree.fromObject(t);return this.applyOperationToSyncPoints_(new u.Merge(h.OperationSource.User,e,r))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=c.ImmutableTree.Empty;return null!=n.snap?r=r.set(p.Path.Empty,!0):(0,s.forEach)(n.children,function(e,t){r=r.set(new p.Path(e),t)}),this.applyOperationToSyncPoints_(new o.AckUserWrite(n.path,r,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new d.Overwrite(h.OperationSource.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var n=c.ImmutableTree.fromObject(t);return this.applyOperationToSyncPoints_(new u.Merge(h.OperationSource.Server,e,n))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new l.ListenComplete(h.OperationSource.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,c=p.Path.relativePath(a,t),l=new d.Overwrite(h.OperationSource.forServerTaggedQuery(s),c,n);return this.applyTaggedOperation_(a,l)}return[]},e.prototype.applyTaggedQueryMerge=function(t,n,r){var i=this.queryKeyForTag_(r);if(i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,l=p.Path.relativePath(a,t),d=c.ImmutableTree.fromObject(n),f=new u.Merge(h.OperationSource.forServerTaggedQuery(s),l,d);return this.applyTaggedOperation_(a,f)}return[]},e.prototype.applyTaggedListenComplete=function(t,n){var r=this.queryKeyForTag_(n);if(r){var i=e.parseQueryKey_(r),o=i.path,a=i.queryId,s=p.Path.relativePath(o,t),c=new l.ListenComplete(h.OperationSource.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,c)}return[]},e.prototype.addEventRegistration=function(t,n){var i=t.path,o=null,s=!1;this.syncPointTree_.foreachOnPath(i,function(e,t){var n=p.Path.relativePath(e,i);o=o||t.getCompleteServerCache(n),s=s||t.hasCompleteView()});var c=this.syncPointTree_.get(i);c?(s=s||c.hasCompleteView(),o=o||c.getCompleteServerCache(p.Path.Empty)):(c=new f.SyncPoint,this.syncPointTree_=this.syncPointTree_.set(i,c));var l;if(null!=o)l=!0;else{l=!1,o=a.ChildrenNode.EMPTY_NODE;this.syncPointTree_.subtree(i).foreachChild(function(e,t){var n=t.getCompleteServerCache(p.Path.Empty);n&&(o=o.updateImmediateChild(e,n))})}var u=c.viewExistsForQuery(t);if(!u&&!t.getQueryParams().loadsAllData()){var h=e.makeQueryKey_(t);(0,r.assert)(!(h in this.queryToTagMap_),"View does not exist, but we have a tag");var d=e.getNextQueryTag_();this.queryToTagMap_[h]=d,this.tagToQueryMap_["_"+d]=h}var v=this.pendingWriteTree_.childWrites(i),m=c.addEventRegistration(t,n,v,o,l);if(!u&&!s){var y=c.viewForQuery(t);m=m.concat(this.setupListener_(t,y))}return m},e.prototype.removeEventRegistration=function(t,n,r){var i=this,o=t.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var c=a.removeEventRegistration(t,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var l=c.removed;s=c.events;var u=-1!==l.findIndex(function(e){return e.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(u&&!h){var d=this.syncPointTree_.subtree(o);if(!d.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(d),f=0;f<p.length;++f){var v=p[f],m=v.getQuery(),y=this.createListenerForView_(v);this.listenProvider_.startListening(e.queryForListening_(m),this.tagForQuery_(m),y.hashFn,y.onComplete)}}if(!h&&l.length>0&&!r)if(u){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else l.forEach(function(t){var n=i.queryToTagMap_[e.makeQueryKey_(t)];i.listenProvider_.stopListening(e.queryForListening_(t),n)});this.removeTags_(l)}return s},e.prototype.calcCompleteEventCache=function(e,t){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(e,function(t,n){var r=p.Path.relativePath(t,e),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(e,r,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView()){return[t.getCompleteView()]}var r=[];return t&&(r=t.getQueryViews()),(0,s.forEach)(n,function(e,t){r=r.concat(t)}),r})},e.prototype.removeTags_=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(!r.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,n){var i=t.path,o=this.tagForQuery_(t),a=this.createListenerForView_(n),c=this.listenProvider_.startListening(e.queryForListening_(t),o,a.hashFn,a.onComplete),l=this.syncPointTree_.subtree(i);if(o)(0,r.assert)(!l.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=l.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),(0,s.forEach)(n,function(e,t){r=r.concat(t)}),r}),h=0;h<u.length;++h){var d=u[h];this.listenProvider_.stopListening(e.queryForListening_(d),this.tagForQuery_(d))}return c},e.prototype.createListenerForView_=function(e){var t=this,n=e.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(e.getServerCache()||a.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);var o=(0,i.errorForServerCode)(e,n);return t.removeEventRegistration(n,null,o)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return(0,r.assert)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new p.Path(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap_["_"+e]},e.prototype.tagForQuery_=function(t){var n=e.makeQueryKey_(t);return(0,s.safeGet)(this.queryToTagMap_,n)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);(0,r.assert)(n,"Missing sync point for query tag that we're tracking");var i=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,i,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(p.Path.Empty))},e.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(p.Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(p.Path.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),c=t.children.get(a);if(c&&s){var l=n?n.getImmediateChild(a):null,u=r.child(a);o=o.concat(this.applyOperationHelper_(s,c,l,u))}return i&&(o=o.concat(i.applyOperation(e,r,n))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,n,r){var i=this,o=t.get(p.Path.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(p.Path.Empty));var a=[];return t.children.inorderTraversal(function(t,o){var s=n?n.getImmediateChild(t):null,c=r.child(t),l=e.operationForChild(t);l&&(a=a.concat(i.applyOperationDescendantsHelper_(l,o,s,c)))}),o&&(a=a.concat(o.applyOperation(e,r,n))),a},e.nextQueryTag_=1,e}();t.SyncTree=m},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.AckUserWrite=void 0;var r=n(5),i=n(16),o=n(70),a=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=o.OperationType.ACK_USER_WRITE,this.source=o.OperationSource.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return(0,r.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new i.Path(t));return new e(i.Path.Empty,n,this.revert)}return(0,r.assert)(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}();t.AckUserWrite=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ListenComplete=void 0;var r=n(16),i=n(70),o=function(){function e(e,t){this.source=e,this.path=t,this.type=i.OperationType.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,r.Path.Empty):new e(this.source,this.path.popFront())},e}();t.ListenComplete=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Merge=void 0;var r=n(70),i=n(279),o=n(16),a=n(5),s=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=r.OperationType.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var n=this.children.subtree(new o.Path(t));return n.isEmpty()?null:n.value?new i.Overwrite(this.source,o.Path.Empty,n.value):new e(this.source,o.Path.Empty,n)}return(0,a.assert)(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}();t.Merge=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var r=n(179),i=n(759),o=n(30),a=n(135),s=n(281),c=n(762),l=n(5),u=n(70),h=n(79),d=n(25),p=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),l=new r.IndexedFilter(n.getIndex()),u=n.getNodeFilter();this.processor_=new i.ViewProcessor(u);var h=t.getServerCache(),d=t.getEventCache(),p=l.updateFullNode(o.ChildrenNode.EMPTY_NODE,h.getNode(),null),f=u.updateFullNode(o.ChildrenNode.EMPTY_NODE,d.getNode(),null),v=new a.CacheNode(p,h.isFullyInitialized(),l.filtersNodes()),m=new a.CacheNode(f,d.isFullyInitialized(),u.filtersNodes());this.viewCache_=new s.ViewCache(m,v),this.eventGenerator_=new c.EventGenerator(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var n=[];if(t){(0,l.assert)(null==e,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,r);i&&n.push(i)})}if(e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},e.prototype.applyOperation=function(e,t,n){e.type===u.OperationType.MERGE&&null!==e.source.queryId&&((0,l.assert)(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),(0,l.assert)(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(i.viewCache),(0,l.assert)(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];if(!t.getNode().isLeafNode()){t.getNode().forEachChild(d.PRIORITY_INDEX,function(e,t){n.push(h.Change.childAddedChange(e,t))})}return t.isFullyInitialized()&&n.push(h.Change.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,r)},e}();t.View=p},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ViewProcessor=t.ProcessorResult=void 0;var r=n(70),i=n(5),o=n(760),a=n(79),s=n(30),c=n(100),l=n(178),u=n(16),h=n(761),d=function(){function e(e,t){this.viewCache=e,this.changes=t}return e}();t.ProcessorResult=d;var p=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){(0,i.assert)(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),(0,i.assert)(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,n,a,s){var c,l,u=new o.ChildChangeAccumulator;if(n.type===r.OperationType.OVERWRITE){var h=n;h.source.fromUser?c=this.applyUserOverwrite_(t,h.path,h.snap,a,s,u):((0,i.assert)(h.source.fromServer,"Unknown source."),l=h.source.tagged||t.getServerCache().isFiltered()&&!h.path.isEmpty(),c=this.applyServerOverwrite_(t,h.path,h.snap,a,s,l,u))}else if(n.type===r.OperationType.MERGE){var p=n;p.source.fromUser?c=this.applyUserMerge_(t,p.path,p.children,a,s,u):((0,i.assert)(p.source.fromServer,"Unknown source."),l=p.source.tagged||t.getServerCache().isFiltered(),c=this.applyServerMerge_(t,p.path,p.children,a,s,l,u))}else if(n.type===r.OperationType.ACK_USER_WRITE){var f=n;c=f.revert?this.revertUserWrite_(t,f.path,a,s,u):this.ackUserWrite_(t,f.path,f.affectedTree,a,s,u)}else{if(n.type!==r.OperationType.LISTEN_COMPLETE)throw(0,i.assertionError)("Unknown operation type: "+n.type);c=this.listenComplete_(t,n.path,a,u)}var v=u.getChanges();return e.maybeAddValueEvent_(t,c,v),new d(c,v)},e.maybeAddValueEvent_=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=e.getCompleteEventSnap();(n.length>0||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(a.Change.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,o){var a=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var c=void 0,l=void 0;if(t.isEmpty())if((0,i.assert)(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var u=e.getCompleteServerSnap(),h=u instanceof s.ChildrenNode?u:s.ChildrenNode.EMPTY_NODE,d=n.calcCompleteEventChildren(h);c=this.filter_.updateFullNode(e.getEventCache().getNode(),d,o)}else{var p=n.calcCompleteEventCache(e.getCompleteServerSnap());c=this.filter_.updateFullNode(e.getEventCache().getNode(),p,o)}else{var f=t.getFront();if(".priority"==f){(0,i.assert)(1==t.getLength(),"Can't have a priority with additional path components");var v=a.getNode();l=e.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(t,v,l);c=null!=m?this.filter_.updatePriority(v,m):a.getNode()}else{var y=t.popFront(),g=void 0;if(a.isCompleteForChild(f)){l=e.getServerCache().getNode();var _=n.calcEventCacheAfterServerOverwrite(t,a.getNode(),l);g=null!=_?a.getNode().getImmediateChild(f).updateChild(y,_):a.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,e.getServerCache());c=null!=g?this.filter_.updateChild(a.getNode(),f,g,y,r,o):a.getNode()}}return e.updateEventSnap(c,a.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s,c=e.getServerCache(),l=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=l.updateFullNode(c.getNode(),n,null);else if(l.filtersNodes()&&!c.isFiltered()){var u=c.getNode().updateChild(t,n);s=l.updateFullNode(c.getNode(),u,null)}else{var d=t.getFront();if(!c.isCompleteForPath(t)&&t.getLength()>1)return e;var p=t.popFront(),f=c.getNode().getImmediateChild(d),v=f.updateChild(p,n);s=".priority"==d?l.updatePriority(c.getNode(),v):l.updateChild(c.getNode(),d,v,p,h.NO_COMPLETE_CHILD_SOURCE,null)}var m=e.updateServerSnap(s,c.isFullyInitialized()||t.isEmpty(),l.filtersNodes()),y=new h.WriteTreeCompleteChildSource(r,m,i);return this.generateEventCacheAfterServerEvent_(m,t,r,y,a)},e.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a,c,l=e.getEventCache(),u=new h.WriteTreeCompleteChildSource(r,e,i);if(t.isEmpty())c=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),a=e.updateEventSnap(c,!0,this.filter_.filtersNodes());else{var d=t.getFront();if(".priority"===d)c=this.filter_.updatePriority(e.getEventCache().getNode(),n),a=e.updateEventSnap(c,l.isFullyInitialized(),l.isFiltered());else{var p=t.popFront(),f=l.getNode().getImmediateChild(d),v=void 0;if(p.isEmpty())v=n;else{var m=u.getCompleteChild(d);v=null!=m?".priority"===p.getBack()&&m.getChild(p.parent()).isEmpty()?m:m.updateChild(p,n):s.ChildrenNode.EMPTY_NODE}if(f.equals(v))a=e;else{var y=this.filter_.updateChild(l.getNode(),d,v,p,u,o);a=e.updateEventSnap(y,l.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,n,r,i,o,a){var s=this,c=t;return r.foreach(function(r,l){var u=n.child(r);e.cacheHasChild_(t,u.getFront())&&(c=s.applyUserOverwrite_(c,u,l,i,o,a))}),r.foreach(function(r,l){var u=n.child(r);e.cacheHasChild_(t,u.getFront())||(c=s.applyUserOverwrite_(c,u,l,i,o,a))}),c},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,n){e=e.updateChild(t,n)}),e},e.prototype.applyServerMerge_=function(e,t,n,r,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var c,h=e;c=t.isEmpty()?n:l.ImmutableTree.Empty.setTree(t,n);var d=e.getServerCache().getNode();return c.children.inorderTraversal(function(t,n){if(d.hasChild(t)){var c=e.getServerCache().getNode().getImmediateChild(t),l=s.applyMerge_(c,n);h=s.applyServerOverwrite_(h,new u.Path(t),l,r,i,o,a)}}),c.children.inorderTraversal(function(t,n){var c=!e.getServerCache().isCompleteForChild(t)&&null==n.value;if(!d.hasChild(t)&&!c){var l=e.getServerCache().getNode().getImmediateChild(t),p=s.applyMerge_(l,n);h=s.applyServerOverwrite_(h,new u.Path(t),p,r,i,o,a)}}),h},e.prototype.ackUserWrite_=function(e,t,n,r,i,o){if(null!=r.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=n.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),r,i,a,o);if(t.isEmpty()){var h=l.ImmutableTree.Empty;return s.getNode().forEachChild(c.KEY_INDEX,function(e,t){h=h.set(new u.Path(e),t)}),this.applyServerMerge_(e,t,h,r,i,a,o)}return e}var d=l.ImmutableTree.Empty;return n.foreach(function(e,n){var r=t.child(e);s.isCompleteForPath(r)&&(d=d.set(e,s.getNode().getChild(r)))}),this.applyServerMerge_(e,t,d,r,i,a,o)},e.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,n,h.NO_COMPLETE_CHILD_SOURCE,r)},e.prototype.revertUserWrite_=function(e,t,n,r,o){var a;if(null!=n.shadowingWrite(t))return e;var c=new h.WriteTreeCompleteChildSource(n,e,r),l=e.getEventCache().getNode(),d=void 0;if(t.isEmpty()||".priority"===t.getFront()){var p=void 0;if(e.getServerCache().isFullyInitialized())p=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var f=e.getServerCache().getNode();(0,i.assert)(f instanceof s.ChildrenNode,"serverChildren would be complete if leaf node"),p=n.calcCompleteEventChildren(f)}p=p,d=this.filter_.updateFullNode(l,p,o)}else{var v=t.getFront(),m=n.calcCompleteChild(v,e.getServerCache());null==m&&e.getServerCache().isCompleteForChild(v)&&(m=l.getImmediateChild(v)),d=null!=m?this.filter_.updateChild(l,v,m,t.popFront(),c,o):e.getEventCache().getNode().hasChild(v)?this.filter_.updateChild(l,v,s.ChildrenNode.EMPTY_NODE,t.popFront(),c,o):l,d.isEmpty()&&e.getServerCache().isFullyInitialized()&&(a=n.calcCompleteEventCache(e.getCompleteServerSnap()),a.isLeafNode()&&(d=this.filter_.updateFullNode(d,a,o)))}return a=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(u.Path.Empty),e.updateEventSnap(d,a,this.filter_.filtersNodes())},e}();t.ViewProcessor=p},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ChildChangeAccumulator=void 0;var r=n(11),i=n(79),o=n(5),a=function(){function e(){this.changeMap_={}}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;(0,o.assert)(t==i.Change.CHILD_ADDED||t==i.Change.CHILD_CHANGED||t==i.Change.CHILD_REMOVED,"Only child changes supported for tracking"),(0,o.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var a=(0,r.safeGet)(this.changeMap_,n);if(a){var s=a.type;if(t==i.Change.CHILD_ADDED&&s==i.Change.CHILD_REMOVED)this.changeMap_[n]=i.Change.childChangedChange(n,e.snapshotNode,a.snapshotNode);else if(t==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_ADDED)delete this.changeMap_[n];else if(t==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_CHANGED)this.changeMap_[n]=i.Change.childRemovedChange(n,a.oldSnap);else if(t==i.Change.CHILD_CHANGED&&s==i.Change.CHILD_ADDED)this.changeMap_[n]=i.Change.childAddedChange(n,e.snapshotNode);else{if(t!=i.Change.CHILD_CHANGED||s!=i.Change.CHILD_CHANGED)throw(0,o.assertionError)("Illegal combination of changes: "+e+" occurred after "+a);this.changeMap_[n]=i.Change.childChangedChange(n,e.snapshotNode,a.oldSnap)}}else this.changeMap_[n]=e},e.prototype.getChanges=function(){return(0,r.getValues)(this.changeMap_)},e}();t.ChildChangeAccumulator=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.WriteTreeCompleteChildSource=t.NO_COMPLETE_CHILD_SOURCE=t.NoCompleteChildSource_=void 0;var r=n(135),i=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}();t.NoCompleteChildSource_=i;var o=(t.NO_COMPLETE_CHILD_SOURCE=new i,function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new r.CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]},e}());t.WriteTreeCompleteChildSource=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.EventGenerator=void 0;var r=n(33),i=n(79),o=n(5),a=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,n){var r=this,o=[],a=[];return e.forEach(function(e){e.type===i.Change.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&a.push(i.Change.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(o,i.Change.CHILD_REMOVED,e,n,t),this.generateEventsForType_(o,i.Change.CHILD_ADDED,e,n,t),this.generateEventsForType_(o,i.Change.CHILD_MOVED,a,n,t),this.generateEventsForType_(o,i.Change.CHILD_CHANGED,e,n,t),this.generateEventsForType_(o,i.Change.VALUE,e,n,t),o},e.prototype.generateEventsForType_=function(e,t,n,r,i){var o=this,a=n.filter(function(e){return e.type===t});a.sort(this.compareChanges_.bind(this)),a.forEach(function(t){var n=o.materializeSingleChange_(t,i);r.forEach(function(r){r.respondsTo(t.type)&&e.push(r.createEvent(n,o.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw(0,o.assertionError)("Should only compare child_ events.");var n=new r.NamedNode(e.childName,e.snapshotNode),i=new r.NamedNode(t.childName,t.snapshotNode);return this.index_.compare(n,i)},e}();t.EventGenerator=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.WriteTreeRef=t.WriteTree=void 0;var r=n(11),i=n(5),o=n(16),a=n(764),s=n(25),c=n(30),l=function(){function e(){this.visibleWrites_=a.CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new u(e,this)},e.prototype.addOverwrite=function(e,t,n,r){(0,i.assert)(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},e.prototype.addMerge=function(e,t,n){(0,i.assert)(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},e.prototype.removeWrite=function(e){var t=this,n=this.allWrites_.findIndex(function(t){return t.writeId===e});(0,i.assert)(n>=0,"removeWrite called with nonexistent writeId.");var o=this.allWrites_[n];this.allWrites_.splice(n,1);for(var a=o.visible,s=!1,c=this.allWrites_.length-1;a&&c>=0;){var l=this.allWrites_[c];l.visible&&(c>=n&&this.recordContainsPath_(l,o.path)?a=!1:o.path.contains(l.path)&&(s=!0)),c--}if(a){if(s)return this.resetTree_(),!0;if(o.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(o.path);else{var u=o.children;(0,r.forEach)(u,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(o.path.child(e))})}return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,n,r,i){if(r||i){var a=this.visibleWrites_.childCompoundWrite(t);if(!i&&a.isEmpty())return n;if(i||null!=n||a.hasCompleteWrite(o.Path.Empty)){var s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},l=e.layerTree_(this.allWrites_,s,t),u=n||c.ChildrenNode.EMPTY_NODE;return l.apply(u)}return null}var h=this.visibleWrites_.getCompleteNode(t);if(null!=h)return h;var d=this.visibleWrites_.childCompoundWrite(t);if(d.isEmpty())return n;if(null!=n||d.hasCompleteWrite(o.Path.Empty)){var u=n||c.ChildrenNode.EMPTY_NODE;return d.apply(u)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var n=c.ChildrenNode.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(s.PRIORITY_INDEX,function(e,t){n=n.updateImmediateChild(e,t)}),n;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(s.PRIORITY_INDEX,function(e,t){var r=i.childCompoundWrite(new o.Path(e)).apply(t);n=n.updateImmediateChild(e,r)}),i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){(0,i.assert)(n||r,"Either existingEventSnap or existingServerSnap must exist");var o=e.child(t);if(this.visibleWrites_.hasCompleteWrite(o))return null;var a=this.visibleWrites_.childCompoundWrite(o);return a.isEmpty()?r.getChild(t):a.apply(r.getChild(t))},e.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),i=this.visibleWrites_.getCompleteNode(r);if(null!=i)return i;if(n.isCompleteForChild(t)){return this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t))}return null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,n,r,i,a){var s,c=this.visibleWrites_.childCompoundWrite(e),l=c.getCompleteNode(o.Path.Empty);if(null!=l)s=l;else{if(null==t)return[];s=c.apply(t)}if(s=s.withIndex(a),s.isEmpty()||s.isLeafNode())return[];for(var u=[],h=a.getCompare(),d=i?s.getReverseIteratorFrom(n,a):s.getIteratorFrom(n,a),p=d.getNext();p&&u.length<r;)0!==h(p,n)&&u.push(p),p=d.getNext();return u},e.prototype.recordContainsPath_=function(e,t){return e.snap?e.path.contains(t):!!(0,r.findKey)(e.children,function(n,r){return e.path.child(r).contains(t)})},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,o.Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,n){for(var s=a.CompoundWrite.Empty,c=0;c<e.length;++c){var l=e[c];if(t(l)){var u=l.path,h=void 0;if(l.snap)n.contains(u)?(h=o.Path.relativePath(n,u),s=s.addWrite(h,l.snap)):u.contains(n)&&(h=o.Path.relativePath(u,n),s=s.addWrite(o.Path.Empty,l.snap.getChild(h)));else{if(!l.children)throw(0,i.assertionError)("WriteRecord should have .snap or .children");if(n.contains(u))h=o.Path.relativePath(n,u),s=s.addWrites(h,l.children);else if(u.contains(n))if(h=o.Path.relativePath(u,n),h.isEmpty())s=s.addWrites(o.Path.Empty,l.children);else{var d=(0,r.safeGet)(l.children,h.getFront());if(d){var p=d.getChild(h.popFront());s=s.addWrite(o.Path.Empty,p)}}}}}return s},e}();t.WriteTree=l;var u=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}();t.WriteTreeRef=u},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.CompoundWrite=void 0;var r=n(178),i=n(16),o=n(11),a=n(33),s=n(25),c=n(5),l=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,n){if(t.isEmpty())return new e(new r.ImmutableTree(n));var o=this.writeTree_.findRootMostValueAndPath(t);if(null!=o){var a=o.path,s=o.value,c=i.Path.relativePath(a,t);return s=s.updateChild(c,n),new e(this.writeTree_.set(a,s))}var l=new r.ImmutableTree(n);return new e(this.writeTree_.setTree(t,l))},e.prototype.addWrites=function(e,t){var n=this;return(0,o.forEach)(t,function(t,r){n=n.addWrite(e.child(t),r)}),n},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,r.ImmutableTree.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(i.Path.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(s.PRIORITY_INDEX,function(t,n){e.push(new a.NamedNode(t,n))}):this.writeTree_.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new a.NamedNode(t,n.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var n=this.getCompleteNode(t);return new e(null!=n?new r.ImmutableTree(n):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(t){return e.applySubtreeWrite_(i.Path.Empty,this.writeTree_,t)},e.Empty=new e(new r.ImmutableTree(null)),e.applySubtreeWrite_=function(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?((0,c.assert)(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e.applySubtreeWrite_(t.child(n),o,r)}),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(t.child(".priority"),i)),r},e}();t.CompoundWrite=l},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.SnapshotHolder=void 0;var r=n(30),i=function(){function e(){this.rootNode_=r.ChildrenNode.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();t.SnapshotHolder=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.AuthTokenProvider=void 0;var r=n(7),i=function(){function e(e){this.app_=e}return e.prototype.getToken=function(e){return this.app_.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?((0,r.log)("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.app_.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.app_.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',(0,r.warn)(e)},e}();t.AuthTokenProvider=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.StatsCollection=void 0;var r=n(264),i=n(11),o=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),(0,i.contains)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return(0,r.deepCopy)(this.counters_)},e}();t.StatsCollection=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.StatsReporter=void 0;var r=n(11),i=n(7),o=n(282),a=1e4,s=3e4,c=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new o.StatsListener(e);var n=a+(s-a)*Math.random();(0,i.setTimeoutNonBlocking)(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},o=!1;(0,r.forEach)(t,function(t,i){i>0&&(0,r.contains)(e.statsToReport_,t)&&(n[t]=i,o=!0)}),o&&this.server_.reportStats(n),(0,i.setTimeoutNonBlocking)(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}();t.StatsReporter=c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.EventList=t.EventQueue=void 0;var r=n(7),i=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new o(i)),t.add(r)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r){e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1}}t&&(this.eventLists_=[]),this.recursionDepth_--},e}();t.EventQueue=i;var o=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var n=t.getEventRunner();r.logger&&(0,r.log)("event: "+t.toString()),(0,r.exceptionGuard)(n)}}},e.prototype.getPath=function(){return this.path_},e}();t.EventList=o},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.VisibilityMonitor=void 0;var r=n(284),i=n(5),o=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))},!1),r}return o(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return(0,i.assert)("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(r.EventEmitter);t.VisibilityMonitor=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineMonitor=void 0;var r=n(5),i=n(284),o=n(78),a=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.isMobileCordova)()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return a(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return(0,r.assert)("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(i.EventEmitter);t.OnlineMonitor=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.isAdmin=t.isValidFormat=t.issuedAtTime=t.isValidTimestamp=t.decode=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(7),o=n(42),a=t.decode=function(e){var t={},n={},r={},a="";try{var s=e.split(".");t=(0,o.jsonEval)((0,i.base64Decode)(s[0])||""),n=(0,o.jsonEval)((0,i.base64Decode)(s[1])||""),a=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:a}};t.isValidTimestamp=function(e){var t,n,i=a(e).claims,o=Math.floor((new Date).getTime()/1e3);return"object"===(void 0===i?"undefined":r(i))&&(i.hasOwnProperty("nbf")?t=i.nbf:i.hasOwnProperty("iat")&&(t=i.iat),n=i.hasOwnProperty("exp")?i.exp:t+86400),o&&t&&n&&o>=t&&o<=n},t.issuedAtTime=function(e){var t=a(e).claims;return"object"===(void 0===t?"undefined":r(t))&&t.hasOwnProperty("iat")?t.iat:null},t.isValidFormat=function(e){var t=a(e),n=t.claims;return!!t.signature&&!!n&&"object"===(void 0===n?"undefined":r(n))&&n.hasOwnProperty("iat")},t.isAdmin=function(e){var t=a(e).claims;return"object"===(void 0===t?"undefined":r(t))&&!0===t.admin}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.TransportManager=void 0;var r=n(286),i=n(287),o=n(7),a=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[r.BrowserPollConnection,i.WebSocketConnection]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var n=i.WebSocketConnection&&i.WebSocketConnection.isAvailable(),r=n&&!i.WebSocketConnection.previouslyFailed();if(t.webSocketOnly&&(n||(0,o.warn)("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[i.WebSocketConnection];else{var a=this.transports_=[];(0,o.each)(e.ALL_TRANSPORTS,function(e,t){t&&t.isAvailable()&&a.push(t)})}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}();t.TransportManager=a},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.PacketReceiver=void 0;var r=n(7),i=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var i=this;this.pendingResponses[this.currentResponseNum];){if("break"===function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=0;t<e.length;++t)!function(t){e[t]&&(0,r.exceptionGuard)(function(){n.onMessage_(e[t])})}(t);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++}())break}},e}();t.PacketReceiver=i},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.ReadonlyRestClient=void 0;var r=n(5),i=n(7),o=n(42),a=n(11),s=n(776),c=n(288),l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(e){function t(t,n,r){var o=e.call(this)||this;return o.repoInfo_=t,o.onDataUpdate_=n,o.authTokenProvider_=r,o.log_=(0,i.logWrapper)("p:rest:"),o.listens_={},o}return l(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:((0,r.assert)(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,s=e.path.toString();this.log_("Listen called for "+s+" "+e.queryIdentifier());var c=t.getListenId_(e,r),l={};this.listens_[c]=l;var u=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",u,function(e,t){var n=t;if(404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(s,n,!1,r),(0,a.safeGet)(o.listens_,c)===l){var u;u=e?401==e?"permission_denied":"rest_error:"+e:"ok",i(u,null)}})},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(a){var c=a&&a.accessToken;c&&(t.auth=c);var l=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?"+(0,s.querystring)(t);r.log_("Sending REST request for "+l);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+l+" received. status:",u.status,"response:",u.responseText);var e=null;if(u.status>=200&&u.status<300){try{e=(0,o.jsonEval)(u.responseText)}catch(e){(0,i.warn)("Failed to parse JSON response for "+l+": "+u.responseText)}n(null,e)}else 401!==u.status&&404!==u.status&&(0,i.warn)("Got unsuccessful REST response for "+l+" Status: "+u.status),n(u.status);n=null}},u.open("GET",l,!0),u.send()})},t}(c.ServerActions);t.ReadonlyRestClient=u},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.querystringDecode=t.querystring=void 0;var r=n(11);t.querystring=function(e){var t=[];return(0,r.forEach)(e,function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}}),t}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.QueryParams=void 0;var r=n(5),i=n(7),o=n(100),a=n(25),s=n(270),c=n(274),l=n(179),u=n(778),h=n(289),d=n(42),p=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=a.PRIORITY_INDEX}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return(0,r.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return(0,r.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:i.MIN_NAME},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return(0,r.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return(0,r.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:i.MAX_NAME},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return(0,r.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},e.prototype.limitToLast=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},e.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},e.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[t.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=r}return this.index_!==a.PRIORITY_INDEX&&(n[t.INDEX]=this.index_.toString()),n},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==a.PRIORITY_INDEX},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new l.IndexedFilter(this.getIndex()):this.hasLimit()?new u.LimitedFilter(this):new h.RangedFilter(this)},e.prototype.toRestQueryStringParameters=function(){var t=e.REST_QUERY_CONSTANTS_,n={};if(this.isDefault())return n;var i;return this.index_===a.PRIORITY_INDEX?i=t.PRIORITY_INDEX:this.index_===s.VALUE_INDEX?i=t.VALUE_INDEX:this.index_===o.KEY_INDEX?i=t.KEY_INDEX:((0,r.assert)(this.index_ instanceof c.PathIndex,"Unrecognized index type!"),i=this.index_.toString()),n[t.ORDER_BY]=(0,d.stringify)(i),this.startSet_&&(n[t.START_AT]=(0,d.stringify)(this.indexStartValue_),this.startNameSet_&&(n[t.START_AT]+=","+(0,d.stringify)(this.indexStartName_))),this.endSet_&&(n[t.END_AT]=(0,d.stringify)(this.indexEndValue_),this.endNameSet_&&(n[t.END_AT]+=","+(0,d.stringify)(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.limit_:n[t.LIMIT_TO_LAST]=this.limit_),n},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}();t.QueryParams=p},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.LimitedFilter=void 0;var r=n(289),i=n(30),o=n(33),a=n(5),s=n(79),c=function(){function e(e){this.rangedFilter_=new r.RangedFilter(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,a,s){return this.rangedFilter_.matches(new o.NamedNode(t,n))||(n=i.ChildrenNode.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,a,s):this.fullLimitUpdateChild_(e,t,n,a,s)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=i.ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=i.ChildrenNode.EMPTY_NODE.withIndex(this.index_);var o=void 0;o=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;o.hasNext()&&a<this.limit_;){var s=o.getNext(),c=void 0;if(!(c=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),a++}}else{r=t.withIndex(this.index_),r=r.updatePriority(i.ChildrenNode.EMPTY_NODE);var l=void 0,u=void 0,h=void 0,o=void 0;if(this.reverse_){o=r.getReverseIterator(this.index_),l=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var d=this.index_.getCompare();h=function(e,t){return d(t,e)}}else o=r.getIterator(this.index_),l=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();for(var a=0,p=!1;o.hasNext();){var s=o.getNext();!p&&h(l,s)<=0&&(p=!0);var c=p&&a<this.limit_&&h(s,u)<=0;c?a++:r=r.updateImmediateChild(s.name,i.ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,c){var l;if(this.reverse_){var u=this.index_.getCompare();l=function(e,t){return u(t,e)}}else l=this.index_.getCompare();var h=e;(0,a.assert)(h.numChildren()==this.limit_,"");var d=new o.NamedNode(t,n),p=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),f=this.rangedFilter_.matches(d);if(h.hasChild(t)){for(var v=h.getImmediateChild(t),m=r.getChildAfterChild(this.index_,p,this.reverse_);null!=m&&(m.name==t||h.hasChild(m.name));)m=r.getChildAfterChild(this.index_,m,this.reverse_);var y=null==m?1:l(m,d);if(f&&!n.isEmpty()&&y>=0)return null!=c&&c.trackChildChange(s.Change.childChangedChange(t,n,v)),h.updateImmediateChild(t,n);null!=c&&c.trackChildChange(s.Change.childRemovedChange(t,v));var g=h.updateImmediateChild(t,i.ChildrenNode.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(null!=c&&c.trackChildChange(s.Change.childAddedChange(m.name,m.node)),g.updateImmediateChild(m.name,m.node)):g}return n.isEmpty()?e:f&&l(p,d)>=0?(null!=c&&(c.trackChildChange(s.Change.childRemovedChange(p.name,p.node)),c.trackChildChange(s.Change.childAddedChange(t,n))),h.updateImmediateChild(t,n).updateImmediateChild(p.name,i.ChildrenNode.EMPTY_NODE)):e},e}();t.LimitedFilter=c},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionStatus=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(5),o=n(176),a=n(275),s=n(16),c=n(780),l=n(25),u=n(7),h=n(276),d=n(69),p=n(11),f=n(101),v=n(30),m=n(134),y=t.TransactionStatus=void 0;!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(y||(t.TransactionStatus=y={})),m.Repo.MAX_TRANSACTION_RETRIES_=25,m.Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new c.Tree},m.Repo.prototype.startTransaction=function(e,t,n,s){this.log_("transaction on "+e);var c=function(){},m=new o.Reference(this,e);m.on("value",c);var g=function(){m.off("value",c)},_={path:e,update:t,onComplete:n,status:null,order:(0,u.LUIDGenerator)(),applyLocally:s,retryCount:0,unwatcher:g,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},b=this.getLatestState_(e);_.currentInputSnapshot=b;var S=_.update(b.val());if(void 0===S){if(_.unwatcher(),_.currentOutputSnapshotRaw=null,_.currentOutputSnapshotResolved=null,_.onComplete){var w=new a.DataSnapshot(_.currentInputSnapshot,new o.Reference(this,_.path),l.PRIORITY_INDEX);_.onComplete(null,!1,w)}}else{(0,d.validateFirebaseData)("transaction failed: Data returned ",S,_.path),_.status=y.RUN;var E=this.transactionQueueTree_.subTree(e),C=E.getValue()||[];C.push(_),E.setValue(C);var x=void 0;if("object"===(void 0===S?"undefined":r(S))&&null!==S&&(0,p.contains)(S,".priority"))x=(0,p.safeGet)(S,".priority"),(0,i.assert)((0,d.isValidPriority)(x),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{x=(this.serverSyncTree_.calcCompleteEventCache(e)||v.ChildrenNode.EMPTY_NODE).getPriority().val()}x=x;var T=this.generateServerValues(),P=(0,f.nodeFromJSON)(S,x),O=(0,h.resolveDeferredValueSnapshot)(P,T);_.currentOutputSnapshotRaw=P,_.currentOutputSnapshotResolved=O,_.currentWriteId=this.getNextWriteId_();var A=this.serverSyncTree_.applyUserOverwrite(e,O,_.currentWriteId,_.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,A),this.sendReadyTransactions_()}},m.Repo.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||v.ChildrenNode.EMPTY_NODE},m.Repo.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var n=this.buildTransactionQueue_(e);(0,i.assert)(n.length>0,"Sending zero length transaction queue");n.every(function(e){return e.status===y.RUN})&&this.sendTransactionQueue_(e.path(),n)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},m.Repo.prototype.sendTransactionQueue_=function(e,t){for(var n=this,r=t.map(function(e){return e.currentWriteId}),c=this.getLatestState_(e,r),h=c,d=c.hash(),p=0;p<t.length;p++){var f=t[p];(0,i.assert)(f.status===y.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=y.SENT,f.retryCount++;var v=s.Path.relativePath(e,f.path);h=h.updateChild(v,f.currentOutputSnapshotRaw)}var m=h.val(!0),g=e;this.server_.put(g.toString(),m,function(r){n.log_("transaction put response",{path:g.toString(),status:r});var i=[];if("ok"===r){for(var s=[],c=0;c<t.length;c++){if(t[c].status=y.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(t[c].currentWriteId)),t[c].onComplete){var h=t[c].currentOutputSnapshotResolved,d=new o.Reference(n,t[c].path),p=new a.DataSnapshot(h,d,l.PRIORITY_INDEX);s.push(t[c].onComplete.bind(null,null,!0,p))}t[c].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(e)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(e,i);for(var c=0;c<s.length;c++)(0,u.exceptionGuard)(s[c])}else{if("datastale"===r)for(var c=0;c<t.length;c++)t[c].status===y.SENT_NEEDS_ABORT?t[c].status=y.NEEDS_ABORT:t[c].status=y.RUN;else{(0,u.warn)("transaction at "+g.toString()+" failed: "+r);for(var c=0;c<t.length;c++)t[c].status=y.NEEDS_ABORT,t[c].abortReason=r}n.rerunTransactions_(e)}},d)},m.Repo.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),n=t.path(),r=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(r,n),n},m.Repo.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n=[],c=[],v=e.filter(function(e){return e.status===y.RUN}),g=v.map(function(e){return e.currentWriteId}),_=0;_<e.length;_++){var b=e[_],S=s.Path.relativePath(t,b.path),w=!1,E=void 0;if((0,i.assert)(null!==S,"rerunTransactionsUnderNode_: relativePath should not be null."),b.status===y.NEEDS_ABORT)w=!0,E=b.abortReason,c=c.concat(this.serverSyncTree_.ackUserWrite(b.currentWriteId,!0));else if(b.status===y.RUN)if(b.retryCount>=m.Repo.MAX_TRANSACTION_RETRIES_)w=!0,E="maxretry",c=c.concat(this.serverSyncTree_.ackUserWrite(b.currentWriteId,!0));else{var C=this.getLatestState_(b.path,g);b.currentInputSnapshot=C;var x=e[_].update(C.val());if(void 0!==x){(0,d.validateFirebaseData)("transaction failed: Data returned ",x,b.path);var T=(0,f.nodeFromJSON)(x),P="object"===(void 0===x?"undefined":r(x))&&null!=x&&(0,p.contains)(x,".priority");P||(T=T.updatePriority(C.getPriority()));var O=b.currentWriteId,A=this.generateServerValues(),M=(0,h.resolveDeferredValueSnapshot)(T,A);b.currentOutputSnapshotRaw=T,b.currentOutputSnapshotResolved=M,b.currentWriteId=this.getNextWriteId_(),g.splice(g.indexOf(O),1),c=c.concat(this.serverSyncTree_.applyUserOverwrite(b.path,M,b.currentWriteId,b.applyLocally)),c=c.concat(this.serverSyncTree_.ackUserWrite(O,!0))}else w=!0,E="nodata",c=c.concat(this.serverSyncTree_.ackUserWrite(b.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,c),c=[],w&&(e[_].status=y.COMPLETED,function(e){setTimeout(e,Math.floor(0))}(e[_].unwatcher),e[_].onComplete))if("nodata"===E){var R=new o.Reference(this,e[_].path),I=e[_].currentInputSnapshot,N=new a.DataSnapshot(I,R,l.PRIORITY_INDEX);n.push(e[_].onComplete.bind(null,null,!1,N))}else n.push(e[_].onComplete.bind(null,new Error(E),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var _=0;_<n.length;_++)(0,u.exceptionGuard)(n[_]);this.sendReadyTransactions_()}},m.Repo.prototype.getAncestorTransactionNode_=function(e){for(var t,n=this.transactionQueueTree_;null!==(t=e.getFront())&&null===n.getValue();)n=n.subTree(t),e=e.popFront();return n},m.Repo.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},m.Repo.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})},m.Repo.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==y.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(n.length>0?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},m.Repo.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path(),r=this.transactionQueueTree_.subTree(e);return r.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),n},m.Repo.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],o=-1,a=0;a<t.length;a++)if(t[a].status===y.SENT_NEEDS_ABORT);else if(t[a].status===y.SENT)(0,i.assert)(o===a-1,"All SENT items should be at beginning of queue."),o=a,t[a].status=y.SENT_NEEDS_ABORT,t[a].abortReason="set";else if((0,i.assert)(t[a].status===y.RUN,"Unexpected transaction status in abort"),t[a].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[a].currentWriteId,!0)),t[a].onComplete){n.push(t[a].onComplete.bind(null,new Error("set"),!1,null))}-1===o?e.setValue(null):t.length=o+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r);for(var a=0;a<n.length;a++)(0,u.exceptionGuard)(n[a])}}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.Tree=t.TreeNode=void 0;var r=n(5),i=n(16),o=n(11),a=function(){function e(){this.children={},this.childCount=0,this.value=null}return e}();t.TreeNode=a;var s=function(){function e(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new a),this.name_=e,this.parent_=t,this.node_=n}return e.prototype.subTree=function(t){for(var n,r=t instanceof i.Path?t:new i.Path(t),s=this;null!==(n=r.getFront());){s=new e(n,s,(0,o.safeGet)(s.node_.children,n)||new a),r=r.popFront()}return s},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){(0,r.assert)(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var n=this;(0,o.forEach)(this.node_.children,function(r,i){t(new e(r,n,i))})},e.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,n)}),t&&n&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new i.Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=(0,o.contains)(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();t.Tree=s},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.interceptServerData=t.dataUpdateCount=t.statsIncrementCounter=t.stats=t.setSecurityDebugCallback=t.isWebSocketsAvailable=t.forceWebSockets=t.forceLongPolling=void 0;var r=n(287),i=n(286);t.forceLongPolling=function(){r.WebSocketConnection.forceDisallow(),i.BrowserPollConnection.forceAllow()},t.forceWebSockets=function(){i.BrowserPollConnection.forceDisallow()},t.isWebSocketsAvailable=function(){return r.WebSocketConnection.isAvailable()},t.setSecurityDebugCallback=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},t.stats=function(e,t){e.repo.stats(t)},t.statsIncrementCounter=function(e,t){e.repo.statsIncrementCounter(t)},t.dataUpdateCount=function(e){return e.repo.dataUpdateCount},t.interceptServerData=function(e,t){return e.repo.interceptServerData_(t)}},function(e,t,n){"use strict";/*! @license Firebase v4.3.0
Build: rev-bd8265e
Terms: https://firebase.google.com/terms/ */
Object.defineProperty(t,"__esModule",{value:!0}),t.forceRestClient=t.listens=t.queryIdentifier=t.ConnectionTarget=t.hijackHash=t.RealTimeConnection=t.DataConnection=void 0;var r=n(267),i=n(283),o=n(181),a=n(285);t.DataConnection=i.PersistentConnection;i.PersistentConnection.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},i.PersistentConnection.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};t.RealTimeConnection=a.Connection,t.hijackHash=function(e){var t=i.PersistentConnection.prototype.put;return i.PersistentConnection.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){i.PersistentConnection.prototype.put=t}},t.ConnectionTarget=r.RepoInfo,t.queryIdentifier=function(e){return e.queryIdentifier()},t.listens=function(e){return e.repo.persistentConnection_.listens_},t.forceRestClient=function(e){o.RepoManager.getInstance().forceRestClient(e)}},function(e,t,n){"use strict";var r=n(784);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),n.d(t,"c",function(){return r.c}),n.d(t,"d",function(){return r.d}),n.d(t,"e",function(){return r.e}),n.d(t,"f",function(){return r.f})},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"d",function(){return a});var r=n(290),i=n(9),o=n(171);n.n(o);n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.b});var a=new i.InjectionToken("FirebaseAppName"),s={provide:r.a,useFactory:r.c,deps:[r.b,a]},c=function(){function e(){}return e.initializeApp=function(t,n){return{ngModule:e,providers:[{provide:r.b,useValue:t},{provide:a,useValue:n}]}},e.decorators=[{type:i.NgModule,args:[{providers:[s]}]}],e.ctorParameters=function(){return[]},e}(),l=function(){function e(e){this.zone=e}return e.prototype.schedule=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.zone.run(function(){return o.queue.schedule.apply(o.queue,e)})},e}()},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r;!function(e){e[e.Child=0]="Child",e[e.Key=1]="Key",e[e.Value=2]="Value",e[e.Priority=3]="Priority"}(r||(r={}));var i;!function(e){e[e.First=0]="First",e[e.Last=1]="Last"}(i||(i={}));var o;!function(e){e[e.EqualTo=0]="EqualTo",e[e.StartAt=1]="StartAt",e[e.EndAt=2]="EndAt"}(o||(o={}))},function(e,t,n){"use strict";function r(e){return new s.a(e)}t.d=r,n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u});var i=n(9),o=n(76),a=(n.n(o),n(102)),s=n(262),c={provide:s.a,useFactory:r,deps:[a.FirebaseApp]},l=[c],u=function(){function e(){}return e.decorators=[{type:i.NgModule,args:[{imports:[a.AngularFireModule],providers:[l]}]}],e.ctorParameters=function(){return[]},e}()},function(e,t,n){!function(r,i,o){e.exports=t=i(n(80),n(298))}(0,function(e){return function(){function t(){return a.create.apply(a,arguments)}var n=e,r=n.lib,i=r.Hasher,o=n.x64,a=o.Word,s=o.WordArray,c=n.algo,l=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=t()}();var h=c.SHA512=i.extend({_doReset:function(){this._hash=new s.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],h=n[6],d=n[7],p=r.high,f=r.low,v=i.high,m=i.low,y=o.high,g=o.low,_=a.high,b=a.low,S=s.high,w=s.low,E=c.high,C=c.low,x=h.high,T=h.low,P=d.high,O=d.low,A=p,M=f,R=v,I=m,N=y,k=g,D=_,L=b,F=S,j=w,W=E,B=C,U=x,V=T,H=P,q=O,z=0;z<80;z++){var G=u[z];if(z<16)var Q=G.high=0|e[t+2*z],K=G.low=0|e[t+2*z+1];else{var Y=u[z-15],X=Y.high,$=Y.low,J=(X>>>1|$<<31)^(X>>>8|$<<24)^X>>>7,Z=($>>>1|X<<31)^($>>>8|X<<24)^($>>>7|X<<25),ee=u[z-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ie=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),oe=u[z-7],ae=oe.high,se=oe.low,ce=u[z-16],le=ce.high,ue=ce.low,K=Z+se,Q=J+ae+(K>>>0<Z>>>0?1:0),K=K+ie,Q=Q+re+(K>>>0<ie>>>0?1:0),K=K+ue,Q=Q+le+(K>>>0<ue>>>0?1:0);G.high=Q,G.low=K}var he=F&W^~F&U,de=j&B^~j&V,pe=A&R^A&N^R&N,fe=M&I^M&k^I&k,ve=(A>>>28|M<<4)^(A<<30|M>>>2)^(A<<25|M>>>7),me=(M>>>28|A<<4)^(M<<30|A>>>2)^(M<<25|A>>>7),ye=(F>>>14|j<<18)^(F>>>18|j<<14)^(F<<23|j>>>9),ge=(j>>>14|F<<18)^(j>>>18|F<<14)^(j<<23|F>>>9),_e=l[z],be=_e.high,Se=_e.low,we=q+ge,Ee=H+ye+(we>>>0<q>>>0?1:0),we=we+de,Ee=Ee+he+(we>>>0<de>>>0?1:0),we=we+Se,Ee=Ee+be+(we>>>0<Se>>>0?1:0),we=we+K,Ee=Ee+Q+(we>>>0<K>>>0?1:0),Ce=me+fe,xe=ve+pe+(Ce>>>0<me>>>0?1:0);H=U,q=V,U=W,V=B,W=F,B=j,j=L+we|0,F=D+Ee+(j>>>0<L>>>0?1:0)|0,D=N,L=k,N=R,k=I,R=A,I=M,M=we+Ce|0,A=Ee+xe+(M>>>0<we>>>0?1:0)|0}f=r.low=f+M,r.high=p+A+(f>>>0<M>>>0?1:0),m=i.low=m+I,i.high=v+R+(m>>>0<I>>>0?1:0),g=o.low=g+k,o.high=y+N+(g>>>0<k>>>0?1:0),b=a.low=b+L,a.high=_+D+(b>>>0<L>>>0?1:0),w=s.low=w+j,s.high=S+F+(w>>>0<j>>>0?1:0),C=c.low=C+B,c.high=E+W+(C>>>0<B>>>0?1:0),T=h.low=T+V,h.high=x+U+(T>>>0<V>>>0?1:0),O=d.low=O+q,d.high=P+H+(O>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});n.SHA512=i._createHelper(h),n.HmacSHA512=i._createHmacHelper(h)}(),e.SHA512})},function(e,t,n){!function(r,i){e.exports=t=i(n(80))}(0,function(e){!function(){var t=e,n=t.lib,r=n.Base,i=t.enc,o=i.Utf8,a=t.algo;a.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,c=a.words,l=0;l<n;l++)s[l]^=1549556828,c[l]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}()})},function(e,t){e.exports={ships:[{name:"F7C Hornet",role:"Fighter",size:"S",scale:.004,maxcrew:1,cargo:13},{name:"Caterpillar",role:"Cargo",size:"L",scale:.0035,maxcrew:5,cargo:512},{name:"Reclaimer",role:"Salvage",size:"L",scale:.0025,maxcrew:5,cargo:6555},{name:"Aurora LN",role:"Fighter",size:"S",scale:.005,maxcrew:1,cargo:13},{name:"Sabre",role:"Fighter",size:"S",scale:.004,maxcrew:1,cargo:0},{name:"Avenger Stalker",role:"Bounty Hunter",size:"S",scale:.05,maxcrew:1,cargo:4},{name:"Herald",role:"Information Runner",size:"S",scale:.005,maxcrew:2,cargo:0},{name:"Constellation Andromeda",role:"Versatile",size:"M",scale:.0035,maxcrew:5,cargo:134},{name:"Prospector",role:"Mining",size:"S",scale:.004,maxcrew:1,cargo:128},{name:"Gladius",role:"Fighter",size:"S",scale:.0045,maxcrew:1,cargo:0},{name:"Cutlass Black",role:"Search & Rescue",size:"M",scale:.0035,maxcrew:3,cargo:150},{name:"Constellation Aquila",role:"Explorer",size:"M",scale:.0035,maxcrew:4,cargo:134},{name:"Starfarer",role:"Refuel",size:"L",scale:.0035,maxcrew:7,cargo:3321},{name:"Crucible",role:"Repair",size:"L",scale:.3,maxcrew:4,cargo:300},{name:"P-52 Merlin",role:"Fighter",size:"S",scale:.008,maxcrew:1,cargo:0},{name:"Carrack",role:"Explorer",size:"L",scale:.003,maxcrew:6,cargo:1057},{name:"Mustang Alpha",role:"Personal Transport",size:"S",scale:.005,maxcrew:1,cargo:0},{name:"Orion",role:"Mining",size:"L",scale:.25,maxcrew:6,cargo:216},{name:"Reliant Kore",role:"Light Cargo",size:"S",scale:.006,maxcrew:2,cargo:30},{name:"Vanguard Warden",role:"Long-range Fighter",size:"M",scale:.0035,maxcrew:2,cargo:0},{name:"Genesis",role:"Passenger Transport",size:"L",scale:.7,maxcrew:8,cargo:403},{name:"Polaris",role:"Corvette",size:"L",scale:.0055,maxcrew:24,cargo:216},{name:"Buccaneer",role:"Interdiction",size:"S",scale:.005,maxcrew:1,cargo:0},{name:"Defender",role:"Escort Fighter",size:"M",scale:.0055,maxcrew:2,cargo:0},{name:"Eclipse",role:"Stealth Bomber",size:"S",scale:.004,maxcrew:1,cargo:0},{name:"Prowler",role:"Dropship",size:"M",scale:.005,maxcrew:16,cargo:0},{name:"Hull C",role:"Transport",size:"L",scale:.005,maxcrew:3,cargo:4608},{name:"Redeemer",role:"Gunship",size:"M",scale:.006,maxcrew:9,cargo:24},{name:"Gladiator",role:"Torpedo Bomber",size:"S",scale:.005,maxcrew:2,cargo:0},{name:"Retaliator Base",role:"Versatile Fighter",size:"L",scale:.005,maxcrew:6,cargo:128},{name:"MPUV Cargo",role:"Short-range Cargo",size:"S",scale:.008,maxcrew:1,cargo:2},{name:"Hurricane",role:"Heavy Fighter",size:"S",scale:.5,maxcrew:2,cargo:0},{name:"Glaive",role:"Medium Fighter",size:"M",scale:.005,maxcrew:1,cargo:0},{name:"Scythe",role:"Medium Fighter",size:"M",scale:.005,maxcrew:1,cargo:0},{name:"Terrapin",role:"Explorer",size:"S",scale:.005,maxcrew:2,cargo:13},{name:"Freelancer",role:"Mercantile",size:"M",scale:.005,maxcrew:2,cargo:52},{name:"325a",role:"Fighter",size:"S",scale:.004,maxcrew:1,cargo:4},{name:"600i",role:"Explorer",size:"M",scale:.0025,maxcrew:5,cargo:36}]}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),o=n(37),a=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,t)||this;return r._view=0,r.reset(),r}return r(t,e),t.prototype.reset=function(){this.center=new i.Vector3(0,0,0),this.rotationX=90,this.rotationY=45,this.zoomout=200,this.speedX=-1,this.speedY=.5,this._dir=0,this._up=0,this._right=0,this._fwd=0,this._camup=0},t.prototype.topView=function(){this.center=new i.Vector3(0,0,0),this.rotationX=90,this.rotationY=89,this.zoomout=300,this.speedX=-1,this.speedY=.5,this._dir=0,this._up=0,this._right=0,this._fwd=0,this._camup=0},t.prototype.switch=function(){this._view++,this._view=this._view%2,0==this._view?this.reset():1==this._view&&this.topView()},t.prototype.update=function(e){var t=new i.Vector3,n=new i.Vector3;n.copy(this.position),n.sub(this.center),n.normalize();var r=new i.Vector3(0,1,0),a=new i.Vector3;a.crossVectors(n,r),a.normalize();var s=new i.Vector3;s.crossVectors(a,r),s.normalize();var c=new i.Vector3;c.crossVectors(a,n),c.normalize(),0!==this._dir&&(t.add(n.clone().multiplyScalar(this._dir)),this._dir=0),0!==this._up&&(t.add(r.clone().multiplyScalar(this._up)),this._up=0),0!==this._right&&(t.add(a.clone().multiplyScalar(this._right)),this._right=0),0!==this._fwd&&(t.add(s.clone().multiplyScalar(this._fwd)),this._fwd=0),0!==this._camup&&(t.add(c.clone().multiplyScalar(this._camup)),this._camup=0),this.center.add(t),this.rotationY=Math.max(this.rotationY,-89),this.rotationY=Math.min(this.rotationY,89);var l=new i.Vector3(-this.zoomout,0,0);l=l.applyAxisAngle(new i.Vector3(0,0,1),-o.Math.degToRad(this.rotationY)),l=l.applyAxisAngle(new i.Vector3(0,1,0),-o.Math.degToRad(this.rotationX)),l.add(this.center),this.position.copy(l),this.lookAt(this.center),this.updateMatrix()},t.prototype.rotate=function(e,t){this.rotationX+=e,this.rotationY+=t},t.prototype.forward=function(e){this._fwd+=e},t.prototype.right=function(e){this._right+=e},t.prototype.moveTo=function(e,t){this.center.set(e.x,e.y,e.z),this.zoomout=t,this.rotationX=90,this.rotationY=45},t.prototype.zoomIn=function(e){var t=Math.pow(1.1,e);this.zoomout*=t,this.zoomout>400?this.zoomout=400:this.zoomout<20&&(this.zoomout=20)},t}(i.PerspectiveCamera);t.OrbitCamera=a},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(37),a=n(9),s=n(99),c=n(75),l=n(75),u=n(173),h=function(){function e(e,t,n,r,i,a,l){var u=this;this.scene=e,this.shipService=t,this.projectionMap=n,this.camera=r,this.joystick=i,this.marqueeBox=a,this.addToCurrentTime=l,this.actionableObjects=[],this.shipLabel="none",this.currentAnimationFrame=0,this.recording=!1,this._needRefresh=!1,this._keydown=!1,this._keyup=!1,this._needTacticalPlanUpdate=!1,this._lefttop=null,this._focusedObject=null,this._mbox=new o.Box3,this._onDown=function(e){if(!u.recording&&(1&e.buttons||e.touches&&1==e.touches.length||e.changedPointers&&1==e.changedPointers.length)){var t=u._getPosition(e),n=u._rayGet(t.x,t.y),r=n.intersectObjects(u.actionableObjects,!0);if(r.length>0){var i=r[0].object;u.projectionMap.position.y=i.parent.position.y,u.projectionMap.updateMatrixWorld(!1),i.parent.userData.selected&&!e.ctrlKey?u._focusedObject=i:i.parent.userData.selected&&e.ctrlKey?u.deselectObject(i):!i.parent.userData.selected&&e.ctrlKey?u.selectObject(i):(u._needTacticalPlanUpdate&&(u._updateTacticalPlan(),u._needTacticalPlanUpdate=!1),u.deselectAll(),u.selectObject(i))}else{u._needTacticalPlanUpdate&&(u._updateTacticalPlan(),u._needTacticalPlanUpdate=!1),u.deselectAll();var a=n.intersectObject(u.projectionMap);a.length>0&&(u._lefttop=(new o.Vector3).copy(a[0].point))}}if(!u.recording&&2&e.buttons&&(e.shiftKey||e.ctrlKey)){var l=u.getAllSelected();if(l.length>0){var t=u._getPosition(e),n=u._rayGet(t.x,t.y),r=n.intersectObjects(u.actionableObjects,!0),h=null;if(r.length>0)h=r[0].object.parent.position;else{var a=n.intersectObject(u.projectionMap);if(!(a.length>0))return;h=a[0].point}var d=(new o.Vector3).copy(h);u.rotateSelectedShipsTo(l,d,!0)}}if(u.recording&&(1&e.buttons||e.touches&&1==e.touches.length||e.changedPointers&&1==e.changedPointers.length)){var t=u._getPosition(e),n=u._rayGet(t.x,t.y),r=n.intersectObjects(c.ShipModel3D.points,!0);if(r.length>0){var p=r[0].object;u.projectionMap.position.y=p.position.y,u.projectionMap.updateMatrixWorld(!1),u._focusedObject=p}}if(u.recording&&2&e.buttons){var l=u.getAllSelected();if(1==l.length){var f=l[0],v=f.parent.userData.shipInstance,m=v.animation,t=u._getPosition(e),n=u._rayGet(t.x,t.y),r=n.intersectObjects(c.ShipModel3D.points,!0);if(r.length>0){var p=r[0].object,y=c.ShipModel3D.points.indexOf(p);y>0&&(m.splice(y-1,1),u.updateAnimationCurveFor(f),u._updateTacticalPlan())}else if(m.length<5){var t=u._getPosition(e),n=u._rayGet(t.x,t.y);u.projectionMap.position.y=f.parent.position.y,u.projectionMap.updateMatrixWorld(!1);var a=n.intersectObject(u.projectionMap);if(a.length>0){h=a[0].point;var g=new s.AnimationFrame;g.visible=!0,g.position=h,m.push(g),u.updateAnimationCurveFor(f),u._updateTacticalPlan()}}}}},this._onMove=function(e){(1&e.buttons||e.touches&&1==e.touches.length)&&(u._needRefresh=!0,u._keymap.set("leftclick",e)),2&e.buttons&&(u._needRefresh=!0,u._keymap.set("rightclick",e))},this._onUp=function(e){u._needTacticalPlanUpdate&&(u._updateTacticalPlan(),u._needTacticalPlanUpdate=!1),u.projectionMap.position.y=-1,u._focusedObject=null,u._lefttop=null,u.marqueeBox.visible=!1},this._onKeyDown=function(e){u._keymap.set("down-"+e.key,!0),u._keydown=!0},this._onKeyUp=function(e){u._keymap.set("down-"+e.key,!1),u._keymap.set("up-"+e.key,!0),u._keydown=!1,u._keyup=!0},this._onMouseWheel=function(e){e.preventDefault(),e.stopPropagation();var t;if(e.scale)t=e.scale>1?-e.scale/1500:e.scale/300;else if(e.deltaY)switch(e.deltaMode){case 2:t=.025*e.deltaY;break;case 1:t=.01*e.deltaY;break;default:t=25e-5*e.deltaY}else e.detail&&(t=e.detail/500);if(!u.recording&&e.shiftKey)u.actionableObjects.forEach(function(e){e.parent.userData.selected&&(u._needTacticalPlanUpdate=!0,c.ShipModel3D.moveUp(e,200*t),u.updateAnimationCurveFor(e))});else if(u.recording&&e.ctrlKey){var n=u._getPosition(e),r=u._rayGet(n.x,n.y),i=r.intersectObjects(c.ShipModel3D.points,!0);if(i.length>0){var o=i[0].object,a=u.getAllSelected(),s=a[0].parent.userData.shipInstance,l=c.ShipModel3D.points.indexOf(o);if(l>0){var h=s.animation[l-1];h.visible=!h.visible;var d=u._isShipOnceVisible(s);if(!d)return void(h.visible=!h.visible)}else{s.visible=!s.visible;var d=u._isShipOnceVisible(s);if(!d)return void(s.visible=!s.visible)}u.updateAnimationCurveFor(a[0]),u._needTacticalPlanUpdate=!0}}else if(u.recording&&e.shiftKey){var n=u._getPosition(e),r=u._rayGet(n.x,n.y),i=r.intersectObjects(c.ShipModel3D.points,!0);if(i.length>0){var o=i[0].object,a=u.getAllSelected(),l=c.ShipModel3D.points.indexOf(o);if(l>0){var h=a[0].parent.userData.shipInstance.animation[l-1];h.position.y-=200*t}else c.ShipModel3D.moveUp(a[0],200*t);u.updateAnimationCurveFor(a[0]),u._needTacticalPlanUpdate=!0}}u._needTacticalPlanUpdate||u.recording||(e.ctrlKey?u.camera.center.y+=100*-t:(u._needRefresh=!0,u._keymap.set("zoom",t)),u.camera.updateProjectionMatrix())},this._noop=function(e){e.preventDefault()}}return e.prototype.enable=function(t){this.container=t,this.recording=!1;var n=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1),t.addEventListener?(t.addEventListener("mousedown",this._onDown,!1),t.addEventListener("mousemove",this._onMove,!1),t.addEventListener("mouseup",this._onUp,!1),t.addEventListener("touchstart",this._onDown),t.addEventListener("touchend",this._onUp),t.addEventListener("touchmove",this._onMove),t.addEventListener("contextmenu",this._noop,!1),t.addEventListener(n,this._onMouseWheel,!1)):t.attachEvent&&(t.attachEvent("onmousedown",this._onDown,!1),t.attachEvent("onmousemove",this._onMove,!1),t.attachEvent("onmouseup",this._onUp,!1),t.attachEvent("ontouchstart",this._onDown,!1),t.attachEvent("ontouchend",this._onUp,!1),t.attachEvent("ontouchmove",this._onMove,!1),t.attachEvent("oncontextmenu",this._noop,!1),t.attachEvent("on"+n,this._onMouseWheel)),this._hammer||(this._hammer=new u(t)),this._hammer.get("pinch").set({enable:!0}),this._hammer.get("rotate").set({enable:!0});var r=this;this._hammer.on("pinch",function(e){if(0==r.getAllSelected().length){var t;t=e.scale>1?-e.scale/700:e.scale/200,r._needRefresh=!0,r._keymap.set("zoom",t)}}),this._hammer.on("rotate",function(e){r.getAllSelected().length>0&&o.Math.degToRad(e.rotation)});var r=this;this.joystick.moveCallback=function(t,n){r.camera.rotate(-t*e._joystickSpeedX,-n*e._joystickSpeedY)}},e.prototype.disable=function(e){var t=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";window.removeEventListener("keydown",this._onKeyDown,!1),window.removeEventListener("keyup",this._onKeyUp,!1),e.removeEventListener?(e.removeEventListener("mousedown",this._onDown,!1),e.removeEventListener("mousemove",this._onMove,!1),e.removeEventListener("mouseup",this._onUp,!1),e.removeEventListener("touchstart",this._onDown,!1),e.removeEventListener("touchend",this._onUp,!1),e.removeEventListener("touchmove",this._onMove,!1),e.removeEventListener("contextmenu",this._noop,!1),e.removeEventListener(t,this._onMouseWheel,!1)):e.detachEvent&&(e.detachEvent("onmousedown",this._onDown,!1),e.detachEvent("onmousemove",this._onMove,!1),e.detachEvent("onmouseup",this._onUp,!1),e.detachEvent("ontouchstart",this._onDown,!1),e.detachEvent("ontouchend",this._onUp,!1),e.detachEvent("ontouchmove",this._onMove,!1),e.detachEvent("oncontextmenu",this._noop,!1),e.detachEvent("on"+t,this._onMouseWheel)),this._hammer.off("pinch"),this._hammer.off("rotate")},e.prototype.reset=function(){this.actionableObjects.splice(0,this.actionableObjects.length),this._keymap=new Map},e.prototype.update=function(t){var n=this;if(this._needRefresh){if(this._keymap.get("leftclick"))if(this._focusedObject){var r=this._keymap.get("leftclick"),i=this._getPosition(r),a=this._rayGet(i.x,i.y),s=a.intersectObject(this.projectionMap);if(s.length>0){var u=(new o.Vector3).copy(s[0].point);if(this.recording){var h=this.getAllSelected(),d=c.ShipModel3D.points.indexOf(this._focusedObject);if(d>0){var p=h[0].parent.userData.shipInstance.animation[d-1];p.position.x=u.x,p.position.y=u.y,p.position.z=u.z}else c.ShipModel3D.updateObjectPosition(h[0],u.x,u.y,u.z),this._updateShipInstance();this.updateAnimationCurveFor(h[0]),this._focusedObject=c.ShipModel3D.points[d],this._needTacticalPlanUpdate=!0}else{var f=new o.Vector3(u.x-this._focusedObject.parent.position.x,0,u.z-this._focusedObject.parent.position.z);c.ShipModel3D.updateObjectPosition(this._focusedObject,u.x,u.y,u.z),this.updateAnimationCurveFor(this._focusedObject),this.actionableObjects.forEach(function(e){1==e.parent.userData.selected&&e!==n._focusedObject&&(c.ShipModel3D.updateObjectPosition(e,e.parent.position.x+f.x,e.parent.position.y,e.parent.position.z+f.z),n.updateAnimationCurveFor(e))}),this._needTacticalPlanUpdate=!0}}}else if(this._lefttop){var r=this._keymap.get("leftclick"),i=this._getPosition(r),a=this._rayGet(i.x,i.y),s=a.intersectObject(this.projectionMap);if(s.length>0){var u=s[0].point;if(Math.abs(this._lefttop.x-u.x)>2||Math.abs(this._lefttop.z-u.z)>2){this.marqueeBox.visible=!0,this.marqueeBox.position.set(this._lefttop.x-(this._lefttop.x-u.x)/2,0,this._lefttop.z-(this._lefttop.z-u.z)/2),this.marqueeBox.scale.set(Math.abs(this._lefttop.x-u.x),Math.abs(this._lefttop.z-u.z),1),this._mbox.setFromCenterAndSize(this.marqueeBox.position,new o.Vector3(this.marqueeBox.scale.x,2*l.MAX_HEIGHT,this.marqueeBox.scale.y));var h,d=0,v=new o.Box3,m=new o.Vector3;this.actionableObjects.forEach(function(e){e.geometry.boundingBox.getSize(m);var t=e.parent.scale.x;m.set(m.x*t,m.y*t,m.z*t),v=v.setFromCenterAndSize(e.parent.position,m),n._mbox.intersectsBox(v)?(c.ShipModel3D.select(e,n.scene),h=e,d++):c.ShipModel3D.deselect(e,n.scene)}),1==d&&h?this.shipLabel=h.parent.userData.shipData.name:d>1&&(this.shipLabel=d+" ships")}else this.marqueeBox.scale.set(0,0,0)}}if(this._keymap.get("rightclick")){var r=this._keymap.get("rightclick"),h=this.getAllSelected();if(!r.ctrlKey&&!r.shiftKey){var r=this._keymap.get("rightclick");this.camera.rotate(r.movementX*e._mouseSpeedX,r.movementY*e._mouseSpeedY)}}if(this._keymap.get("zoom")){var y=this._keymap.get("zoom");this.camera.zoomIn(y*e._zoomSpeed)}this._clearKeyMap(),this._needRefresh=!1}if(this._keydown&&(this._keymap.get("down-w")&&this.camera.forward(100*t),this._keymap.get("down-s")&&this.camera.forward(-100*t),this._keymap.get("down-a")&&this.camera.right(100*t),this._keymap.get("down-d")&&this.camera.right(-100*t),this._keymap.get("down-e")&&this.camera.rotate(-100*t,0),this._keymap.get("down-q")&&this.camera.rotate(100*t,0),this._keymap.get("down-c")&&this.rotateSelectedShipsBy(this.getAllSelected(),5*t),this._keymap.get("down-v")&&this.rotateSelectedShipsBy(this.getAllSelected(),-5*t),this._keymap.get("down-1")&&this.addToCurrentTime(-2*t),this._keymap.get("down-2")&&this.addToCurrentTime(2*t)),this._keyup){if(this._keymap.get("up-f")&&this.switchSideOfSelectedShips(),this._keymap.get("up-r")&&this.camera.reset(),this._keymap.get("up- ")){var h=this.getAllSelected();1==h.length&&this.lookAtSelectedShip(h[0])}this._keymap.get("up-x")&&this.rotateResetOfSelectedShips(),(this._keymap.get("up-c")||this._keymap.get("up-v"))&&this._updateTacticalPlan(),this._keyup=!1,this._keymap.clear()}},e.prototype.getAllSelected=function(){var e=[];return this.actionableObjects.forEach(function(t){t.parent.userData.selected&&e.push(t)}),e},e.prototype.selectObject=function(e){c.ShipModel3D.select(e,this.scene),this.shipLabel=e.parent.userData.shipData.name},e.prototype.deselectObject=function(e){c.ShipModel3D.deselect(e,this.scene)},e.prototype.deselectAll=function(){c.ShipModel3D.deselectAll(this.actionableObjects,this.scene)},e.prototype.switchSideOfSelectedShips=function(){var e=!1;this.actionableObjects.forEach(function(t){var n=t.parent.userData;if(n.selected){var r=n.shipInstance;r.enemy=!r.enemy,c.ShipModel3D.switchSide(t,r.enemy),e=!0}}),e&&this._updateTacticalPlan()},e.prototype.rotateSelectedShipsTo=function(e,t,n){var r=!1;e.forEach(function(e){e.rotation.x=-Math.PI/2,e.rotation.y=Math.PI,n&&(t.y=e.parent.position.y),e.parent.lookAt(t),r=!0}),r&&this._updateTacticalPlan()},e.prototype.rotateSelectedShipsBy=function(e,t){var n=!1;e.forEach(function(e){e.rotation.x=-Math.PI/2,e.rotation.y=Math.PI;var r=new o.Vector3(0,1,0);e.parent.rotation.clone(),new o.Matrix4;e.parent.rotateOnAxis(r.normalize(),t),n=!0})},e.prototype.rotateResetOfSelectedShips=function(){var e=!1;this.actionableObjects.forEach(function(t){t.parent.userData.selected&&(t.rotation.set(-Math.PI/2,Math.PI,0),t.parent.rotation.set(0,0,0),e=!0)}),e&&this._updateTacticalPlan()},e.prototype.lookAtSelectedShip=function(e){this.camera.moveTo(e.parent.position,40)},e.prototype.getAnimationFramesMinNumberOfSelectedShips=function(){var e=1e3;return this.getAllSelected().forEach(function(t){var n=t.parent.userData.shipInstance.animation.length;e>n&&(e=n)}),e},e.prototype.updateAnimationCurveFor=function(e){this._updateShipInstance();var t=e.parent.userData.shipInstance,n=e.parent.name+""+e.parent.userData.id,r=c.ShipModel3D.selectedAids.get(n);c.ShipModel3D.updateAnimationCurve(this.scene,t,r,this.recording)},e.prototype._getPosition=function(e){var t=0,n=0,r=this.container.getBoundingClientRect();void 0!==e.layerX?(t=e.layerX,n=e.layerY):e.targetTouches?(t=e.targetTouches[0].pageX-r.left,n=e.targetTouches[0].pageY-r.top):e.changedPointers&&(t=void 0==e.changedPointers[0].offsetX?e.changedPointers[0].layerX:e.changedPointers[0].offsetX,n=void 0==e.changedPointers[0].offsetY?e.changedPointers[0].layerY:e.changedPointers[0].offsetY);var i=new o.Vector3;return i.x=t/r.width*2-1,i.y=-n/r.height*2+1,i.z=.5,i},e.prototype._updateTacticalPlan=function(){this._updateShipInstance(),this.shipService.updateTacticalPlan()},e.prototype._updateShipInstance=function(){this.actionableObjects.forEach(function(e){var t=e.parent.userData;if(t.selected){var n=Math.round(10*e.parent.position.x)/10;e.parent.position.x=n,t.shipInstance.position.x=n;var r=Math.round(10*e.parent.position.y)/10;e.parent.position.y=r,t.shipInstance.position.y=r;var i=Math.round(10*e.parent.position.z)/10;e.parent.position.z=i,t.shipInstance.position.z=i,n=Math.round(1e3*e.parent.rotation.x)/1e3,e.parent.rotation.x=n,t.shipInstance.rotation.x=n,r=Math.round(1e3*e.parent.rotation.y)/1e3,e.parent.rotation.y=r,t.shipInstance.rotation.y=r,i=Math.round(1e3*e.parent.rotation.z)/1e3,e.parent.rotation.z=i,t.shipInstance.rotation.z=i}})},e.prototype._rayGet=function(e,t){var n=new o.Vector3(e,t,.5);return n.unproject(this.camera),new o.Raycaster(this.camera.position,n.sub(this.camera.position).normalize())},e.prototype._clearKeyMap=function(){this._keymap.delete("leftclick"),this._keymap.delete("rightclick"),this._keymap.delete("zoom")},e.prototype._isShipOnceVisible=function(e){if(e.visible)return!0;for(var t=0;t<e.animation.length;t++)if(e.animation[t].visible)return!0},e._mouseSpeedX=.4,e._mouseSpeedY=.3,e._joystickSpeedX=.05,e._joystickSpeedY=.05,e._zoomSpeed=.2/.006,r([a.Input(),i("design:type",Object)],e.prototype,"currentAnimationFrame",void 0),e}();t.Controller=h},function(e,t){e.exports='<div> <md-sidenav-container class="sidenav"> <md-sidenav mode="over" opened="false" align="end" class="info" (close-start)="onCloseShipInfo()" #shipInfo> <md-card *ngIf="selectedShip" class="info-card"> <md-card-header style="padding:20px"> <img md-card-avatar src="{{shipService.getImage(selectedShip)}}"> <md-card-title>{{selectedShip.name}}</md-card-title> <md-card-subtitle style="color:#80cadc">Ship Info</md-card-subtitle> </md-card-header> <md-card-content style="padding:20px"> <md-slide-toggle color="warn" [(ngModel)]="selectedShipInstance.enemy" (change)="onShipInfoChange()" [disabled]="!shipService.isUnlocked()"> <span *ngIf="!selectedShipInstance.enemy">Ally</span> <span *ngIf="selectedShipInstance.enemy">Enemy</span> </md-slide-toggle> <md-list> <md-list-item style="color:#80cadc"> <md-icon md-list-icon>bookmark</md-icon> <h4 md-line>Role</h4> <p md-line>{{selectedShip.role}}</p> </md-list-item> <md-divider></md-divider> <md-list-item style="color:#80cadc"> <md-icon md-list-icon>people</md-icon> <h4 md-line>Max Crew</h4> <p md-line>{{selectedShip.maxcrew}}</p> </md-list-item> <md-divider></md-divider> <md-list-item style="color:#80cadc"> <md-icon md-list-icon>layers</md-icon> <h4 md-line>Cargo Capacity</h4> <p md-line>{{selectedShip.cargo}}</p> </md-list-item> <md-divider></md-divider> <md-list-item style="color:#80cadc"> <md-icon md-list-icon>flight</md-icon> <h4 md-line>Pilot <button md-button *ngIf="shipService.isUnlocked()" (click)="manageCrew()"> <md-icon md-tooltip="Click here to add players.">settings</md-icon> </button> </h4> <md-select md-line placeholder="Select Pilot" color="primary" [(ngModel)]="selectedShipInstance.pilot" (change)="onShipInfoChange()" [disabled]="!shipService.isUnlocked()"> <md-option *ngFor="let player of shipService.tacticalPlan.players" [value]="player"> {{ player }} </md-option> </md-select> </md-list-item> <md-list-item *ngIf="selectedShip.maxcrew > 1" style="color:#80cadc"> <md-icon md-list-icon>airline_seat_recline_extra</md-icon> <h4 md-line>Crewmen</h4> </md-list-item> <md-list-item *ngIf="selectedShip.maxcrew > 1" style="color:#80cadc"> <md-select style="padding-left:10px" color="primary" md-line placeholder="Select Crewman" *ngFor="let cm of Arr(selectedShip.maxcrew-1).fill(1); let i=index" [(ngModel)]="selectedShipInstance.crewmen[i]" (change)="onShipInfoChange()" [disabled]="!shipService.isUnlocked()"> <md-option *ngFor="let player of shipService.tacticalPlan.players" [value]="player"> {{ player }} </md-option> </md-select> </md-list-item> </md-list> </md-card-content> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </md-sidenav> <div class="background"> <div class="tool-panel" *ngIf="loaded"> <ul style="margin-top:10px"> <li style="background:rgba(6,70,102,.4)"> <button md-button (click)="resetAnimation()"> <md-icon>skip_previous</md-icon> </button> </li> <li class="tools-divider"> </li> <li style="background:rgba(6,70,102,.4)"> <button md-button (click)="playAnimation()"> <md-icon *ngIf="!play">play_arrow</md-icon> <md-icon *ngIf="play">pause</md-icon> </button> </li> <li style="width:250px"> <md-progress-bar id="timeline" style="width:100%;height:20px" color="primary" (click)="onChangeAnimation($event)" mode="determinate" [value]="currentTime / maxTime * 100"> </md-progress-bar> <div> <span style="float:left">{{controller.currentAnimationFrame}} / 5 frames</span> <span style="float:right">{{timeSec}}s</span> </div> </li> </ul> </div> <div class="camera-panel" *ngIf="loaded"> <md-card class="cameras"> <div md-card-content> <ul> <li> <button md-button (click)="switchCameraView()" md-tooltip="Change camera view."> <md-icon>explore</md-icon> </button> </li> <li class="tools-divider"> </li> <li> <button md-button (click)="lookAtShip()" md-tooltip="Lock or unlock ship view." [disabled]="controller.getAllSelected().length !== 1 && !cameraLockedTo"> <md-icon>camera</md-icon> </button> </li> </ul> </div> </md-card> </div> <div class="ship-panel" *ngIf="loaded && controller.getAllSelected().length > 0 && shipService.isUnlocked()"> <ul> <li> <button md-button (click)="switchSide()" md-tooltip="Switch allies and enemies of selected ships."> <md-icon>invert_colors</md-icon> </button> </li> <li class="tools-divider"> </li> <li> <button md-button md-tooltip="Show info about the selected ship." (click)="showInfo()" [disabled]="controller.getAllSelected().length > 1"> {{controller.shipLabel}} </button> </li> <li class="tools-divider"> </li> <li> <div style="height:18px"><button class="arrow" md-icon-button (click)="squadron(1)" [disabled]="!isSquadron()"> <md-icon style="margin-top:-24px">keyboard_arrow_up</md-icon> </button></div> <div style="height:18px"><button class="arrow" md-icon-button (click)="squadron(-1)" [disabled]="!isSquadron()"> <md-icon style="margin-top:-24px">keyboard_arrow_down</md-icon> </button></div> </li> </ul> <ul style="margin-top:10px"> <li> <md-button-toggle (click)="recording()" color="warn" md-tooltip="Record the ship movement."> <md-icon>fiber_manual_record</md-icon> </md-button-toggle> </li> </ul> </div> <div id="container" class="container" #container> <section class="loader" [hidden]="loaded"> <h3>Loading ...</h3> <md-progress-bar color="primary" mode="determinate" [value]="loadingProgress"> </md-progress-bar> </section> </div> </div> </md-sidenav-container> </div>'},function(e,t,n){var r=n(794);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'.container{position:relative;text-align:center;background:url("/u-tec/assets/images/grid-bg.png") repeat top;background-color:rgba(6,70,102,.2);height:100%;overflow:hidden}.background{background:url("/u-tec/assets/images/inventory-bg.jpg") repeat}.background,.sidenav{position:absolute;top:0;left:0;right:0;bottom:0}.loader{padding:20px;padding-top:114px;color:#99e3f5}#text-label{color:#80cadc;display:none;z-index:10;width:auto;white-space:nowrap;min-height:40px}#text-label:hover{background:rgba(0,0,0,.1);color:#80cadc}.timeline{position:absolute;z-index:10;width:400px;bottom:20px;left:20px}.info{background:rgba(0,0,0,.1);padding:20px;padding-top:74px}.info-card{background:rgba(6,70,102,.8);color:#80cadc;padding:0}.progress-bar{background-color:#99e3f5}.tool-panel{position:absolute;top:50px;left:10px;z-index:2;padding:0}.camera-panel{bottom:200px}.camera-panel,.ship-panel{position:absolute;right:10px;z-index:2;padding:0}.ship-panel{top:60px;text-align:right}.cameras,.tools{padding:0;background:rgba(6,70,102,.4)}.cameras ul,.ship-panel ul,.tool-panel ul,.tools ul{margin:0;padding:0;list-style:none}.ship-panel ul li{background:rgba(6,70,102,.4)}.cameras ul li,.ship-panel ul li,.tool-panel ul li,.tools ul li{display:inline-block;vertical-align:top;position:relative;text-align:center;color:#80cadc}.tools-divider{width:1px;margin-top:5px;margin-bottom:5px;height:26px;background-color:#99e3f5!important;content:""}.card-corner{position:absolute;width:100%}.card-corner:before{left:0}.card-corner:after{right:0}.card-corner-top{top:0}.card-corner-top:before{border-width:1px 0 0 1px}.card-corner-top:after{border-width:1px 1px 0 0}.card-corner:after,.card-corner:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid}.card-corner-bottom{bottom:9px}.card-corner-bottom:before{border-width:0 0 1px 1px}.card-corner-bottom:after{border-width:0 1px 1px 0}.toggle-button{color:#99e3f5;text-align:center;margin:0 auto;padding-left:16px;padding-right:16px}.arrow:hover{background:rgba(0,0,0,.2);height:18px}.mat-button-toggle{color:rgba(255,0,0,.4)}.mat-button-toggle:hover{background:rgba(0,0,0,.1)}.mat-button-toggle-standalone{box-shadow:none}.mat-button-toggle-checked{background-color:#80cadc;color:red}.mat-button-toggle-disabled{background-color:rgba(0,0,0,.1);color:rgba(0,0,0,.6)}@media (max-width:480px){.title{display:none}.timeline{position:absolute;z-index:10;width:150px;bottom:20px;left:20px}.ship-panel{top:110px}.camera-panel,.ship-panel{position:absolute;right:10px;z-index:2;padding:0}.camera-panel{bottom:0}}',""])},function(e,t){e.exports='<div> <h1 md-dialog-title>Crew Management</h1> <md-dialog-content> <md-input-container style="width:300px;margin:20px"> <textarea mdInput #message maxlength="256" rows="10" placeholder="Players" [(ngModel)]="data.players">\n             </textarea> <md-hint align="start"><strong>Add every player to a new line.</strong> </md-hint> <md-hint align="end">{{message.value.length}} / 256</md-hint> </md-input-container> </md-dialog-content> <md-dialog-actions> <button md-button (click)="dialogRef.close(message.value)" color="primary">Confirm</button> <button md-button md-dialog-close="Cancel">Cancel</button> </md-dialog-actions> </div>'},function(e,t){e.exports='<div> <md-dialog-content> <h1 style="margin:20px">Controls</h1> <p style="margin:10px"> Though it\'s possible to move around the scene on your mobile phone or tablet, it\'s recommended to use your PC for creating the tactical plans. </p> <h2 style="margin:30px">Camera Orientation</h2> <h4 style="margin:10px"> <md-icon>zoom_in</md-icon> Zoom View</h4> <p> Use mouse scroll wheel <md-icon>mouse</md-icon> or touch pinch to zoom in or out. </p> <h4 style="margin:10px"> <md-icon>camera_roll</md-icon> Rotate View</h4> <p> Use mouse Right Click or virtual joystick to rotate the scene view. </p> <h4 style="margin:10px"> <md-icon>camera</md-icon> Lock View to a Ship</h4> <p> Have a selected ship and click on <md-icon>camera</md-icon> to lock the camera view to the selected ship. To unlock the view, click to the same button <md-icon>camera</md-icon> again. </p> <h2 style="margin:30px">Scene Editing</h2> <p style="margin:10px"> Have a selected ship(s) to do any of the actions below. </p> <h4 style="margin:10px"> <md-icon>swap_vert</md-icon>Move Ship Up or Down</h4> <p> <strong>Hold SHIFT</strong> key + Mouse Scroll Wheel <md-icon>mouse</md-icon> to move the ship up or down. </p> <h4 style="margin:10px"> <md-icon>rotate_90_degrees_ccw</md-icon> 2D Ship Rotation</h4> <p> <strong>Hold CTRL</strong> key + Mouse Right Click will rotate the ship(s) towards the target. Alternatively press <strong>C</strong> or <strong>V</strong> to rotate the ship(s) to the left or right. To reset the ship(s)\' rotation, press <strong>X</strong>. </p> <h4 style="margin:10px"> <md-icon>invert_colors</md-icon>Switch Ship to Enemy or Ally</h4> <p> Click on <md-icon>invert_colors</md-icon> or press <strong>F</strong> to switch the selected ship to enemy or ally. </p> <h4 style="margin:10px"> <md-icon>info_outline</md-icon>Show Ship Info</h4> <p> Click on the label with the ship\'s name; for example "F7C Hornet". </p> <h2 style="margin:30px">Animation Recording</h2> <p style="margin:10px"> Have a selected ship(s) and click on <md-icon>fiber_manual_record</md-icon> to enable the recording. The length of the scene animation can be set in Settings. </p> <h4 style="margin:10px"> <md-icon>add_location</md-icon>Add ship route</h4> <p> Mouse Right Click to add new points to the ship\'s route. Maximum limit is 5 points. </p> <h4 style="margin:10px"> <md-icon>edit_location</md-icon>Edit ship route</h4> <p> To move one of the points of the route, use Mouse Left Button. To move the point up or down, get the mouse cursor over the point and <strong>hold SHIFT</strong> key + Mouse Scroll Wheel <md-icon>mouse</md-icon>. To delete the point, use Mouse Right Button. </p> <h4 style="margin:10px"> <md-icon>visibility_off</md-icon>Hide ship on its route</h4> <p> <strong>Hold CTRL</strong> key + Mouse Scroll Wheel over the point <md-icon>mouse</md-icon> to change the ship\'s visibility in that particular point\'s position. The point will change its color to <strong>Black</strong>. At least one point will always stay visible. </p> <h4 style="margin:10px"> <md-icon>fast_forward</md-icon>Manually change the current time of animation</h4> <p> Mouse Left Click on the timeline. Alternatively, <strong>hold key 2</strong> to move animation forward or <strong>hold key 1</strong> to move animation backward. </p> </md-dialog-content> <md-dialog-actions> <button md-button md-dialog-close="Close">Close</button> </md-dialog-actions> </div>'},function(e,t){},function(e,t){e.exports='<main class="main"> <md-toolbar class="toolbar"> <div class="toolbar-left"> <div class="tl-horizontal"> <button md-icon-button [mdMenuTriggerFor]="menu" class="button" style="margin-top:5px"> <md-icon>menu</md-icon> </button> <div class="logo"></div> <md-menu #menu="mdMenu" [overlapTrigger]="false"> <button md-menu-item (click)="newTacticalPlan()"> <md-icon>clear_all</md-icon> <span>New Tactical Plan</span> </button> <button md-menu-item (click)="saveImage()" *ngIf="isSimulator()"> <md-icon>photo_camera</md-icon> <span>Save Image</span> </button> <button md-menu-item (click)="lock()" *ngIf="!shipService.tacticalPlan.passwordHash"> <md-icon>lock_outline</md-icon> <span>Lock</span> </button> <button md-menu-item (click)="unlock()" *ngIf="shipService.isConnected() && shipService.tacticalPlan.passwordHash" [disabled]="shipService.isUnlocked()"> <md-icon>lock_open</md-icon> <span>Unlock</span> </button> <button md-menu-item (click)="toggleFullscreen()"> <md-icon>fullscreen</md-icon> <span>Fullscreen</span> </button> <button md-menu-item (click)="showControls()" *ngIf="isSimulator()"> <md-icon>games</md-icon> <span>Open Controls</span> </button> <button md-menu-item (click)="openSettings()" *ngIf="shipService.isConnected()"> <md-icon>settings</md-icon> <span>Settings</span> </button> <md-divider></md-divider> <button class="donate" (click)="donate()" md-menu-item></button> </md-menu> <a href="#" (click)="welcome()" class="title">UEE Tactical Communications Interface</a> <button md-tooltip="Tactical plan is locked" md-button *ngIf="!shipService.isUnlocked()" (click)="unlock()" class="lock-button"> <md-icon>lock_outline</md-icon> </button> </div> </div> <div class="spacer"></div> <div class="toolbar-right"> <div class="tl-action"> <div class="tl-action-highlight"> <button md-raised-button color="primary" routerLink="/inventory" routerLinkActive="inventoryActive" (click)="inventory()" class="button primary-button" skipLocationChange> <i class="material-icons">view_list</i> Inventory </button> <button md-raised-button color="primary" routerLink="/simulator" routerLinkActive="simulatorActive" (click)="simulator()" class="button primary-button" skipLocationChange [disabled]="!shipService.isReady()"> Simulate <i class="material-icons">play_circle_outline</i> </button> </div> <div> </div> </div></div></md-toolbar> <div class="content"> <router-outlet (activate)="onActivate($event)"></router-outlet> </div> </main>'},function(e,t,n){var r=n(800);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'*,:after,:before{box-sizing:border-box}.main{min-width:360px}.toolbar{position:fixed;top:0;left:0;bottom:auto;right:0;padding:0;margin:0;margin-top:-8px;z-index:5;background:none;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;pointer-events:none}.content{padding-top:64px;min-width:360px}.title{overflow:hidden;color:#80cadc;padding-top:10px;font:24px/30px Electrolize;text-decoration:none}.toolbar-left{white-space:nowrap;pointer-events:auto;position:relative;padding-left:25px;margin-right:30px;background-color:#020e1b;border-bottom:1px solid #0c67a1}.toolbar-left:before{content:"";position:absolute;top:auto;left:0;bottom:3px;right:0;z-index:2;border-bottom:1px solid #0c67a1}.toolbar-left:after{content:"";width:0;height:0;border-style:solid;border-width:0 50px 50px 0;border-color:transparent #020e1b transparent transparent;position:absolute;top:auto;left:auto;bottom:0;right:-50px;-webkit-transform:scaleX(-1);transform:scaleX(-1)}.tl-horizontal{display:flex;box-sizing:border-box;flex-direction:row;white-space:nowrap}.tl-horizontal:after{content:"";position:absolute;top:auto;left:auto;bottom:0;right:-1px;z-index:2;width:6px;height:30px;background-color:#0c67a1;-webkit-transform:skewX(-45deg);transform:skewX(-45deg);-webkit-transform-origin:bottom right;transform-origin:bottom right}.tl-action{padding:7px 25px 7px 15px;position:relative;margin-left:30px;white-space:nowrap;background-color:#020e1b;border-bottom:1px solid #0c67a1}.tl-action:before{width:0;height:0;border-style:solid;border-width:0 50px 50px 0;border-color:transparent #020e1b transparent transparent;left:-50px}.tl-action-highlight:before,.tl-action:before{content:"";position:absolute;top:auto;bottom:0;right:auto}.tl-action-highlight:before{left:-1px;z-index:2;width:6px;height:30px;background-color:#0c67a1;-webkit-transform:skewX(45deg);transform:skewX(45deg);-webkit-transform-origin:bottom right;transform-origin:bottom right;-webkit-transform-origin:bottom left;transform-origin:bottom left}.toolbar-right{pointer-events:auto}.primary-button{min-width:100px}.spacer{margin-top:-20px;-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.spacer:after,.spacer:before{content:"";display:block;-webkit-box-flex:1;-ms-flex:1;flex:1;pointer-events:auto;padding-top:20px;margin-top:-10px;background-color:#020e1b;border-bottom:1px solid #0c67a1}.inventoryActive,.simulatorActive{display:none}.logo{background-image:url("/u-tec/assets/images/logo.png");background-size:59px 50px;width:59px;min-width:59px;height:50px;margin-left:15px;margin-right:10px}.donate,.donate:hover{background-image:url("/u-tec/assets/images/donate.png");width:91px;min-width:91px;height:36px;margin:0 auto;margin-top:5px}.button{background:rgba(6,70,102,.4)}.button,.lock-button{color:#99e3f5}/deep/ .mat-menu-content{background:rgba(6,70,102,.8)!important}/deep/ .mat-menu-item,/deep/ .mat-menu-item .mat-icon{color:#99e3f5}/deep/ .mat-dialog-container{background:#064666;color:#99e3f5}/deep/ snack-bar-container{max-width:none!important}/deep/ .mat-select-content,/deep/ snack-bar-container{background:rgba(6,70,102,.8)!important;color:#99e3f5}/deep/ .mat-button,/deep/ .mat-icon-button,/deep/ .mat-raised-button{font:20px/24px Electrolize}/deep/ .mat-card,/deep/ .mat-dialog-title,/deep/ .mat-list-item,/deep/ .mat-menu-item,/deep/ .mat-option,/deep/ .mat-select,/deep/ .mat-slide-toggle-content,/deep/ .mat-tooltip{font:16px/20px Electrolize}/deep/ .mat-progress-bar-buffer{background-color:none;background:rgba(6,70,102,.4)}/deep/ .mat-progress-bar-fill:after{background-color:#99e3f5}@media (max-width:480px){.title{display:none}}',""])},function(e,t){e.exports='<div> <h1 md-dialog-title>{{data.type}} Tactical Plan</h1> <md-dialog-content> <p>Locked tactical plan is read-only until it is unlocked with the password.</p> <md-input-container> <input mdInput placeholder="Password" type="password" (keyup.enter)="dialogRef.close(password.value)" #password> </md-input-container> </md-dialog-content> <md-dialog-actions> <button md-button (click)="dialogRef.close(password.value)" color="primary">{{data.type}}</button> <button md-button md-dialog-close="Cancel">Cancel</button> </md-dialog-actions> </div>'},function(e,t){e.exports='<div *ngIf="tacticalPlan" class="inventory"> <md-grid-list [cols]="cols | async" gutterSize="16px" rowHeight="300px" class="ships-small"> <md-grid-tile *ngFor="let s of filterSize(\'S\')"> <ship-card [ship]="s"> </ship-card> </md-grid-tile> <md-grid-tile *ngIf="shipsSmall?.length == 0" class="empty"> <md-card class="empty-card"> <div md-card-content class="card-content">Add fighters and single-seated small-sized ships under 30m.</div> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </md-grid-tile> <md-grid-tile> <button md-fab color="none" (click)="addS()" [disabled]="!shipService.isUnlocked()" class="add-button"><md-icon>add</md-icon></button> </md-grid-tile> </md-grid-list> <div class="horizontal-line"></div> <md-grid-list [cols]="cols | async" gutterSize="16px" rowHeight="300px" class="ships-medium"> <md-grid-tile *ngFor="let s of filterSize(\'M\')"> <ship-card [ship]="s"> </ship-card> </md-grid-tile> <md-grid-tile *ngIf="shipsMedium?.length == 0" class="empty"> <md-card class="empty-card"> <div md-card-content class="card-content">Add multi-crew medium-sized ships under 80m.</div> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </md-grid-tile> <md-grid-tile> <button md-fab color="none" (click)="addM()" [disabled]="!shipService.isUnlocked()" class="add-button"><md-icon>add</md-icon></button> </md-grid-tile> </md-grid-list> <div class="horizontal-line"></div> <md-grid-list [cols]="cols | async" gutterSize="16px" rowHeight="300px" class="ships-large"> <md-grid-tile *ngFor="let s of filterSize(\'L\')"> <ship-card [ship]="s"> </ship-card> </md-grid-tile> <md-grid-tile *ngIf="shipsMedium?.length == 0" class="empty"> <md-card class="empty-card"> <div md-card-content class="card-content">Add dominating large-sized ships over 80m.</div> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </md-grid-tile> <md-grid-tile> <button md-fab color="none" (click)="addL()" [disabled]="!shipService.isUnlocked()" class="add-button"><md-icon>add</md-icon></button> </md-grid-tile> </md-grid-list> </div>'},function(e,t,n){var r=n(804);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'.inventory{overflow:auto}.ship-size-title{padding:10px;padding-left:30px;color:#eee}.empty{margin-left:40px;width:200px}.empty-card{background:rgba(6,70,102,.4);color:#99e3f5;padding:0}.horizontal-line{content:" ";background-color:#0c67a1;width:auto;height:1px;margin:10px}.card-content{padding:24px;font:16px/20px Electrolize}.card-corner{position:absolute;width:100%}.card-corner:before{left:0}.card-corner:after{right:0}.card-corner-top{top:0}.card-corner-top:before{border-width:1px 0 0 1px}.card-corner-top:after{border-width:1px 1px 0 0}.card-corner:after,.card-corner:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid}.card-corner-bottom{bottom:9px}.card-corner-bottom:before{border-width:0 0 1px 1px}.card-corner-bottom:after{border-width:0 1px 1px 0}.empty-card-top:after,.empty-card-top:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid;border-width:1px 0 0 1px}.add-button{background:rgba(6,70,102,.4);color:#99e3f5}',""])},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(36),s=n(99),c=n(57),l=function(){function e(e,t){this.shipService=e,this.router=t}return e.prototype.ngOnInit=function(){this.model=this.shipService.getModel(this.ship.name)},e.prototype.delete=function(e){this.shipService.deleteShip(this.model)},e.prototype.onShipAmountChange=function(){this.ship.amount<1?this.ship.amount=1:this.shipService.updateTacticalPlan()},r([o.Input(),i("design:type",s.ShipData)],e.prototype,"ship",void 0),e=r([o.Component({selector:"ship-card",template:n(806),styles:[n(807)]}),i("design:paramtypes",[c.ShipService,a.Router])],e)}();t.ShipCardComponent=l},function(e,t){e.exports='<md-card class="ship-card"> <md-card-header style="margin:0;padding:0"> <md-card-title class="ship-title">{{ship.name}}</md-card-title> <button md-icon-button [mdMenuTriggerFor]="configMenu" class="ship-menu" [disabled]="!shipService.isUnlocked()"> <md-icon>more_vert</md-icon> </button> <md-menu #configMenu> <button md-menu-item (click)="delete($event)"> <md-icon>delete</md-icon> <span>Delete</span> </button> </md-menu> </md-card-header> <img md-card-image src="{{shipService.getImage(model)}}" class="ship-thumbnail"> <md-card-footer class="ship-amount"> <div class="ship-amount-panel"> <md-slider color="primary" max="10" min="0" step="1" thumb-label="true" [(ngModel)]="ship.amount" (change)="onShipAmountChange()" class="slider" [disabled]="!shipService.isUnlocked()"> </md-slider> <button md-mini-fab color="none" class="amount-number">{{ship.amount}}</button> </div> </md-card-footer> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card>'},function(e,t,n){var r=n(808);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'.ship-card{background:rgba(6,70,102,.4);color:#99e3f5}.ship-title{width:130px}.ship-thumbnail{width:200px;height:200px;border-bottom:1px solid #99e3f5;border-top:1px solid #99e3f5;opacity:1;box-shadow:0 3px 4px rgba(153,227,245,.7),0 -3px 4px rgba(153,227,245,.7)}.ship-menu{position:absolute;right:10px;top:10px}.ship-amount{width:0;bottom:0;left:10px}.ship-amount-panel{display:inline-block;width:200px}.slider{touch-action:none}.amount-number{right:-5px;background:rgba(6,70,102,.4);color:#99e3f5;cursor:default}.card-corner{position:absolute;width:100%}.card-corner:before{left:-24px}.card-corner:after{right:24px}.card-corner-top{top:2px}.card-corner-top:before{border-width:1px 0 0 1px}.card-corner-top:after{border-width:1px 1px 0 0}.card-corner:after,.card-corner:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid}.card-corner-bottom{bottom:11px}.card-corner-bottom:before{border-width:0 0 1px 1px}.card-corner-bottom:after{border-width:0 1px 1px 0}@media (max-width:480px){.ship-title{width:80px}.ship-thumbnail{width:128px;height:128px;margin:0;padding:0}.ship-amount{width:0;bottom:0;left:7px}.ship-amount-panel{display:inline-block;width:145px}.amount-number{display:none}.slider{width:145px;min-width:145px;touch-action:none}}',""])},function(e,t){e.exports='<div class="container"> <div class="background"> <md-card class="ship-card"> <md-card-header> <md-card-title style="padding:20px"> <h3>Add Ship</h3> </md-card-title> </md-card-header> <md-card-content class="ship-content"> <form> <div class="highlight"> <md-icon style="padding-right:5px">star_rate</md-icon> <md-select placeholder="Ship Type" [(ngModel)]="selectedModel" name="ship" (change)="onShipTypeChange()" style="width:180px"> <md-option *ngFor="let model of filterSize(models)" [value]="model"> {{model.name}} </md-option> </md-select> </div> <md-hint [hidden]="!typeExistsError" style="color:red"> <div> This type of ship already exists in the Inventory </div> </md-hint> </form> <img md-card-image src="{{shipService.getImage(selectedModel)}}" class="ship-thumbnail" *ngIf="selectedModel"> </md-card-content> <md-card-footer class="ship-actions"> <button md-raised-button (click)="goBack()" class="ship-action-cancel">Cancel</button> <button md-raised-button (click)="addShip()" class="add-button">Add</button> </md-card-footer> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </div> </div>'},function(e,t,n){var r=n(811);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'.container{position:absolute;top:0;left:0;right:0;bottom:0;background:url("/u-tec/assets/images/inventory-bg.jpg") repeat;overflow:hidden}.background{background:url("/u-tec/assets/images/grid-bg.png") repeat top;background-color:rgba(6,70,102,.2);height:100%;padding-top:70px}.ship-card{width:300px;height:380px;margin:0 auto;background:rgba(6,70,102,.4);color:#99e3f5;padding:0;font:16px/20px Electrolize}.ship-content{padding:20px;text-align:center}.ship-thumbnail{margin-top:20px;width:200px;height:200px;border:1px solid #99e3f5;opacity:1;box-shadow:4px 4px 10px rgba(153,227,245,.7),-4px -4px 10px rgba(153,227,245,.7),-4px 4px 10px rgba(153,227,245,.7),4px -4px 10px rgba(153,227,245,.7)}.ship-actions{text-align:right}.ship-action-cancel{right:98px}.add-button,.ship-action-cancel{position:absolute;bottom:-46px;background:rgba(6,70,102,.4);color:#99e3f5}.add-button{right:0}.highlight{background-color:rgba(153,227,245,.6);color:#000;-moz-border-radius:10px;border-radius:10px}.card-corner{position:absolute;width:100%}.card-corner:before{left:0}.card-corner:after{right:0}.card-corner-top{top:0}.card-corner-top:before{border-width:1px 0 0 1px}.card-corner-top:after{border-width:1px 1px 0 0}.card-corner:after,.card-corner:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid}.card-corner-bottom{bottom:9px}.card-corner-bottom:before{border-width:0 0 1px 1px}.card-corner-bottom:after{border-width:0 1px 1px 0}',""])},function(e,t){e.exports='<div class="border"> <md-card class="container"> <div class="content"> <div style="position:absolute;top:5px;right:5px">2.0.Beta1 2017/10/15</div> <h1 style="font:32px/36px Electrolize">WELCOME CITIZEN</h1> <p> UEE Tactical Communications Interface is a tool and fan project for tactical planning in <a href="https://robertsspaceindustries.com/" target="blank" class="link">Star Citizen</a>, the game from CIG. </p> <div style="text-align:left"> <h4 style="margin:10px;margin-top:20px">1. Add Ships to Inventory</h4> <ul style="margin-left:20px"> <li style="line-height:20px"> Ships are divided into 3 categories: Small, Medium, and Large. </li> <li style="line-height:20px"> Every category is visualized in a separate row </li> <li style="line-height:20px"> Once your list of ships in the Inventory is ready, click on the Simulate button. </li> </ul> <div class="inventory"></div> <h4 style="margin:10px;margin-top:20px">2. Simulate and Make a Tactical Plan</h4> <ul style="margin-left:20px"> <li style="line-height:20px"> See <a href="javascript:void(0)" (click)="openControls()" class="link">Controls</a> to learn camera orientation, scene editing, and animation recording. </li> <li style="line-height:20px"> Play your tactical plan animation. </li> </ul> <div class="simulation"></div> <h4 style="margin:10px;margin-top:20px">3. Share the Tactical Plan with your friends</h4> <p> Copy &amp; Paste the URL. Be aware that a tactical plan which has not been viewed for more than 2 months will be removed. </p> <h4 style="margin:10px;margin-top:20px">4. Love the tool? Do you want to contribute?</h4> <ul style="margin-left:20px"> <li style="line-height:20px"> As a new Citizen you can use my referral code when you sign up for your new RSI account and you will get 5 000 UEC as a bonus: <strong>STAR-W2V7-3TLP</strong> </li> <li style="line-height:20px"> As a Senior Citizen you can up-vote my <a href="https://robertsspaceindustries.com/community/citizen-spotlight/9204-UEE-Tactical-Communications-Interface" target="blank" class="link">Spotlight Post</a> </li> <li style="line-height:20px"> As a developer or a designer you can become part of the project development, read more on <a href="https://github.com/ibek/u-tec" target="blank" class="link">GitHub</a> and watch the progress in <a href="https://trello.com/b/yriIKmf7/u-tec-progress-board" target="blank" class="link">Trello board</a>. </li> <li style="line-height:20px"> To support the project, its development, operating costs, and maintenance you can <a href="https://donorbox.org/uee-tactical-communications-interface" target="blank" class="link">Donate via Paypal</a> </li> </ul> </div> <div style="width:auto;margin:0 auto;padding:20px"> <button md-button style="background-color:#80cadc;color:rgba(6,70,102,1);width:250px;height:60px;font:32px/36px Electrolize" (click)="getStarted()">GET STARTED</button> </div> <div style="text-align:left"> <h4 style="margin:20px" name="lastUpdate">2.0.Beta1 update on 15 Oct 2947</h4> <ul style="margin-left:20px"> <li style="line-height:20px"> Ship route animation. </li> <li style="line-height:20px"> Improved camera controls. </li> <li style="line-height:20px"> Extended the scene. </li> <li style="line-height:20px"> Mobile and Table support for viewing. </li> <li style="line-height:20px"> Improved experience of ship controls </li> <li style="line-height:20px"> Added <a href="javascript:void(0)" (click)="openControls()" class="link">keyboard shortcuts</a> </li> <li style="line-height:20px"> 4 Backgrounds to choose from = Starfarer and Freelancer cockpits, Galaxy stars, and solid Dark screen </li> <li style="line-height:20px"> Squadrons of small ships (1 to 8 ship squadron in automatic formation) </li> <li style="line-height:20px"> New grid with custom mipmapping </li> <li style="line-height:20px"> New ships - Freelancer, Terrapin, 325a, 600i </li> </ul> </div> </div> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </div>'},function(e,t,n){var r=n(814);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'.border{padding:20px}.container{padding:0;background:rgba(6,70,102,.4);color:#99e3f5;margin:0;margin-left:20px;margin-right:20px;min-width:660px}.content{padding:24px;text-align:center}.inventory{background-image:url("/u-tec/assets/images/inventory.png");width:600px;height:117px;margin:20px}.simulation{background-image:url("/u-tec/assets/images/simulation.gif");width:476px;height:108px;margin:20px}.card-corner{position:absolute;width:100%}.card-corner:before{left:0}.card-corner:after{right:0}.card-corner-top{top:0}.card-corner-top:before{border-width:1px 0 0 1px}.card-corner-top:after{border-width:1px 1px 0 0}.card-corner:after,.card-corner:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid}.card-corner-bottom{bottom:9px}.card-corner-bottom:before{border-width:0 0 1px 1px}.card-corner-bottom:after{border-width:0 1px 1px 0}.link{color:#00edff}',""])},function(e,t){e.exports='<div class="border"> <md-card class="container"> <div class="content"> <h1 style="font:32px/36px Electrolize">Settings</h1> <p> The custom settings are saved with your tactical plan in the database. </p> <md-list style="text-align:left" *ngIf="shipService.isConnected()"> <md-list-item style="color:#80cadc"> <h4 md-line>Background</h4> <md-select color="primary" md-line placeholder="Select Background or Set custom URL" md-tooltip="Select Background or Set custom URL" [(ngModel)]="bg" class="input highlight"> <md-option *ngFor="let bg of backgrounds" [value]="bg"> <span>{{ bg }}</span> </md-option> </md-select> </md-list-item> <md-list-item style="color:#80cadc"> <h4 md-line>Show visual aids</h4> <md-slide-toggle md-line color="primary" class="input" style="padding-top:5px" [(ngModel)]="showVisualAids"> </md-slide-toggle> </md-list-item> <md-list-item style="color:#80cadc"> <h4 md-line>Animation length ( in seconds )</h4> <input md-line placeholder="Animation length" type="number" class="input" [(ngModel)]="animationLength">  </md-list-item> <md-list-item style="color:#80cadc;margin-top:20px"> <h4 md-line>Set player names assignable to pilot and crew positions on a ship.</h4> <button md-line md-button color="primary" style="background:rgba(6,70,102,.4);margin-top:10px;width:200px" (click)="manageCrew()" [disabled]="!shipService.isUnlocked()"> <md-icon md-tooltip="Click here to add players.">airline_seat_recline_extra</md-icon> <span>Crew Management</span> </button> </md-list-item> </md-list> <p *ngIf="!shipService.isConnected()"> Trying to load tactical plan data... </p> <div style="width:auto;margin:0 auto;padding:20px"> <button md-button style="background-color:#80cadc;color:rgba(6,70,102,1);width:250px;height:60px;font:32px/36px Electrolize" (click)="saveSettings()">Save</button> </div> </div> <div class="card-corner card-corner-top"></div> <div class="card-corner card-corner-bottom"></div> </md-card> </div>'},function(e,t,n){var r=n(817);e.exports="string"==typeof r?r:r.toString()},function(e,t,n){t=e.exports=n(71)(void 0),t.push([e.i,'.border{padding:20px}.container{padding:0;background:rgba(6,70,102,.4);color:#99e3f5;margin:0;margin-left:20px;margin-right:20px;min-width:660px}.content{padding:24px;text-align:center}.input{font:16px/20px Electrolize;margin:20px;width:200px;padding:5px}.highlight{background-color:rgba(153,227,245,.6);color:#000;-moz-border-radius:10px;border-radius:10px}.card-corner{position:absolute;width:100%}.card-corner:before{left:0}.card-corner:after{right:0}.card-corner-top{top:0}.card-corner-top:before{border-width:1px 0 0 1px}.card-corner-top:after{border-width:1px 1px 0 0}.card-corner:after,.card-corner:before{top:0;content:"";position:absolute;width:8px;height:8px;border-color:#00edff;border-style:solid}.card-corner-bottom{bottom:9px}.card-corner-bottom:before{border-width:0 0 1px 1px}.card-corner-bottom:after{border-width:0 1px 1px 0}.link{color:#00edff}',""])},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=n(36),a=n(300),s=n(301),c=n(104),l=n(302),u=n(303),h=[{path:"",redirectTo:"/welcome",pathMatch:"full"},{path:"welcome",component:l.WelcomeComponent},{path:"inventory",children:[{path:"",component:a.InventoryComponent},{path:"add-ship/:size",component:s.AddShipComponent}]},{path:"welcome",component:l.WelcomeComponent},{path:"settings",component:u.SettingsComponent},{path:"simulator",component:c.SimulatorComponent},{path:"**",component:a.InventoryComponent}],d=function(){function e(){}return e=r([i.NgModule({imports:[o.RouterModule.forRoot(h)],exports:[o.RouterModule]})],e)}();t.AppRoutingModule=d}],[733]);
//# sourceMappingURL=app.2e3a88cc070f1f18914d.js.map
