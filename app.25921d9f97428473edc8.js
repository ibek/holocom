webpackJsonp([1],{101:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(660),r=function(){function e(){this.origin=new n.Ship,this.amount=0,this.instances=[]}return e.prototype.add=function(e){this.instances.push(e)},e}();t.ShipData=r;var s=function(){function e(){}return e}();t.ShipDataInstance=s},138:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(40),a=i(221),c=function(){function e(e){this.route=e,this.shipModels3d=new Map}return e.prototype.addShipModelFor=function(e,t){if(!this.shipModels3d.has(t.origin.type)){var i=new a.ShipModel3D(t);this.shipModels3d.set(t.origin.type,i),i.load(e)}},e.prototype.loadingProgress=function(){var e=100;if(console.log(this.shipModels3d.size),0==this.shipModels3d.size)return e;var t=e/this.shipModels3d.size,i=0;return this.shipModels3d.forEach(function(n,r){n.isLoaded()?i++:e-=t}),i==this.shipModels3d.size?100:e},e=n([s.Injectable(),r("design:paramtypes",[o.ActivatedRoute])],e)}();t.SceneService=c},221:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(41),r=i(41),s=i(661),o=i(101),a=function(){function e(e){this.data=e,this.first=!0,this.objects=[]}return e.init=function(){e.stepSize=10,e.currentZ=30,e.currentX=0},e.prototype.init=function(){if(this.model.children.length>3&&this.model.children.splice(3,this.model.children.length-3),this.data.instances.length!==this.data.amount)for(var t=this.data.instances.length;t<this.data.amount;t++){var i=new o.ShipDataInstance,n=e.getNextPosition();i.position=n,this.data.add(i)}},e.prototype.isLoaded=function(){return void 0!==this.model},e.prototype.load=function(e){var t=new s.GLTF2Loader,i=this;t.load(e,function(e){console.log(e.scene),i.model=e.scene,i.model.children[0].name=i.data.origin.type})},e.prototype.addShipsToScene=function(e){for(var t=0;t<this.data.amount;t++){var i=this.data.instances[t];this.addShipTo(e,t,i.position,this.data.origin.scale)}},e.prototype.addShipTo=function(e,t,i,n){var s=this,o=new r.MeshStandardMaterial({color:65535,metalness:1,roughness:.7,transparent:!0,opacity:.4,side:r.DoubleSide});if(void 0==e.getObjectByName(this.data.origin.type)){var a=s.model.children[0];a.scale.set(n,n,n),a.position.set(i.x,i.y,i.z),a.rotation.z=Math.PI,a.children[0].geometry.computeBoundingSphere(),"L"==this.data.origin.size&&(o.opacity=.6),a.children[0].material=o,a.userData.id=t,a.userData.shipData=this.data,a.children.length,this.objects.push(a.children[0]),e.add(s.model)}else{var c=s.model.children[0].clone(!1),l=new r.Mesh(s.model.children[0].children[0].geometry,o);c.position.set(i.x,i.y,i.z),c.scale.set(n,n,n),c.add(l),this.objects.push(l),c.userData.id=t,c.userData.shipData=this.data,s.model.add(c)}console.log(e)},e.getNextPosition=function(){var t=e.currentX,i=e.currentZ;return e.currentX=e.currentX+e.stepSize,e.currentX+e.currentZ>30&&(e.currentX=-e.currentX,e.currentZ-=e.stepSize),new n.Vector3(-t,1,i)},e.stepSize=10,e.currentZ=30,e.currentX=0,e}();t.ShipModel3D=a},222:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(135),a=i(0),c=i(40),l=i(62),u=function(){function e(e,t,i,n){this.shipService=e,this.observableMedia=t,this.route=i,this.router=n,this.ships=[]}return e.prototype.ngOnInit=function(){var e=this;this.shipService.getShips().then(function(t){return e.ships=t}),this.observableMedia.isActive("xs")?this.cols=a.Observable.of(2):this.observableMedia.isActive("sm")?this.cols=a.Observable.of(3):this.observableMedia.isActive("md")?this.cols=a.Observable.of(5):this.observableMedia.isActive("lg")?this.cols=a.Observable.of(6):this.observableMedia.isActive("x1")&&(this.cols=a.Observable.of(7)),this.observableMedia.asObservable().subscribe(function(t){switch(t.mqAlias){case"xs":return e.cols=a.Observable.of(2);case"sm":return e.cols=a.Observable.of(3);case"md":return e.cols=a.Observable.of(5);case"lg":return e.cols=a.Observable.of(6);case"xl":return e.cols=a.Observable.of(7)}})},e.prototype.filterSize=function(e,t){return e.filter(function(e){return e.origin.size==t})},e.prototype.addS=function(){this.router.navigate(["inventory/add-ship/S"],this.shipService.getNavigationExtras())},e.prototype.addM=function(){this.router.navigate(["inventory/add-ship/M"],this.shipService.getNavigationExtras())},e.prototype.addL=function(){this.router.navigate(["inventory/add-ship/L"],this.shipService.getNavigationExtras())},e=n([s.Component({selector:"inventory",template:i(666),styles:[i(667)]}),r("design:paramtypes",[l.ShipService,o.ObservableMedia,c.ActivatedRoute,c.Router])],e)}();t.InventoryComponent=u},223:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(40),a=i(101),c=i(62),l=function(){function e(e,t,i){this.shipService=e,this.router=t,this.route=i,this.models=[],this.size="S",this.typeExistsError=!1}return e.prototype.ngOnInit=function(){var e=this;this.shipService.getModels().then(function(t){return e.models=t.sort(function(e,t){return e.type>t.type?1:-1})}),this.route.params.subscribe(function(t){return e.size=t.size})},e.prototype.onShipTypeChange=function(){this.typeExistsError=!1},e.prototype.goBack=function(){this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.addShip=function(){var e=new a.ShipData;e.origin=this.selectedModel,e.amount=1,this.shipService.addShip(e)?this.router.navigate(["inventory"],this.shipService.getNavigationExtras()):this.typeExistsError=!0},e.prototype.filterSize=function(e){var t=this;return e.filter(function(e){return e.size==t.size})},e=n([s.Component({selector:"add-ship",template:i(673),styles:[i(674)]}),r("design:paramtypes",[c.ShipService,o.Router,o.ActivatedRoute])],e)}();t.AddShipComponent=l},224:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(132),a=i(41),c=i(41),l=i(40),u=i(221),h=i(138),p=i(62),d=i(676),f=function(){function e(e,t,i){this.sceneService=e,this.shipService=t,this.router=i,this.loadingProgress=0,this.loaded=!1,this.screenWidth=window.innerWidth-20,this.screenHeight=window.innerHeight-85,this.scene=new a.Scene,this.camera=new a.PerspectiveCamera(60,this.screenWidth/this.screenHeight,10,500),this.renderer=new a.WebGLRenderer({antialias:!0}),this.gridScene=new a.Scene,this.gridCamera=new a.PerspectiveCamera(60,this.screenWidth/this.screenHeight,.1,300),this.bgScene=new c.Scene,this.bgCam=new c.Camera,this.objects=[],this.tanFOV=Math.tan(Math.PI/180*this.camera.fov/2),this.windowHeight=window.innerHeight}return e.prototype.ngAfterViewInit=function(){window.onerror=function(){},this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.screenWidth,this.screenHeight),this.renderer.domElement.style.position="relative",this.renderer.setClearColor(15658734),this.configureCamera(),this.configureLight(),this.scene.add(this.directionalLight),this.scene.add(new a.AmbientLight(new a.Color(.7,.7,.7).getHex())),this.gridScene.add(new a.AmbientLight(new a.Color(1,1,1).getHex())),this.addBackground(),this.addGrid(),this.configureControls(),this.start()},e.prototype.addBackground=function(){var e=c.ImageUtils.loadTexture("assets/images/background.png"),t=new c.Mesh(new c.PlaneGeometry(2,2,0),new c.MeshBasicMaterial({map:e}));t.material.depthTest=!1,t.material.depthWrite=!1,this.bgScene.add(this.bgCam),this.bgScene.add(t)},e.prototype.addGrid=function(){var e,t;e=c.ImageUtils.loadTexture("assets/images/grid.png"),e.wrapS=c.RepeatWrapping,e.wrapT=c.RepeatWrapping,e.repeat.set(30,30),t=new c.MeshLambertMaterial({map:e,transparent:!0,opacity:1}),this.grid=new c.Mesh(new c.PlaneGeometry(180,120),t),this.grid.material.side=c.DoubleSide,this.grid.rotation.x=Math.PI/2,this.grid.position.y=-1,this.grid.position.z=0,this.gridScene.add(this.grid)},e.prototype.configureLight=function(){this.directionalLight=new a.DirectionalLight(16777215),this.directionalLight.position.set(0,1e3,0),this.directionalLight.lookAt(new a.Vector3(0,0,0))},e.prototype.configureCamera=function(){this.camera.position.x=0,this.camera.position.y=110,this.camera.position.z=-80,this.camera.lookAt(new a.Vector3(0,0,0)),this.gridCamera.position.x=0,this.gridCamera.position.y=110,this.gridCamera.position.z=-80,this.gridCamera.lookAt(new a.Vector3(0,0,0))},e.prototype.configureControls=function(){this.controls=new d.ObjectControls(this.camera,this.renderer.domElement,this.container,this.objects,this.grid,this.scene),this.controls.fixed.y=1;var e=this;this.controls.move=function(){this.container.style.cursor="move"},this.controls.mouseup=function(){this.container.style.cursor="auto",e.router.navigate(["simulator"],e.shipService.getNavigationExtras())},this.controls.onclick=function(){},this.controls.activate()},e.prototype.render=function(){var e=this;requestAnimationFrame(function(){return e.render()}),this.controls.update(),this.renderer.autoClear=!1,this.renderer.clear(),this.renderer.render(this.bgScene,this.bgCam),this.renderer.render(this.gridScene,this.gridCamera),this.renderer.render(this.scene,this.camera),this.controls.updateAfter(this.screenWidth,this.screenHeight)},e.prototype.start=function(){var e=this;this.shipService.getShips().then(function(t){e.loadingProgress=e.sceneService.loadingProgress(),console.log(e.loadingProgress);var i=e;100==e.loadingProgress?(e.loaded=!0,e.container.nativeElement.appendChild(e.renderer.domElement),u.ShipModel3D.init(),e.sceneService.shipModels3d.forEach(function(e,t){e.init(),e.addShipsToScene(i.scene),e.objects.forEach(function(e){return i.objects.push(e)})}),e.render()):setTimeout(function(){i.start()},500)})},e.prototype.showInfo=function(){this.shipData=this.controls.selected.parent.userData.shipData.origin,this.shipInfoBar.toggle()},e.prototype.onCloseShipInfo=function(){this.controls.hideSelected()},e.prototype.saveImage=function(){this.controls.hideSelected(),this.render();var e=this.renderer.domElement.toDataURL(),t=document.createElement("a");t.href=e.replace("image/png","image/octet-stream"),t.download="tactical-plan.png",t.click()},e.prototype.toggleFullscreen=function(){var e=window.document,t=e.documentElement;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},e.prototype.onResize=function(e){this.screenWidth=window.innerWidth-5,this.screenHeight=window.innerHeight-40,this.camera.aspect=this.screenWidth/this.screenHeight,this.camera.fov=360/Math.PI*Math.atan(this.tanFOV*(this.screenHeight/this.windowHeight)),this.camera.updateProjectionMatrix(),this.camera.lookAt(this.scene.position),this.renderer.setSize(this.screenWidth,this.screenHeight)},n([s.ViewChild("container"),r("design:type",Object)],e.prototype,"container",void 0),n([s.ViewChild("shipInfo"),r("design:type",o.MdSidenav)],e.prototype,"shipInfoBar",void 0),n([s.HostListener("window:resize",["$event"]),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],e.prototype,"onResize",null),e=n([s.Component({selector:"simulator",template:i(679),styles:[i(680)]}),r("design:paramtypes",[h.SceneService,p.ShipService,l.Router])],e)}();t.SimulatorComponent=f},62:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(40),a=i(41),c=i(101),l=i(138),u=function(){function e(e,t){this.sceneService=e,this.route=t,this.ships=[],this.models=new Map,this.modelsArray=[{type:"F7C Hornet",size:"S",scale:.003,maxcrew:1,cargo:13},{type:"Caterpillar",size:"M",scale:.0025,maxcrew:5,cargo:512},{type:"Reclaimer",size:"L",scale:.003,maxcrew:5,cargo:6555},{type:"Aurora LN",size:"S",scale:.003,maxcrew:1,cargo:13},{type:"Sabre",size:"S",scale:.003,maxcrew:1,cargo:0},{type:"Avenger Stalker",size:"S",scale:.03,maxcrew:1,cargo:4},{type:"Herald",size:"S",scale:.003,maxcrew:2,cargo:0},{type:"Constellation Andromeda",size:"M",scale:.003,maxcrew:5,cargo:134},{type:"Prospector",size:"S",scale:.003,maxcrew:1,cargo:128},{type:"Gladius",size:"S",scale:.003,maxcrew:1,cargo:0}];for(var i=0,n=this.modelsArray;i<n.length;i++){var r=n[i];this.models[r.type]=r}}return e.prototype.getImage=function(e){return"assets/ships/thumbnails/"+e.type+".png"},e.prototype.getModel3d=function(e){return"assets/ships/"+e.type+".gltf"},e.prototype.addShip=function(e){for(var t=!1,i=0,n=this.ships;i<n.length;i++){if(n[i].origin.type==e.origin.type){t=!0;break}}return!t&&(this.ships.push(e),this.sceneService.addShipModelFor(this.getModel3d(e.origin),e),!0)},e.prototype.deleteShip=function(e){var t=this.ships.indexOf(e);-1!==t&&this.ships.splice(t,1)},e.prototype.getShips=function(){var e=this;return 0==this.ships.length&&this.route.queryParams.subscribe(function(t){var i=t.ships;if(i)for(var n=i.split(","),r=0;r+2<n.length;r+=3){var s=n[r],o=n[r+1],l=n[r+2],u=e.models[s],h=new c.ShipData;h.origin.type=s,h.origin=u,h.amount=Number(o);for(var p=l.split(";"),d=0;d<p.length;d++){var f=p[d].split(":");if(2!==f.length)break;var m=new c.ShipDataInstance;m.position=new a.Vector3(Number(f[0]),1,Number(f[1])),h.add(m)}e.addShip(h)}}),Promise.resolve(this.ships)},e.prototype.getNavigationExtras=function(){for(var e="",t=0,i=this.ships;t<i.length;t++){var n=i[t],r="";n.instances.forEach(function(e){r+=e.position.x+":"+e.position.z+";"}),e+=n.origin.type+","+String(n.amount)+","+r+","}return{queryParams:{ships:e},queryParamsHandling:"merge"}},e.prototype.getModels=function(){return Promise.resolve(this.modelsArray)},e.prototype.getShipsSlowly=function(){var e=this;return new Promise(function(t){setTimeout(function(){return t(e.getShips())},2e3)})},e.prototype.getShip=function(e){return this.getShips().then(function(t){return t.find(function(t){return t.origin.type===e})})},e=n([s.Injectable(),r("design:paramtypes",[l.SceneService,o.ActivatedRoute])],e)}();t.ShipService=u},657:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(183),r=i(11),s=i(658);r.enableProdMode(),n.platformBrowserDynamic().bootstrapModule(s.AppModule)},658:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:!0});var r=i(11),s=i(202),o=i(32),a=i(132),c=i(125),l=i(199),u=i(135),h=i(46),p=i(659),d=i(222),f=i(669),m=i(223),v=i(224),g=i(138),y=i(62),S=i(682);i(683);var b=function(){function e(){}return e=n([r.NgModule({imports:[o.BrowserModule,a.MaterialModule,l.FormsModule,c.HttpModule,s.BrowserAnimationsModule,u.FlexLayoutModule,S.AppRoutingModule],declarations:[p.AppComponent,d.InventoryComponent,f.ShipCardComponent,m.AddShipComponent,v.SimulatorComponent],providers:[{provide:h.LocationStrategy,useClass:h.HashLocationStrategy},g.SceneService,y.ShipService],bootstrap:[p.AppComponent]})],e)}();t.AppModule=b},659:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(40),a=i(62);i(662);var c=function(){function e(e,t){this.shipService=e,this.router=t}return e.prototype.inventory=function(){this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.simulator=function(){this.router.navigate(["simulator"],this.shipService.getNavigationExtras())},e=n([s.Component({selector:"holocom",template:i(663),styles:[i(664)]}),r("design:paramtypes",[a.ShipService,o.Router])],e)}();t.AppComponent=c},660:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e}();t.Ship=n},661:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(41),r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_COMMON:"KHR_materials_common",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_TECHNIQUE_WEBGL:"KHR_technique_webgl"},s="glTF",o=12,a={JSON:1313821514,BIN:5130562},c=function(){function e(e){this.manager=void 0!==e?e:n.DefaultLoadingManager}return e.prototype.load=function(e,t,i,r){var s=this,o=this.path&&"string"==typeof this.path?this.path:n.Loader.prototype.extractUrlBase(e),a=new n.FileLoader(s.manager);a.setResponseType("arraybuffer"),a.load(e,function(e){s.parse(e,t,o)},i,r)},e.prototype.setCrossOrigin=function(e){this.crossOrigin=e},e.prototype.setPath=function(e){this.path=e},e.prototype.parse=function(e,t,i){var n,o={};I.convertUint8ArrayToString(new Uint8Array(e,0,4))===s?(o[r.KHR_BINARY_GLTF]=new d(e),n=o[r.KHR_BINARY_GLTF].content):n=I.convertUint8ArrayToString(new Uint8Array(e));var a=JSON.parse(n);a.extensionsUsed&&(a.extensionsUsed.indexOf(r.KHR_LIGHTS)>=0&&(o[r.KHR_LIGHTS]=new h(a)),a.extensionsUsed.indexOf(r.KHR_MATERIALS_COMMON)>=0&&(o[r.KHR_MATERIALS_COMMON]=new p(a)),a.extensionsUsed.indexOf(r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new m),a.extensionsUsed.indexOf(r.KHR_TECHNIQUE_WEBGL)>=0&&(o[r.KHR_TECHNIQUE_WEBGL]=new f(a))),console.time("GLTF2Loader"),new P(a,o,{path:i||this.path,crossOrigin:this.crossOrigin}).parse(function(e,i,n,r){console.timeEnd("GLTF2Loader"),t({scene:e,scenes:i,cameras:n,animations:r})})},e}();t.GLTF2Loader=c;var l=function(){function e(){}return e.prototype.get=function(e){return this.objects[e]},e.prototype.add=function(e,t){this.objects[e]=t},e.prototype.remove=function(e){delete this.objects[e]},e.prototype.removeAll=function(){this.objects={}},e.prototype.update=function(e,t){for(var i in this.objects){var n=this.objects[i];n.update&&n.update(e,t)}},e}();t.GLTFRegistry=l;var u=function(){function e(e,t){var i={},r=e.material.uniforms;for(var s in r){var o=r[s];if(o.semantic){var a=o.node,c=e;a&&(c=t[a]),i[s]={semantic:o.semantic,sourceNode:c,targetNode:e,uniform:o}}}this.boundUniforms=i,this._m4=new n.Matrix4}return e.prototype.update=function(e,t){var i=this.boundUniforms;for(var n in i){var r=i[n];switch(r.semantic){case"MODELVIEW":var s=r.uniform.value;s.multiplyMatrices(t.matrixWorldInverse,r.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var o=r.uniform.value;this._m4.multiplyMatrices(t.matrixWorldInverse,r.sourceNode.matrixWorld),o.getNormalMatrix(this._m4);break;case"PROJECTION":var s=r.uniform.value;s.copy(t.projectionMatrix);break;case"JOINTMATRIX":for(var a=r.uniform.value,c=0;c<a.length;c++)a[c].getInverse(r.sourceNode.matrixWorld).multiply(r.targetNode.skeleton.bones[c].matrixWorld).multiply(r.targetNode.skeleton.boneInverses[c]).multiply(r.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+r.semantic)}}},e}();t.GLTFShader=u;var h=function(){function e(e){this.name=r.KHR_LIGHTS,this.lights={};var t=e.extensions&&e.extensions[r.KHR_LIGHTS]||{},i=t.lights||{};for(var s in i){var o,a=i[s],c=(new n.Color).fromArray(a.color);switch(a.type){case"directional":o=new n.DirectionalLight(c),o.position.set(0,0,1);break;case"point":o=new n.PointLight(c);break;case"spot":o=new n.SpotLight(c),o.position.set(0,0,1);break;case"ambient":o=new n.AmbientLight(c)}o&&(void 0!==a.constantAttenuation&&(o.intensity=a.constantAttenuation),void 0!==a.linearAttenuation&&(o.distance=1/a.linearAttenuation),void 0!==a.quadraticAttenuation&&(o.decay=a.quadraticAttenuation),void 0!==a.fallOffAngle&&(o.angle=a.fallOffAngle),void 0!==a.fallOffExponent&&console.warn("GLTF2Loader: light.fallOffExponent not currently supported."),o.name=a.name||"light_"+s,this.lights[s]=o)}}return e}();t.GLTFLightsExtension=h;var p=function(){function e(e){this.name=r.KHR_MATERIALS_COMMON}return e.prototype.getMaterialType=function(e){switch(e.extensions[this.name].type){case"commonBlinn":case"commonPhong":return n.MeshPhongMaterial;case"commonLambert":return n.MeshLambertMaterial;case"commonConstant":default:return n.MeshBasicMaterial}},e.prototype.extendParams=function(e,t,i){var r=t.extensions[this.name],s=[];switch(r.type){case"commonBlinn":case"commonPhong":s.push("diffuseFactor","diffuseTexture","specularFactor","specularTexture","shininessFactor");break;case"commonLambert":s.push("diffuseFactor","diffuseTexture")}var o={};s.forEach(function(e){void 0!==r[e]&&(o[e]=r[e])}),void 0!==o.diffuseFactor&&(e.color=(new n.Color).fromArray(o.diffuseFactor),e.opacity=o.diffuseFactor[3]),void 0!==o.diffuseTexture&&(e.map=i.textures[o.diffuseTexture.index]),void 0!==o.specularFactor&&(e.specular=(new n.Color).fromArray(o.specularFactor)),void 0!==o.specularTexture&&(e.specularMap=i.textures[o.specularTexture.index]),void 0!==o.shininessFactor&&(e.shininess=o.shininessFactor)},e}();t.GLTFMaterialsCommonExtension=p;var d=function(){function e(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,o);if(this.header={magic:I.convertUint8ArrayToString(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==s)throw new Error("GLTF2Loader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTF2Loader: Legacy binary file detected. Use GLTFLoader instead.");for(var i=new DataView(e,o),n=0;n<i.byteLength;){var c=i.getUint32(n,!0);n+=4;var l=i.getUint32(n,!0);if(n+=4,l===a.JSON){var u=new Uint8Array(e,o+n,c);this.content=I.convertUint8ArrayToString(u)}else if(l===a.BIN){var h=o+n;this.body=e.slice(h,h+c)}n+=c}if(null===this.content)throw new Error("GLTF2Loader: JSON content not found.")}return e}();t.GLTFBinaryExtension=d;var f=function(){function e(e){this.name=r.KHR_TECHNIQUE_WEBGL;var t=e.extensions&&e.extensions[r.KHR_TECHNIQUE_WEBGL]||{};this.techniques=t.techniques||{},this.programs=t.programs||{},this.shaders=t.shaders||{}}return e.prototype.getMaterialType=function(){return F},e.prototype.extendParams=function(e,t,i){var s=t[r.KHR_TECHNIQUE_WEBGL],o=i.techniques[s.technique];e.uniforms={};var a=i.programs[o.program];if(void 0!==a){if(e.fragmentShader=i.shaders[a.fragmentShader],!e.fragmentShader)throw new Error("ERROR: Missing fragment shader definition:"+a.fragmentShader);var c=i.shaders[a.vertexShader];if(!c)throw new Error("ERROR: Missing vertex shader definition:"+a.vertexShader);e.vertexShader=I.replaceTHREEShaderAttributes(c,o);var l=o.uniforms;for(var u in l){var h=l[u],p=o.parameters[h],d=p.type;if(!g[d])throw new Error("Unknown shader uniform param type: "+d);var f,m=p.count;void 0!==t.values&&(f=t.values[h]);var y=new g[d],S=p.semantic,b=p.node;switch(d){case v.FLOAT:y=p.value,"transparency"===h&&(e.transparent=!0),void 0!==f&&(y=f);break;case v.FLOAT_VEC2:case v.FLOAT_VEC3:case v.FLOAT_VEC4:case v.FLOAT_MAT3:p&&p.value&&y.fromArray(p.value),f&&y.fromArray(f);break;case v.FLOAT_MAT4:if(m){y=new Array(m);for(var M=0;M<m;M++)y[M]=new g[d];if(p&&p.value){var x=p.value;y.fromArray(x)}f&&y.fromArray(f)}else{if(p&&p.value){var A=p.value;y.fromArray(A)}f&&y.fromArray(f)}break;case v.SAMPLER_2D:y=void 0!==f?i.textures[f]:void 0!==p.value?i.textures[p.value]:null}e.uniforms[u]={value:y,semantic:S,node:b}}for(var R=o.states||{},L=R.enable||[],C=R.functions||{},F=!1,P=!1,D=!1,N=0,H=L.length;N<H;N++){var j=L[N];switch(O[j]){case"CULL_FACE":F=!0;break;case"DEPTH_TEST":P=!0;break;case"BLEND":D=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+j)}}e.side=F?void 0!==C.cullFace?T[C.cullFace]:n.FrontSide:n.DoubleSide,e.depthTest=P,e.depthFunc=void 0!==C.depthFunc?E[C.depthFunc]:n.LessDepth,e.depthWrite=void 0===C.depthMask||C.depthMask[0],e.blending=D?n.CustomBlending:n.NoBlending,e.transparent=D;var z=C.blendEquationSeparate;void 0!==z?(e.blendEquation=w[z[0]],e.blendEquationAlpha=w[z[1]]):(e.blendEquation=n.AddEquation,e.blendEquationAlpha=n.AddEquation);var k=C.blendFuncSeparate;void 0!==k?(e.blendSrc=_[k[0]],e.blendDst=_[k[1]],e.blendSrcAlpha=_[k[2]],e.blendDstAlpha=_[k[3]]):(e.blendSrc=n.OneFactor,e.blendDst=n.ZeroFactor,e.blendSrcAlpha=n.OneFactor,e.blendDstAlpha=n.ZeroFactor)}},e}();t.GLTFTechniqueWebglExtension=f;var m=function(){function e(){this.name=r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS}return e.prototype.getMaterialType=function(){return n.ShaderMaterial},e.prototype.extendParams=function(e,t,i){var r=t.extensions[this.name],s=n.ShaderLib.standard,o=n.UniformsUtils.clone(s.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),c=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),p=s.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",c).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",h);if(delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new n.Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=s.vertexShader,e.fragmentShader=p,e.uniforms=o,e.defines={STANDARD:""},e.color=new n.Color(1,1,1),e.opacity=1,Array.isArray(r.diffuseFactor)){var d=r.diffuseFactor;e.color.fromArray(d),e.opacity=d[3]}void 0!==r.diffuseTexture&&(e.map=i.textures[r.diffuseTexture.index]),e.emissive=new n.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new n.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture&&(e.glossinessMap=i.textures[r.specularGlossinessTexture.index],e.specularMap=i.textures[r.specularGlossinessTexture.index])},e.prototype.createMaterial=function(e){var t=new n.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalScale=new n.Vector2(1,1),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},e.prototype.refreshUniforms=function(e,t,i,n,r,s){var o=r.uniforms,a=r.defines;o.opacity.value=r.opacity,o.diffuse.value.copy(r.color),o.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),o.map.value=r.map,o.specularMap.value=r.specularMap,o.alphaMap.value=r.alphaMap,o.lightMap.value=r.lightMap,o.lightMapIntensity.value=r.lightMapIntensity,o.aoMap.value=r.aoMap,o.aoMapIntensity.value=r.aoMapIntensity;var c;if(r.map?c=r.map:r.specularMap?c=r.specularMap:r.displacementMap?c=r.displacementMap:r.normalMap?c=r.normalMap:r.bumpMap?c=r.bumpMap:r.glossinessMap?c=r.glossinessMap:r.alphaMap?c=r.alphaMap:r.emissiveMap&&(c=r.emissiveMap),void 0!==c){c.isWebGLRenderTarget&&(c=c.texture);var l=c.offset,u=c.repeat;o.offsetRepeat.value.set(l.x,l.y,u.x,u.y)}o.envMap.value=r.envMap,o.envMapIntensity.value=r.envMapIntensity,o.flipEnvMap.value=r.envMap&&r.envMap.isCubeTexture?-1:1,o.refractionRatio.value=r.refractionRatio,o.specular.value.copy(r.specular),o.glossiness.value=r.glossiness,o.glossinessMap.value=r.glossinessMap,o.emissiveMap.value=r.emissiveMap,o.bumpMap.value=r.bumpMap,o.normalMap.value=r.normalMap,o.displacementMap.value=r.displacementMap,o.displacementScale.value=r.displacementScale,o.displacementBias.value=r.displacementBias,null!==o.glossinessMap.value&&void 0===a.USE_GLOSSINESSMAP&&(a.USE_GLOSSINESSMAP="",a.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==a.USE_GLOSSINESSMAP&&(delete a.USE_GLOSSINESSMAP,delete a.USE_ROUGHNESSMAP)},e}();t.GLTFMaterialsPbrSpecularGlossinessExtension=m;var v={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},g={5126:Number,35675:n.Matrix3,35676:n.Matrix4,35664:n.Vector2,35665:n.Vector3,35666:n.Vector4,35678:n.Texture},y={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},S={9728:n.NearestFilter,9729:n.LinearFilter,9984:n.NearestMipMapNearestFilter,9985:n.LinearMipMapNearestFilter,9986:n.NearestMipMapLinearFilter,9987:n.LinearMipMapLinearFilter},b={33071:n.ClampToEdgeWrapping,33648:n.MirroredRepeatWrapping,10497:n.RepeatWrapping},M={6406:n.AlphaFormat,6407:n.RGBFormat,6408:n.RGBAFormat,6409:n.LuminanceFormat,6410:n.LuminanceAlphaFormat},x={5121:n.UnsignedByteType,32819:n.UnsignedShort4444Type,32820:n.UnsignedShort5551Type,33635:n.UnsignedShort565Type},T={1028:n.BackSide,1029:n.FrontSide},E={512:n.NeverDepth,513:n.LessDepth,514:n.EqualDepth,515:n.LessEqualDepth,516:n.GreaterEqualDepth,517:n.NotEqualDepth,518:n.GreaterEqualDepth,519:n.AlwaysDepth},w={32774:n.AddEquation,32778:n.SubtractEquation,32779:n.ReverseSubtractEquation},_={0:n.ZeroFactor,1:n.OneFactor,768:n.SrcColorFactor,769:n.OneMinusSrcColorFactor,770:n.SrcAlphaFactor,771:n.OneMinusSrcAlphaFactor,772:n.DstAlphaFactor,773:n.OneMinusDstAlphaFactor,774:n.DstColorFactor,775:n.OneMinusDstColorFactor,776:n.SrcAlphaSaturateFactor},A={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},R={scale:"scale",position:"position",rotation:"quaternion",weights:"morphTargetInfluences"},L={LINEAR:n.InterpolateLinear,STEP:n.InterpolateDiscrete},O={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"},C={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},I=function(){function e(){}return e.each=function(e,t,i){if(!e)return Promise.resolve();var n,r=[];if("[object Array]"===Object.prototype.toString.call(e)){n=[];for(var s=e.length,o=0;o<s;o++){var a=t.call(i||this,e[o],o);a&&(r.push(a),a instanceof Promise?a.then(function(e,t){n[e]=t}.bind(this,o)):n[o]=a)}}else{n={};for(var c in e)if(e.hasOwnProperty(c)){var a=t.call(i||this,e[c],c);a&&(r.push(a),a instanceof Promise?a.then(function(e,t){n[e]=t}.bind(this,c)):n[c]=a)}}return Promise.all(r).then(function(){return n})},e.resolveURL=function(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t||"")+e},e.convertUint8ArrayToString=function(e){for(var t="",i=0,n=e.length;i<n;i++)t+=String.fromCharCode(e[i]);return t},e.replaceTHREEShaderAttributes=function(e,t){var i={};for(var n in t.attributes){var r=t.attributes[n],s=t.parameters[r],o=s.type,a=s.semantic;i[n]={type:o,semantic:a}}var c=t.parameters,l=t.attributes,u={};for(var n in i){var r=l[n],h=c[r],a=h.semantic;a&&(u[n]=h)}var r;for(r in u){var s=u[r],a=s.semantic,p=new RegExp("\\b"+r+"\\b","g");switch(a){case"POSITION":e=e.replace(p,"position");break;case"NORMAL":e=e.replace(p,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":e=e.replace(p,"uv");break;case"TEXCOORD_1":e=e.replace(p,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":e=e.replace(p,"color");break;case"WEIGHTS_0":case"WEIGHT":e=e.replace(p,"skinWeight");break;case"JOINTS_0":case"JOINT":e=e.replace(p,"skinIndex")}}return e},e.createDefaultMaterial=function(){return new n.MeshPhongMaterial({color:0,side:n.DoubleSide})},e}(),F=function(){function e(e){this.isDeferredShaderMaterial=!0,this.params=e}return e.prototype.create=function(){var e=n.UniformsUtils.clone(this.params.uniforms);for(var t in this.params.uniforms){var i=this.params.uniforms[t];i.value instanceof n.Texture&&(e[t].value=i.value,e[t].value.needsUpdate=!0),e[t].semantic=i.semantic,e[t].node=i.node}return this.params.uniforms=e,new n.RawShaderMaterial(this.params)},e}(),P=function(){function e(e,t,i){this.json=e||{},this.extensions=t||{},this.options=i||{},this.cache=new l}return e.prototype.withDependencies=function(e){for(var t={},i=0;i<e.length;i++){var n=e[i],r="load"+n.charAt(0).toUpperCase()+n.slice(1),s=this.cache.get(n);if(void 0!==s)t[n]=s;else if(this[r]){var o=this[r]();this.cache.add(n,o),t[n]=o}}return I.each(t,function(e){return e})},e.prototype.parse=function(e){var t=this.json;this.cache.removeAll(),this.withDependencies(["scenes","cameras","animations"]).then(function(i){var n=[];for(var r in i.scenes)n.push(i.scenes[r]);var s=void 0!==t.scene?i.scenes[t.scene]:n[0],o=[];for(var r in i.cameras){var a=i.cameras[r];o.push(a)}var c=[];for(var r in i.animations)c.push(i.animations[r]);e(s,n,o,c)})},e.prototype.loadShaders=function(){var e=this.json,t=this.options,i=this.extensions;return this.withDependencies(["bufferViews"]).then(function(s){var o=void 0!==i[r.KHR_TECHNIQUE_WEBGL]?i[r.KHR_TECHNIQUE_WEBGL].shaders:e.shaders;return void 0===o&&(o={}),I.each(o,function(e){if(void 0!==e.bufferView){var i=s.bufferViews[e.bufferView],r=new Uint8Array(i);return I.convertUint8ArrayToString(r)}return new Promise(function(i){var r=new n.FileLoader;r.setResponseType("text"),r.load(I.resolveURL(e.uri,t.path),function(e){i(e)})})})})},e.prototype.loadBuffers=function(){var e=this.json,t=this.extensions,i=this.options;return I.each(e.buffers,function(e,s){if("arraybuffer"===e.type||void 0===e.type)return void 0===e.uri&&0===s?t[r.KHR_BINARY_GLTF].body:new Promise(function(t){var r=new n.FileLoader;r.setResponseType("arraybuffer"),r.load(I.resolveURL(e.uri,i.path),function(e){t(e)})});console.warn("THREE.GLTF2Loader: "+e.type+" buffer type is not supported")})},e.prototype.loadBufferViews=function(){var e=this.json;return this.withDependencies(["buffers"]).then(function(t){return I.each(e.bufferViews,function(e){var i=t.buffers[e.buffer],n=e.byteLength||0,r=e.byteOffset||0;return i.slice(r,r+n)})})},e.prototype.loadAccessors=function(){var e=this.json;return this.withDependencies(["bufferViews"]).then(function(t){return I.each(e.accessors,function(i){var r,s=t.bufferViews[i.bufferView],o=A[i.type],a=y[i.componentType],c=a.BYTES_PER_ELEMENT,l=c*o,u=e.bufferViews[i.bufferView].byteStride;if(u&&u!==l){r=new a(s);var h=new n.InterleavedBuffer(r,u/c);return new n.InterleavedBufferAttribute(h,o,i.byteOffset/c,!1)}return r=new a(s,i.byteOffset,i.count*o),new n.BufferAttribute(r,o)})})},e.prototype.loadTextures=function(){var e=this.json,t=this.options;return this.withDependencies(["bufferViews"]).then(function(i){return I.each(e.textures,function(r){if(void 0!==r.source)return new Promise(function(s){var o,a=e.images[r.source],c=a.uri;if(void 0!==a.bufferView){var l=i.bufferViews[a.bufferView],u=new Blob([l],{type:a.mimeType});o=window.URL,c=o.createObjectURL(u)}var h=n.Loader.Handlers.get(c);null===h&&(h=new n.TextureLoader),h.setCrossOrigin(t.crossOrigin),h.load(I.resolveURL(c,t.path),function(t){void 0!==o&&o.revokeObjectURL(c),t.flipY=!1,void 0!==r.name&&(t.name=r.name),t.format=void 0!==r.format?M[r.format]:n.RGBAFormat,void 0!==r.internalFormat&&t.format!==M[r.internalFormat]&&console.warn("THREE.GLTF2Loader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==r.type?x[r.type]:n.UnsignedByteType;var i=e.samplers||{},a=i[r.sampler]||{};t.magFilter=S[a.magFilter]||n.LinearFilter,t.minFilter=S[a.minFilter]||n.NearestMipMapLinearFilter,t.wrapS=b[a.wrapS]||n.RepeatWrapping,t.wrapT=b[a.wrapT]||n.RepeatWrapping,s(t)},void 0,function(){s()})})})})},e.prototype.loadMaterials=function(){var e=this.json,t=this.extensions;return this.withDependencies(["shaders","textures"]).then(function(i){return I.each(e.materials,function(e){var s,o={},a=e.extensions||{};if(a[r.KHR_MATERIALS_COMMON])s=t[r.KHR_MATERIALS_COMMON].getMaterialType(e),t[r.KHR_MATERIALS_COMMON].extendParams(o,e,i);else if(a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS])s=t[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].getMaterialType(e),t[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].extendParams(o,e,i);else if(a[r.KHR_TECHNIQUE_WEBGL])s=t[r.KHR_TECHNIQUE_WEBGL].getMaterialType(e),t[r.KHR_TECHNIQUE_WEBGL].extendParams(o,e,i);else if(void 0!==e.pbrMetallicRoughness){s=n.MeshStandardMaterial;var c=e.pbrMetallicRoughness;if(o.color=new n.Color(1,1,1),o.opacity=1,Array.isArray(c.baseColorFactor)){var l=c.baseColorFactor;o.color.fromArray(l),o.opacity=l[3]}if(void 0!==c.baseColorTexture&&(o.map=i.textures[c.baseColorTexture.index]),o.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,o.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture){var u=c.metallicRoughnessTexture.index;o.metalnessMap=i.textures[u],o.roughnessMap=i.textures[u]}}else s=n.MeshPhongMaterial;!0===e.doubleSided&&(o.side=n.DoubleSide);var h=e.alphaMode||C.OPAQUE;o.transparent=h!==C.OPAQUE,void 0!==e.normalTexture&&(o.normalMap=i.textures[e.normalTexture.index]),void 0!==e.occlusionTexture&&(o.aoMap=i.textures[e.occlusionTexture.index]),void 0!==e.emissiveFactor&&(s===n.MeshBasicMaterial?o.color=(new n.Color).fromArray(e.emissiveFactor):o.emissive=(new n.Color).fromArray(e.emissiveFactor)),void 0!==e.emissiveTexture&&(s===n.MeshBasicMaterial?o.map=i.textures[e.emissiveTexture.index]:o.emissiveMap=i.textures[e.emissiveTexture.index]);var p;return p=s===n.ShaderMaterial?t[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new s(o),void 0!==e.name&&(p.name=e.name),p})})},e.prototype.loadMeshes=function(){var e=this.json;return this.withDependencies(["accessors","materials"]).then(function(t){return I.each(e.meshes,function(e){var i=new n.Group;void 0!==e.name&&(i.name=e.name),e.extras&&(i.userData=e.extras);var r=e.primitives||[];for(var s in r){var o,a,c=r[s],l=void 0!==c.material?t.materials[c.material]:I.createDefaultMaterial();if(c.mode===v.TRIANGLES||void 0===c.mode){o=new n.BufferGeometry;var u=c.attributes;for(var h in u){var p=u[h];if(void 0===p)return;var d=t.accessors[p];switch(h){case"POSITION":o.addAttribute("position",d);break;case"NORMAL":o.addAttribute("normal",d);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":o.addAttribute("uv",d);break;case"TEXCOORD_1":o.addAttribute("uv2",d);break;case"COLOR_0":case"COLOR0":case"COLOR":o.addAttribute("color",d);break;case"WEIGHTS_0":case"WEIGHT":o.addAttribute("skinWeight",d);break;case"JOINTS_0":case"JOINT":o.addAttribute("skinIndex",d)}}if(void 0!==c.indices&&o.setIndex(t.accessors[c.indices]),void 0!==l.aoMap&&void 0===o.attributes.uv2&&void 0!==o.attributes.uv&&(console.log("GLTF2Loader: Duplicating UVs to support aoMap."),o.addAttribute("uv2",new n.BufferAttribute(o.attributes.uv.array,2))),a=new n.Mesh(o,l),a.castShadow=!0,void 0!==c.targets){var f=c.targets,m=o.morphAttributes;m.position=[],m.normal=[],l.morphTargets=!0;for(var g=0,y=f.length;g<y;g++){var S,b,M=f[g],x="morphTarget"+g;if(void 0!==M.POSITION){S=t.accessors[M.POSITION].clone();for(var T=o.attributes.position,E=0,w=S.array.length;E<w;E++)S.array[E]+=T.array[E]}else S=o.attributes.position.clone();if(void 0!==M.NORMAL){l.morphNormals=!0,b=t.accessors[M.NORMAL].clone();for(var _=o.attributes.normal,E=0,w=b.array.length;E<w;E++)b.array[E]+=_.array[E]}else b=o.attributes.normal.clone();M.TANGENT,S.name=x,b.name=x,m.position.push(S),m.normal.push(b)}if(a.updateMorphTargets(),void 0!==e.weights)for(var g=0,y=e.weights.length;g<y;g++)a.morphTargetInfluences[g]=e.weights[g]}}else{if(c.mode!==v.LINES)throw new Error("Only triangular and line primitives are supported");o=new n.BufferGeometry;var u=c.attributes;for(var h in u){var p=u[h];if(!p)return;var d=t.accessors[p];switch(h){case"POSITION":o.addAttribute("position",d);break;case"COLOR_0":case"COLOR0":case"COLOR":o.addAttribute("color",d)}}void 0!==c.indices?(o.setIndex(t.accessors[c.indices]),a=new n.LineSegments(o,l)):a=new n.Line(o,l)}void 0!==o.attributes.color&&(l.vertexColors=n.VertexColors,l.needsUpdate=!0),a.name="0"===s?i.name:i.name+s,c.extras&&(a.userData=c.extras),i.add(a)}return i})})},e.prototype.loadCameras=function(){var e=this.json;return I.each(e.cameras,function(e){var t;if("perspective"==e.type&&e.perspective){var i=e.perspective.yfov,r=void 0!==e.perspective.aspectRatio?e.perspective.aspectRatio:1,s=i*r;return t=new n.PerspectiveCamera(n.Math.radToDeg(s),r,e.perspective.znear||1,e.perspective.zfar||2e6),void 0!==e.name&&(t.name=e.name),e.extras&&(t.userData=e.extras),t}if("orthographic"==e.type&&e.orthographic)return t=new n.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,e.orthographic.znear,e.orthographic.zfar),void 0!==e.name&&(t.name=e.name),e.extras&&(t.userData=e.extras),t})},e.prototype.loadSkins=function(){var e=this.json;return this.withDependencies(["accessors"]).then(function(t){return I.each(e.skins,function(e){var i=new n.Matrix4;return void 0!==e.bindShapeMatrix&&i.fromArray(e.bindShapeMatrix),{bindShapeMatrix:i,joints:e.joints,inverseBindMatrices:t.accessors[e.inverseBindMatrices]}})})},e.prototype.loadAnimations=function(){var e=this.json;return this.withDependencies(["accessors","nodes"]).then(function(t){return I.each(e.animations,function(e,i){var r=[];for(var s in e.channels){var o=e.channels[s],a=e.samplers[o.sampler];if(a){var c=o.target,l=void 0!==c.node?c.node:c.id,u=void 0!==e.parameters?e.parameters[a.input]:a.input,h=void 0!==e.parameters?e.parameters[a.output]:a.output,p=t.accessors[u],d=t.accessors[h],f=t.nodes[l];if(f){f.updateMatrix(),f.matrixAutoUpdate=!0;var m;switch(R[c.path]){case R.weights:m=n.NumberKeyframeTrack;break;case R.rotation:m=n.QuaternionKeyframeTrack;break;case R.position:case R.scale:default:m=n.VectorKeyframeTrack}var v=f.name?f.name:f.uuid,g=void 0!==a.interpolation?L[a.interpolation]:n.InterpolateLinear,y=[];R[c.path]===R.weights?f.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&y.push(e.name?e.name:e.uuid)}):y.push(v);for(var S=0,b=y.length;S<b;S++)r.push(new m(y[S]+"."+R[c.path],n.AnimationUtils.arraySlice(p.array,0,void 0),n.AnimationUtils.arraySlice(d.array,0,void 0),g))}}}var l=void 0!==e.name?e.name:"animation_"+i;return new n.AnimationClip(l,void 0,r)})})},e.prototype.loadNodes=function(){var e=this.json,t=this.extensions,i=this,s=e.nodes||[],o=e.skins||[];return Array.from(o).forEach(function(e){e.joints.forEach(function(e){s[e].isBone=!0})}),I.each(e.nodes,function(e){var t=new n.Matrix4,i=!0===e.isBone?new n.Bone(void 0):new n.Object3D;return void 0!==e.name&&(i.name=e.name.replace(/\s/g,"_").replace(/[^\w-]/g,"")),e.extras&&(i.userData=e.extras),void 0!==e.matrix?(t.fromArray(e.matrix),i.applyMatrix(t)):(void 0!==e.translation&&i.position.fromArray(e.translation),void 0!==e.rotation&&i.quaternion.fromArray(e.rotation),void 0!==e.scale&&i.scale.fromArray(e.scale)),i}).then(function(s){return i.withDependencies(["meshes","skins","cameras"]).then(function(i){return I.each(s,function(o,a){var c,l=e.nodes[a];if(void 0!==l.mesh?c=[l.mesh]:void 0!==l.meshes&&(console.warn("GLTF2Loader: Legacy glTF file detected. Nodes may have no more than 1 mesh."),c=l.meshes),void 0!==c)for(var u in c){var h=c[u],p=i.meshes[h];if(void 0!==p)for(var d in p.children){var f,m=p.children[d],v=m.material,g=m.geometry,y=m.userData,S=m.name;switch(v.isDeferredShaderMaterial?v=f=v.create():f=v,m.type){case"LineSegments":m=new n.LineSegments(g,f);break;case"LineLoop":case"Line":m=new n.Line(g,f);break;default:m=new n.Mesh(g,f)}m.castShadow=!0,m.userData=y,m.name=S;var b;if(void 0!==l.skin&&(b=i.skins[l.skin]),b){var M=g;f=v,f.skinning=!0,m=new n.SkinnedMesh(M,f,!1),m.castShadow=!0,m.userData=y,m.name=S;for(var x=[],T=[],E=0,w=b.joints.length;E<w;E++){var _=b.joints[E],A=s[_];if(A){x.push(A);var R=b.inverseBindMatrices.array,L=(new n.Matrix4).fromArray(R,16*E);T.push(L)}else console.warn("WARNING: joint: '"+_+"' could not be found")}m.bind(new n.Skeleton(x,T,!1),b.bindShapeMatrix);var O=function(t,i,n){var r=t[n];if(void 0!==r)for(var o=0,a=r.length;o<a;o++){var c=r[o],l=s[c],u=e.nodes[c];void 0!==l&&!0===l.isBone&&void 0!==u&&(i.add(l),O(u,l,"children"))}};O(l,m,"skeletons")}o.add(m)}else console.warn("GLTF2Loader: Couldn't find node \""+h+'".')}if(void 0!==l.camera){var C=i.cameras[l.camera];o.add(C)}if(l.extensions&&l.extensions[r.KHR_LIGHTS]&&void 0!==l.extensions[r.KHR_LIGHTS].light){var I=t[r.KHR_LIGHTS].lights;o.add(I[l.extensions[r.KHR_LIGHTS].light])}return o})})})},e.prototype.loadScenes=function(){function e(i,n,r){var s=r[i];n.add(s);var o=t.nodes[i];if(o.children)for(var a=o.children,c=0,l=a.length;c<l;c++){var u=a[c];e(u,s,r)}}var t=this.json,i=this.extensions;return this.withDependencies(["nodes"]).then(function(s){return I.each(t.scenes,function(t){var o=new n.Scene;void 0!==t.name&&(o.name=t.name),t.extras&&(o.userData=t.extras);for(var a=t.nodes||[],c=0,l=a.length;c<l;c++){e(a[c],o,s.nodes)}if(o.traverse(function(e){e.material&&e.material.isRawShaderMaterial&&(e.gltfShader=new u(e,s.nodes),e.onBeforeRender=function(e,t,i){this.gltfShader.update(t,i)}),e.material&&"ShaderMaterial"===e.material.type&&(e.onBeforeRender=i[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}),t.extensions&&t.extensions[r.KHR_LIGHTS]&&void 0!==t.extensions[r.KHR_LIGHTS].light){var h=i[r.KHR_LIGHTS].lights;o.add(h[t.extensions[r.KHR_LIGHTS].light])}return o})})},e}()},662:function(e,t){},663:function(e,t){e.exports='<main> <md-toolbar> <span>UEE Tactical Communications Interface</span> <span class="spacer"></span> <button md-raised-button color="primary" routerLink="/inventory" routerLinkActive="inventoryActive" (click)="inventory()" skipLocationChange> <i class="material-icons">view_list</i> Inventory </button> <button md-raised-button color="primary" routerLink="/simulator" routerLinkActive="simulatorActive" (click)="simulator()" skipLocationChange> Simulate <i class="material-icons">play_circle_outline</i> </button> </md-toolbar> <router-outlet></router-outlet> </main>'},664:function(e,t,i){var n=i(665);e.exports="string"==typeof n?n:n.toString()},665:function(e,t,i){t=e.exports=i(61)(void 0),t.push([e.i,".spacer{flex:1 1 auto}.inventoryActive,.simulatorActive{display:none}",""])},666:function(e,t){e.exports='<div> <div class="ship-size-title">Small &lt;30m</div> <md-grid-list [cols]="cols | async" gutterSize="16px" rowHeight="300px" class="ships-small"> <md-grid-tile *ngFor="let s of filterSize(ships, \'S\')"> <ship-card [ship]="s"> </ship-card> </md-grid-tile> <md-grid-tile> <button md-fab color="none" (click)="addS()"><md-icon>add</md-icon></button> </md-grid-tile> </md-grid-list> <div class="ship-size-title">Medium &lt;100m</div> <md-grid-list [cols]="cols | async" gutterSize="16px" rowHeight="300px" class="ships-medium"> <md-grid-tile *ngFor="let s of filterSize(ships, \'M\')"> <ship-card [ship]="s"> </ship-card> </md-grid-tile> <md-grid-tile> <button md-fab color="none" (click)="addM()"><md-icon>add</md-icon></button> </md-grid-tile> </md-grid-list> <div class="ship-size-title">Large &gt;100m</div> <md-grid-list [cols]="cols | async" gutterSize="16px" rowHeight="300px" class="ships-large"> <md-grid-tile *ngFor="let s of filterSize(ships, \'L\')"> <ship-card [ship]="s"> </ship-card> </md-grid-tile> <md-grid-tile> <button md-fab color="none" (click)="addL()"><md-icon>add</md-icon></button> </md-grid-tile> </md-grid-list> </div>'},667:function(e,t,i){var n=i(668);e.exports="string"==typeof n?n:n.toString()},668:function(e,t,i){t=e.exports=i(61)(void 0),t.push([e.i,".ships-small{background-color:#ddd}.ships-medium{background-color:#aaa}.ships-large{background-color:#777}.ship-size-title{padding:10px;padding-left:30px;background-color:#333;color:#eee}",""])},669:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(11),o=i(40),a=i(101),c=i(62),l=function(){function e(e,t){this.shipService=e,this.router=t}return e.prototype.delete=function(e){this.shipService.deleteShip(this.ship),this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},e.prototype.onShipAmountChange=function(){this.router.navigate(["inventory"],this.shipService.getNavigationExtras())},n([s.Input(),r("design:type",a.ShipData)],e.prototype,"ship",void 0),e=n([s.Component({selector:"ship-card",template:i(670),styles:[i(671)]}),r("design:paramtypes",[c.ShipService,o.Router])],e)}();t.ShipCardComponent=l},670:function(e,t){e.exports='<md-card> <md-card-header> <md-card-title class="ship-title">{{ship.origin.type}}</md-card-title> <button md-icon-button [mdMenuTriggerFor]="configMenu" class="ship-menu"> <md-icon>more_vert</md-icon> </button> <md-menu #configMenu> <button md-menu-item (click)="delete($event)"> <md-icon>delete</md-icon> <span>Delete</span> </button> </md-menu> </md-card-header> <img md-card-image src="{{shipService.getImage(ship.origin)}}" class="ship-thumbnail"> <md-card-footer class="ship-amount"> <div style="display:inline-block;width:200px"> <md-slider max="5" min="1" step="1" [(ngModel)]="ship.amount" thumb-label="1" (change)="onShipAmountChange()"> </md-slider> <button md-mini-fab color="none" style="right:-5px">{{ship.amount}}</button> </div> </md-card-footer> </md-card>'},671:function(e,t,i){var n=i(672);e.exports="string"==typeof n?n:n.toString()},672:function(e,t,i){t=e.exports=i(61)(void 0),t.push([e.i,".ship-title{width:130px}.ship-thumbnail{width:200px;height:200px}.ship-menu{position:absolute;right:10px;top:10px}.ship-amount{width:0;bottom:0;left:10px}",""])},673:function(e,t){e.exports='<md-card class="ship-card"> <md-card-header> <md-card-title> <h3>Add Ship</h3> </md-card-title> </md-card-header> <md-card-content class="ship-content"> <form> <md-icon>star_rate</md-icon> <md-select placeholder="Ship Type" [(ngModel)]="selectedModel" name="ship" (change)="onShipTypeChange()"> <md-option *ngFor="let model of filterSize(models)" [value]="model"> {{model.type}} </md-option> </md-select> <md-hint [hidden]="!typeExistsError" style="color:red"> <div> This type of ship already exists in the Inventory </div> </md-hint> </form> <img md-card-image src="{{shipService.getImage(selectedModel)}}" class="ship-thumbnail" *ngIf="selectedModel"> </md-card-content> <md-card-footer class="ship-actions"> <button md-raised-button (click)="goBack()" class="ship-action-cancel">Cancel</button> <button md-raised-button (click)="addShip()" color="accent">Add</button> </md-card-footer> </md-card>'},674:function(e,t,i){var n=i(675);e.exports="string"==typeof n?n:n.toString()},675:function(e,t,i){t=e.exports=i(61)(void 0),t.push([e.i,".ship-card{width:300px;height:380px;margin:0 auto}.ship-content{padding:20px;text-align:center}.ship-thumbnail{margin-top:20px;width:200px;height:200px}.ship-actions{text-align:right}.ship-action-cancel{margin-right:10px}",""])},676:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(41),r=i(677),s=function(){function e(e,t,i,s,o,a){var c=this;this.camera=e,this.container=t,this.htmlContainer=i,this.objects=s,this.projectionMap=o,this.scene=a,this.fixed=new n.Vector3(0,0,0),this.displacing=!0,this._DisplaceFocused=null,this.focused=null,this.focusedpart=null,this._DisplaceMouseOvered=null,this.mouseovered=null,this.mouseoveredpart=null,this._mouse=new n.Vector2,this.enabled=!0,this.item=null,this._intersects=[],this.previous=new n.Vector3(0,0,0),this.moveScene=!1,this.x=0,this.z=0,this.lx=0,this.lz=0,this.moveMax=100,this.selected=null,this.pointer=new r.Pointer(this.camera),this.move=function(){this.container.style.cursor="move"},this.mouseover=function(){this.selected?this.container.style.cursor="move":this.container.style.cursor="pointer"},this.mouseout=function(){this.container.style.cursor="auto"},this.mouseup=function(){this.container.style.cursor="auto"},this.onclick=function(){},this.getMousePos=function(e){c.x=void 0==e.offsetX?e.layerX:e.offsetX,c.z=void 0==e.offsetY?e.layerY:e.offsetY;var t=c.container.getBoundingClientRect();return c._mouse.x=c.x/t.width*2-1,c._mouse.y=-c.z/t.height*2+1,new n.Vector3(c._mouse.x,c._mouse.y,.5)},this.onContainerMouseDown=function(e){if(c.selected){var t=c._rayGet();c._intersects=t.intersectObjects(c.objects,!0),c._intersects.length>0&&(c.setFocus(c._intersects[0].object),c.onclick())}else e.ctrlKey&&(c.setFocusNull(),c.moveScene=!0,c.x=void 0==e.offsetX?e.layerX:e.offsetX,c.z=void 0==e.offsetY?e.layerY:e.offsetY,c.lx=c.x,c.lz=c.z)},this.onContainerMouseUp=function(e){if(e.preventDefault(),c.moveScene=!1,c.focused){var t=c.focused.parent.userData,i=Math.round(10*c.focused.parent.position.x)/10;c.focused.parent.position.x=i,t.shipData.instances[t.id].position.x=i;var n=Math.round(10*c.focused.parent.position.z)/10;c.focused.parent.position.z=n,t.shipData.instances[t.id].position.z=n,c.mouseup(),c._DisplaceFocused=null,c.focused=null}else{var r=c._rayGet();c._intersects=r.intersectObjects(c.objects,!0),c._intersects.length>0?(c.selected=c._intersects[0].object,c.pointer.show(c.htmlContainer,c.scene,c.selected.parent.userData.shipData)):c.selected&&c.hideSelected()}},this.onDocumentMouseWheel=function(e){e.preventDefault(),e.stopPropagation();var t;switch(e.deltaMode){case 2:t=.025*e.deltaY;break;case 1:t=.01*e.deltaY;break;default:t=25e-5*e.deltaY}var i=20;c.camera.zoom>3&&(i+=10),c.camera.zoom-=t*i,c.camera.zoom<1?c.camera.zoom=1:c.camera.zoom>7&&(c.camera.zoom=7),c.camera.updateProjectionMatrix()}}return e.prototype.activate=function(){this.container.addEventListener("mousedown",this.onContainerMouseDown,!1),this.container.addEventListener("mousemove",this.getMousePos,!1),this.container.addEventListener("mouseup",this.onContainerMouseUp,!1),this.container.addEventListener("mousewheel",this.onDocumentMouseWheel,!1)},e.prototype.deactivate=function(){this.container.removeEventListener("mousedown",this.onContainerMouseDown,!1),this.container.removeEventListener("mousemove",this.getMousePos,!1),this.container.removeEventListener("mouseup",this.onContainerMouseUp,!1),this.container.removeEventListener("mousewheel",this.onDocumentMouseWheel,!1)},e.prototype.update=function(){this.onContainerMouseMove()},e.prototype.updateAfter=function(e,t){this.selected&&this.pointer.update(this.selected.parent.position.clone(),e,t)},e.prototype.returnPrevious=function(){this._selGetPos(this.previous)},e.prototype.setFocus=function(e){this._DisplaceFocused=e,this.item=this.objects.indexOf(e),e.userData.parent?(this.focused=e.userData.parent,this.focusedpart=this._DisplaceFocused,this.previous.copy(this.focused.parent.position)):(this.focused=e,this.focusedpart=null,this.previous.copy(this.focused.parent.position)),this.focused!==this.selected&&(this.focused=null,this.selected=null)},e.prototype.setFocusNull=function(){this._DisplaceFocused=null,this.focused=null,this.focusedpart=null,this.item=null},e.prototype.select=function(e){this._DisplaceMouseOvered=e,e.userData.parent?(this.mouseovered=e.userData.parent,this.mouseoveredpart=this._DisplaceMouseOvered):(this.mouseovered=e,this.mouseoveredpart=null)},e.prototype._setSelectNull=function(){this._DisplaceMouseOvered=null,this.mouseovered=null,this.mouseoveredpart=null},e.prototype._selGetPos=function(e){this.focused.parent.position.copy(e)},e.prototype._rayGet=function(){var e=new n.Vector3(this._mouse.x,this._mouse.y,.5);return e.unproject(this.camera),new n.Raycaster(this.camera.position,e.sub(this.camera.position).normalize())},e.prototype.onContainerMouseMove=function(){var e=this._rayGet();if(this.focused){if(this.displacing){this.intersectsMap=e.intersectObject(this.projectionMap);try{var t=(new n.Vector3).copy(this.intersectsMap[0].point);1==this.fixed.x&&(t.x=this.previous.x),1==this.fixed.y&&(t.y=this.previous.y),1==this.fixed.z&&(t.z=this.previous.z),t.x-=this.scene.position.x,t.z-=this.scene.position.z,this._selGetPos(t)}catch(e){}}}else if(this._intersects=e.intersectObjects(this.objects,!0),this._intersects.length>0)this.mouseovered?this._DisplaceMouseOvered!=this._intersects[0].object?(this.mouseout(),this.select(this._intersects[0].object),this.mouseover()):this.mouseover():(this.select(this._intersects[0].object),this.mouseover());else if(this._DisplaceMouseOvered&&(this.mouseout(),this._setSelectNull()),this.moveScene){var i=this.x-this.lx,r=this.z-this.lz;this.scene.position.x-=i/5,this.scene.position.x>this.moveMax?this.scene.position.x=this.moveMax:this.scene.position.x<-this.moveMax&&(this.scene.position.x=-this.moveMax),this.scene.position.z-=r/5,this.scene.position.z>this.moveMax?this.scene.position.z=this.moveMax:this.scene.position.z<-this.moveMax&&(this.scene.position.z=-this.moveMax),this.lx=this.x,this.lz=this.z}},e.prototype.hideSelected=function(){this.pointer.hide(this.htmlContainer,this.scene),this.selected=null},e}();t.ObjectControls=s},677:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(678),r=i(41),s=function(){function e(e){this.camera=e,this.title=new n.TextLabel(this.camera),this.visible=!0;var t=new r.Geometry;t.vertices.push(new r.Vector3(0,0,0)),t.vertices.push(new r.Vector3(-3,10,0)),t.vertices.push(new r.Vector3(-12,10,0));var i=new r.Line(t,new r.LineBasicMaterial({transparent:!0,opacity:.8,linewidth:2}));this.line=new r.Object3D,this.line.add(i)}return e.prototype.show=function(e,t,i){this.title.setLabel(i.origin.type),this.title.htmlElement.style.display="block",t.add(this.line),this.visible=!0},e.prototype.hide=function(e,t){this.visible=!1,this.title.htmlElement.style.display="none",t.remove(this.line)},e.prototype.update=function(e,t,i){this.visible&&(this.line.position.x=e.x,this.line.position.y=e.y,this.line.position.z=e.z,this.title.update(e,t,i))},e}();t.Pointer=s},678:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.camera=e,this.htmlElement=document.getElementById("text-label")}return e.prototype.setLabel=function(e){this.htmlElement.innerHTML='<span class="mat-button-wrapper">'+e+"</span>",this.htmlElement.style.width="auto",this.originalWidth=null},e.prototype.update=function(e,t,i){var n=this._get2DCoords(e,this.camera,t,i);return this.htmlElement.style.left=n.x+"px",this.htmlElement.style.top=n.y+"px",this.htmlElement.style.fontSize=16*this.camera.zoom+"px",this.htmlElement.style.height=36*this.camera.zoom+"px",this.originalWidth||(this.originalWidth=this.htmlElement.clientWidth),this.htmlElement.style.width=this.camera.zoom*this.originalWidth+"px",n},e.prototype._get2DCoords=function(e,t,i,n){var r=e.project(t),s=.5*i,o=.5*n;return r.x=r.x*s+s+30*t.zoom,r.y=-r.y*o+o-t.zoom*(t.zoom+45),r},e}();t.TextLabel=n},679:function(e,t){e.exports='<div> <md-sidenav-container> <md-sidenav mode="over" opened="false" align="end" class="info" (close-start)="onCloseShipInfo()" #shipInfo> <md-card *ngIf="shipData"> <md-card-header> <img md-card-avatar src="{{shipService.getImage(shipData)}}"> <md-card-title>{{shipData.type}}</md-card-title> <md-card-subtitle>Ship Info</md-card-subtitle> </md-card-header> <md-card-content> <md-list> <md-list-item> <md-icon md-list-icon>people</md-icon> <h4 md-line>Max Crew</h4> <p md-line>{{shipData.maxcrew}}</p> </md-list-item> <md-divider></md-divider> <md-list-item> <md-icon md-list-icon>layers</md-icon> <h4 md-line>Cargo Capacity</h4> <p md-line>{{shipData.cargo}}</p> </md-list-item> </md-list> </md-card-content> </md-card> </md-sidenav> <div class="container" #container> <button md-mini-fab color="none" (click)="saveImage()" class="save-image"><md-icon>photo_camera</md-icon></button> <button md-mini-fab color="none" (click)="toggleFullscreen()" class="fullscreen"><md-icon>fullscreen</md-icon></button> <button id="text-label" md-raised-button color="none" (click)="showInfo()"></button> <section class="loader" [hidden]="loaded"> <h3>Loading ...</h3> <md-progress-bar color="primary" mode="determinate" [value]="loadingProgress"> </md-progress-bar> </section> </div> </md-sidenav-container> </div>'},680:function(e,t,i){var n=i(681);e.exports="string"==typeof n?n:n.toString()},681:function(e,t,i){t=e.exports=i(61)(void 0),t.push([e.i,".container{text-align:center}.loader{padding:20px}#text-label{display:none;position:absolute;z-index:1;width:auto;white-space:nowrap;min-height:40px}#text-label:hover{background-color:#888}.info{background-color:rgba(22,255,255,.1);color:#fff;padding:20px}.save-image{right:70px}.fullscreen,.save-image{position:absolute;top:20px;z-index:1}.fullscreen{right:20px}",""])},682:function(e,t,i){"use strict";var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:!0});var r=i(11),s=i(40),o=i(222),a=i(223),c=i(224),l=[{path:"",redirectTo:"/inventory",pathMatch:"full"},{path:"inventory",children:[{path:"",component:o.InventoryComponent},{path:"add-ship/:size",component:a.AddShipComponent}]},{path:"simulator",component:c.SimulatorComponent},{path:"**",component:o.InventoryComponent}],u=function(){function e(){}return e=n([r.NgModule({imports:[s.RouterModule.forRoot(l)],exports:[s.RouterModule]})],e)}();t.AppRoutingModule=u},683:function(e,t,i){var n;/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(r,s,o,a){"use strict";function c(e,t,i){return setTimeout(d(e,i),t)}function l(e,t,i){return!!Array.isArray(e)&&(u(e,i[t],i),!0)}function u(e,t,i){var n;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==a)for(n=0;n<e.length;)t.call(i,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n,e)}function h(e,t,i){var n="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=r.console&&(r.console.warn||r.console.log);return s&&s.call(r.console,n,i),e.apply(this,arguments)}}function p(e,t,i){var n,r=t.prototype;n=e.prototype=Object.create(r),n.constructor=e,n._super=r,i&&fe(n,i)}function d(e,t){return function(){return e.apply(t,arguments)}}function f(e,t){return typeof e==ge?e.apply(t?t[0]||a:a,t):e}function m(e,t){return e===a?t:e}function v(e,t,i){u(b(t),function(t){e.addEventListener(t,i,!1)})}function g(e,t,i){u(b(t),function(t){e.removeEventListener(t,i,!1)})}function y(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function S(e,t){return e.indexOf(t)>-1}function b(e){return e.trim().split(/\s+/g)}function M(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function x(e){return Array.prototype.slice.call(e,0)}function T(e,t,i){for(var n=[],r=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];M(r,o)<0&&n.push(e[s]),r[s]=o,s++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function E(e,t){for(var i,n,r=t[0].toUpperCase()+t.slice(1),s=0;s<me.length;){if(i=me[s],(n=i?i+r:t)in e)return n;s++}return a}function w(){return Te++}function _(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}function A(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){f(e.options.enable,[e])&&i.handler(t)},this.init()}function R(e){var t=e.options.inputClass;return new(t||(_e?U:Ae?V:we?q:G))(e,L)}function L(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=t&Le&&n-r==0,o=t&(Ce|Ie)&&n-r==0;i.isFirst=!!s,i.isFinal=!!o,s&&(e.session={}),i.eventType=t,O(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function O(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=F(t)),r>1&&!i.firstMultiple?i.firstMultiple=F(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,o=i.firstMultiple,a=o?o.center:s.center,c=t.center=P(n);t.timeStamp=be(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=j(a,c),t.distance=H(a,c),C(i,t),t.offsetDirection=N(t.deltaX,t.deltaY);var l=D(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=Se(l.x)>Se(l.y)?l.x:l.y,t.scale=o?k(o.pointers,n):1,t.rotation=o?z(o.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,I(i,t);var u=e.element;y(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function C(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};t.eventType!==Le&&s.eventType!==Ce||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}function I(e,t){var i,n,r,s,o=e.lastInterval||t,c=t.timeStamp-o.timeStamp;if(t.eventType!=Ie&&(c>Re||o.velocity===a)){var l=t.deltaX-o.deltaX,u=t.deltaY-o.deltaY,h=D(c,l,u);n=h.x,r=h.y,i=Se(h.x)>Se(h.y)?h.x:h.y,s=N(l,u),e.lastInterval=t}else i=o.velocity,n=o.velocityX,r=o.velocityY,s=o.direction;t.velocity=i,t.velocityX=n,t.velocityY=r,t.direction=s}function F(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:ye(e.pointers[i].clientX),clientY:ye(e.pointers[i].clientY)},i++;return{timeStamp:be(),pointers:t,center:P(t),deltaX:e.deltaX,deltaY:e.deltaY}}function P(e){var t=e.length;if(1===t)return{x:ye(e[0].clientX),y:ye(e[0].clientY)};for(var i=0,n=0,r=0;r<t;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:ye(i/t),y:ye(n/t)}}function D(e,t,i){return{x:t/e||0,y:i/e||0}}function N(e,t){return e===t?Fe:Se(e)>=Se(t)?e<0?Pe:De:t<0?Ne:He}function H(e,t,i){i||(i=Ge);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function j(e,t,i){i||(i=Ge);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}function z(e,t){return j(t[1],t[0],Ue)+j(e[1],e[0],Ue)}function k(e,t){return H(t[0],t[1],Ue)/H(e[0],e[1],Ue)}function G(){this.evEl=We,this.evWin=Ve,this.pressed=!1,A.apply(this,arguments)}function U(){this.evEl=Xe,this.evWin=Ye,A.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function B(){this.evTarget=Je,this.evWin=Ze,this.started=!1,A.apply(this,arguments)}function W(e,t){var i=x(e.touches),n=x(e.changedTouches);return t&(Ce|Ie)&&(i=T(i.concat(n),"identifier",!0)),[i,n]}function V(){this.evTarget=et,this.targetIds={},A.apply(this,arguments)}function K(e,t){var i=x(e.touches),n=this.targetIds;if(t&(Le|Oe)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=x(e.changedTouches),a=[],c=this.target;if(s=i.filter(function(e){return y(e.target,c)}),t===Le)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&a.push(o[r]),t&(Ce|Ie)&&delete n[o[r].identifier],r++;return a.length?[T(s.concat(a),"identifier",!0),a]:void 0}function q(){A.apply(this,arguments);var e=d(this.handler,this);this.touch=new V(this.manager,e),this.mouse=new G(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function X(e,t){e&Le?(this.primaryTouch=t.changedPointers[0].identifier,Y.call(this,t)):e&(Ce|Ie)&&Y.call(this,t)}function Y(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches,r=function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)};setTimeout(r,tt)}}function Q(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(t-r.x),o=Math.abs(i-r.y);if(s<=it&&o<=it)return!0}return!1}function J(e,t){this.manager=e,this.set(t)}function Z(e){if(S(e,at))return at;var t=S(e,ct),i=S(e,lt);return t&&i?at:t||i?t?ct:lt:S(e,ot)?ot:st}function $(e){this.options=fe({},this.defaults,e||{}),this.id=w(),this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=ht,this.simultaneous={},this.requireFail=[]}function ee(e){return e&vt?"cancel":e&ft?"end":e&dt?"move":e&pt?"start":""}function te(e){return e==He?"down":e==Ne?"up":e==Pe?"left":e==De?"right":""}function ie(e,t){var i=t.manager;return i?i.get(e):e}function ne(){$.apply(this,arguments)}function re(){ne.apply(this,arguments),this.pX=null,this.pY=null}function se(){ne.apply(this,arguments)}function oe(){$.apply(this,arguments),this._timer=null,this._input=null}function ae(){ne.apply(this,arguments)}function ce(){ne.apply(this,arguments)}function le(){$.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ue(e,t){return t=t||{},t.recognizers=m(t.recognizers,ue.defaults.preset),new he(e,t)}function he(e,t){this.options=fe({},ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=R(this),this.touchAction=new J(this,this.options.touchAction),pe(this,!0),u(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function pe(e,t){var i=e.element;if(i.style){var n;u(e.options.cssProps,function(r,s){n=E(i.style,s),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={})}}function de(e,t){var i=s.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}var fe,me=["","webkit","Moz","MS","ms","o"],ve=s.createElement("div"),ge="function",ye=Math.round,Se=Math.abs,be=Date.now;fe="function"!=typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==a&&null!==n)for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}:Object.assign;var Me=h(function(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;)(!i||i&&e[n[r]]===a)&&(e[n[r]]=t[n[r]]),r++;return e},"extend","Use `assign`."),xe=h(function(e,t){return Me(e,t,!0)},"merge","Use `assign`."),Te=1,Ee=/mobile|tablet|ip(ad|hone|od)|android/i,we="ontouchstart"in r,_e=E(r,"PointerEvent")!==a,Ae=we&&Ee.test(navigator.userAgent),Re=25,Le=1,Oe=2,Ce=4,Ie=8,Fe=1,Pe=2,De=4,Ne=8,He=16,je=Pe|De,ze=Ne|He,ke=je|ze,Ge=["x","y"],Ue=["clientX","clientY"];A.prototype={handler:function(){},init:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(_(this.element),this.evWin,this.domHandler)}};var Be={mousedown:Le,mousemove:Oe,mouseup:Ce},We="mousedown",Ve="mousemove mouseup";p(G,A,{handler:function(e){var t=Be[e.type];t&Le&&0===e.button&&(this.pressed=!0),t&Oe&&1!==e.which&&(t=Ce),this.pressed&&(t&Ce&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var Ke={pointerdown:Le,pointermove:Oe,pointerup:Ce,pointercancel:Ie,pointerout:Ie},qe={2:"touch",3:"pen",4:"mouse",5:"kinect"},Xe="pointerdown",Ye="pointermove pointerup pointercancel";r.MSPointerEvent&&!r.PointerEvent&&(Xe="MSPointerDown",Ye="MSPointerMove MSPointerUp MSPointerCancel"),p(U,A,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=Ke[n],s=qe[e.pointerType]||e.pointerType,o="touch"==s,a=M(t,e.pointerId,"pointerId");r&Le&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):r&(Ce|Ie)&&(i=!0),a<0||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),i&&t.splice(a,1))}});var Qe={touchstart:Le,touchmove:Oe,touchend:Ce,touchcancel:Ie},Je="touchstart",Ze="touchstart touchmove touchend touchcancel";p(B,A,{handler:function(e){var t=Qe[e.type];if(t===Le&&(this.started=!0),this.started){var i=W.call(this,e,t);t&(Ce|Ie)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}});var $e={touchstart:Le,touchmove:Oe,touchend:Ce,touchcancel:Ie},et="touchstart touchmove touchend touchcancel";p(V,A,{handler:function(e){var t=$e[e.type],i=K.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}});var tt=2500,it=25;p(q,A,{handler:function(e,t,i){var n="touch"==i.pointerType,r="mouse"==i.pointerType;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)X.call(this,t,i);else if(r&&Q.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var nt=E(ve.style,"touchAction"),rt=nt!==a,st="auto",ot="manipulation",at="none",ct="pan-x",lt="pan-y",ut=function(){if(!rt)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){e[i]=!t||r.CSS.supports("touch-action",i)}),e}();J.prototype={set:function(e){"compute"==e&&(e=this.compute()),rt&&this.manager.element.style&&ut[e]&&(this.manager.element.style[nt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return u(this.manager.recognizers,function(t){f(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Z(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,r=S(n,at)&&!ut[at],s=S(n,lt)&&!ut[lt],o=S(n,ct)&&!ut[ct];if(r){var a=1===e.pointers.length,c=e.distance<2,l=e.deltaTime<250;if(a&&c&&l)return}return o&&s?void 0:r||s&&i&je||o&&i&ze?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var ht=1,pt=2,dt=4,ft=8,mt=ft,vt=16;$.prototype={defaults:{},set:function(e){return fe(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(l(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=ie(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return l(e,"dropRecognizeWith",this)?this:(e=ie(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(l(e,"requireFailure",this))return this;var t=this.requireFail;return e=ie(e,this),-1===M(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(l(e,"dropRequireFailure",this))return this;e=ie(e,this);var t=M(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(t,e)}var i=this,n=this.state;n<ft&&t(i.options.event+ee(n)),t(i.options.event),e.additionalEvent&&t(e.additionalEvent),n>=ft&&t(i.options.event+ee(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|ht)))return!1;e++}return!0},recognize:function(e){var t=fe({},e);if(!f(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(mt|vt|32)&&(this.state=ht),this.state=this.process(t),this.state&(pt|dt|ft|vt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},p(ne,$,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(pt|dt),r=this.attrTest(e);return n&&(i&Ie||!r)?t|vt:n||r?i&Ce?t|ft:t&pt?t|dt:pt:32}}),p(re,ne,{defaults:{event:"pan",threshold:10,pointers:1,direction:ke},getTouchAction:function(){var e=this.options.direction,t=[];return e&je&&t.push(lt),e&ze&&t.push(ct),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,s=e.deltaX,o=e.deltaY;return r&t.direction||(t.direction&je?(r=0===s?Fe:s<0?Pe:De,i=s!=this.pX,n=Math.abs(e.deltaX)):(r=0===o?Fe:o<0?Ne:He,i=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return ne.prototype.attrTest.call(this,e)&&(this.state&pt||!(this.state&pt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=te(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),p(se,ne,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[at]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&pt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),p(oe,$,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[st]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(Ce|Ie)&&!r)this.reset();else if(e.eventType&Le)this.reset(),this._timer=c(function(){this.state=mt,this.tryEmit()},t.time,this);else if(e.eventType&Ce)return mt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===mt&&(e&&e.eventType&Ce?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=be(),this.manager.emit(this.options.event,this._input)))}}),p(ae,ne,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[at]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&pt)}}),p(ce,ne,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:je|ze,pointers:1},getTouchAction:function(){return re.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(je|ze)?t=e.overallVelocity:i&je?t=e.overallVelocityX:i&ze&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&Se(t)>this.options.velocity&&e.eventType&Ce},emit:function(e){var t=te(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),p(le,$,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ot]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&Le&&0===this.count)return this.failTimeout();if(n&&r&&i){if(e.eventType!=Ce)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||H(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,o&&s?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=c(function(){this.state=mt,this.tryEmit()},t.interval,this),pt):mt}return 32},failTimeout:function(){return this._timer=c(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==mt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ue.VERSION="2.0.7",ue.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[ae,{enable:!1}],[se,{enable:!1},["rotate"]],[ce,{direction:je}],[re,{direction:je},["swipe"]],[le],[le,{event:"doubletap",taps:2},["tap"]],[oe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};he.prototype={set:function(e){return fe(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,n=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&mt)&&(r=t.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],2===t.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&i.state&(pt|dt|ft)&&(r=t.curRecognizer=i),s++}},get:function(e){if(e instanceof $)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(l(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(l(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=M(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var i=this.handlers;return u(b(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==a){var i=this.handlers;return u(b(e),function(e){t?i[e]&&i[e].splice(M(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&de(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&pe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},fe(ue,{INPUT_START:Le,INPUT_MOVE:Oe,INPUT_END:Ce,INPUT_CANCEL:Ie,STATE_POSSIBLE:ht,STATE_BEGAN:pt,STATE_CHANGED:dt,STATE_ENDED:ft,STATE_RECOGNIZED:mt,STATE_CANCELLED:vt,STATE_FAILED:32,DIRECTION_NONE:Fe,DIRECTION_LEFT:Pe,DIRECTION_RIGHT:De,DIRECTION_UP:Ne,DIRECTION_DOWN:He,DIRECTION_HORIZONTAL:je,DIRECTION_VERTICAL:ze,DIRECTION_ALL:ke,Manager:he,Input:A,TouchAction:J,TouchInput:V,MouseInput:G,PointerEventInput:U,TouchMouseInput:q,SingleTouchInput:B,Recognizer:$,AttrRecognizer:ne,Tap:le,Pan:re,Swipe:ce,Pinch:se,Rotate:ae,Press:oe,on:v,off:g,each:u,merge:xe,extend:Me,assign:fe,inherit:p,bindFn:d,prefixed:E}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=ue,(n=function(){return ue}.call(t,i,t,e))!==a&&(e.exports=n)}(window,document)}},[657]);
//# sourceMappingURL=app.25921d9f97428473edc8.js.map